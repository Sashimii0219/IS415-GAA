<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-31">

<title>IS415-GAA - Hands-on Exercise 11</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3 Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03_2.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3 Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex11/Hands-on_Ex11.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objective" id="toc-learning-objective" class="nav-link active" data-scroll-target="#learning-objective">1. Learning Objective</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting Started</a>
  <ul class="collapse">
  <li><a href="#context" id="toc-context" class="nav-link" data-scroll-target="#context">2.1 Context</a></li>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages"><strong>2.2 Loading R Packages</strong></a></li>
  <li><a href="#data-importing-and-preparation" id="toc-data-importing-and-preparation" class="nav-link" data-scroll-target="#data-importing-and-preparation">2.3 Data Importing and Preparation</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">2.3.1 Dataset</a></li>
  <li><a href="#importing-the-od-data" id="toc-importing-the-od-data" class="nav-link" data-scroll-target="#importing-the-od-data"><strong>2.3.2 Importing the OD data</strong></a></li>
  <li><a href="#combining-busstop-and-mpsz" id="toc-combining-busstop-and-mpsz" class="nav-link" data-scroll-target="#combining-busstop-and-mpsz"><strong>2.3.3 Combining Busstop and mpsz</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#computing-distance-matrix" id="toc-computing-distance-matrix" class="nav-link" data-scroll-target="#computing-distance-matrix"><strong>3. Computing Distance Matrix</strong></a>
  <ul class="collapse">
  <li><a href="#converting-from-sf-data.table-to-spatialpolygonsdataframe" id="toc-converting-from-sf-data.table-to-spatialpolygonsdataframe" class="nav-link" data-scroll-target="#converting-from-sf-data.table-to-spatialpolygonsdataframe">3.1 <strong>Converting from sf data.table to SpatialPolygonsDataFrame</strong></a></li>
  <li><a href="#computing-the-distance-matrix" id="toc-computing-the-distance-matrix" class="nav-link" data-scroll-target="#computing-the-distance-matrix">3.2 <strong>Computing the distance matrix</strong></a></li>
  <li><a href="#labelling-column-and-row-heanders-of-a-distance-matrix" id="toc-labelling-column-and-row-heanders-of-a-distance-matrix" class="nav-link" data-scroll-target="#labelling-column-and-row-heanders-of-a-distance-matrix"><strong>3.3 Labelling column and row heanders of a distance matrix</strong></a></li>
  <li><a href="#pivoting-distance-value-by-subzone_c" id="toc-pivoting-distance-value-by-subzone_c" class="nav-link" data-scroll-target="#pivoting-distance-value-by-subzone_c"><strong>3.4 Pivoting distance value by SUBZONE_C</strong></a></li>
  <li><a href="#updating-intra-zonal-distances" id="toc-updating-intra-zonal-distances" class="nav-link" data-scroll-target="#updating-intra-zonal-distances"><strong>3.5 Updating intra-zonal distances</strong></a></li>
  </ul></li>
  <li><a href="#preparing-flow-data" id="toc-preparing-flow-data" class="nav-link" data-scroll-target="#preparing-flow-data"><strong>4. Preparing flow data</strong></a>
  <ul class="collapse">
  <li><a href="#separating-intra-flow-from-passenger-volume-df" id="toc-separating-intra-flow-from-passenger-volume-df" class="nav-link" data-scroll-target="#separating-intra-flow-from-passenger-volume-df"><strong>4.1 Separating intra-flow from passenger volume df</strong></a></li>
  <li><a href="#combining-passenger-volume-data-with-distance-value" id="toc-combining-passenger-volume-data-with-distance-value" class="nav-link" data-scroll-target="#combining-passenger-volume-data-with-distance-value"><strong>4.2 Combining passenger volume data with distance value</strong></a></li>
  </ul></li>
  <li><a href="#preparing-origin-and-destination-attributes" id="toc-preparing-origin-and-destination-attributes" class="nav-link" data-scroll-target="#preparing-origin-and-destination-attributes"><strong>5. Preparing Origin and Destination Attributes</strong></a>
  <ul class="collapse">
  <li><a href="#importing-population-data" id="toc-importing-population-data" class="nav-link" data-scroll-target="#importing-population-data"><strong>5.1 Importing population data</strong></a>
  <ul class="collapse">
  <li><a href="#geospatial-data-wrangling" id="toc-geospatial-data-wrangling" class="nav-link" data-scroll-target="#geospatial-data-wrangling"><strong>5.2 Geospatial data wrangling</strong></a></li>
  </ul></li>
  <li><a href="#preparing-origin-attribute" id="toc-preparing-origin-attribute" class="nav-link" data-scroll-target="#preparing-origin-attribute"><strong>5.3 Preparing origin attribute</strong></a></li>
  <li><a href="#preparing-destination-attribute" id="toc-preparing-destination-attribute" class="nav-link" data-scroll-target="#preparing-destination-attribute"><strong>5.4 Preparing destination attribute</strong></a></li>
  </ul></li>
  <li><a href="#calibrating-spatial-interaction-models" id="toc-calibrating-spatial-interaction-models" class="nav-link" data-scroll-target="#calibrating-spatial-interaction-models"><strong>6. Calibrating Spatial Interaction Models</strong></a>
  <ul class="collapse">
  <li><a href="#importing-the-modelling-data" id="toc-importing-the-modelling-data" class="nav-link" data-scroll-target="#importing-the-modelling-data"><strong>6.1 Importing the modelling data</strong></a></li>
  <li><a href="#visualising-the-dependent-variable" id="toc-visualising-the-dependent-variable" class="nav-link" data-scroll-target="#visualising-the-dependent-variable"><strong>6.2 Visualising the dependent variable</strong></a></li>
  <li><a href="#checking-for-variables-with-zero-values" id="toc-checking-for-variables-with-zero-values" class="nav-link" data-scroll-target="#checking-for-variables-with-zero-values"><strong>6.3 Checking for variables with zero values</strong></a></li>
  <li><a href="#unconstrained-spatial-interaction-model" id="toc-unconstrained-spatial-interaction-model" class="nav-link" data-scroll-target="#unconstrained-spatial-interaction-model"><strong>6.4 Unconstrained Spatial Interaction Model</strong></a></li>
  <li><a href="#r-squared-function" id="toc-r-squared-function" class="nav-link" data-scroll-target="#r-squared-function"><strong>6.5 R-squared function</strong></a></li>
  <li><a href="#origin-production-constrained-sim" id="toc-origin-production-constrained-sim" class="nav-link" data-scroll-target="#origin-production-constrained-sim"><strong>6.6 Origin (Production) constrained SIM</strong></a></li>
  <li><a href="#destination-constrained" id="toc-destination-constrained" class="nav-link" data-scroll-target="#destination-constrained"><strong>6.7 Destination constrained</strong></a></li>
  <li><a href="#doubly-constrained" id="toc-doubly-constrained" class="nav-link" data-scroll-target="#doubly-constrained"><strong>6.8 Doubly constrained</strong></a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><strong>6.9 Model comparison</strong></a></li>
  <li><a href="#visualising-fitted-values" id="toc-visualising-fitted-values" class="nav-link" data-scroll-target="#visualising-fitted-values"><strong>6.10 Visualising fitted values</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hands-on Exercise 11</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 31, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="learning-objective" class="level1">
<h1>1. Learning Objective</h1>
<p>Spatial Interaction Models (SIMs) are mathematical models for estimating flows between spatial entities developed by Alan Wilson in the late 1960s and early 1970, with considerable uptake and refinement for transport modelling since then Boyce and Williams (2015).</p>
<p>There are four main types of traditional SIMs (Wilson 1971):</p>
<ul>
<li><p>Unconstrained</p></li>
<li><p>Production-constrained</p></li>
<li><p>Attraction-constrained</p></li>
<li><p>Doubly-constrained</p></li>
</ul>
<p>Ordinary least square (OLS), log-normal, Poisson and negative binomial (NB) regression methods have been used extensively to calibrate OD flow models by processing flow data as different types of dependent variables. In this chapter, you will gain hands-on experiences on using appropriate R packages to calibrate SIM by using there four regression methods.</p>
</section>
<section id="getting-started" class="level1">
<h1>2. Getting Started</h1>
<section id="context" class="level2">
<h2 class="anchored" data-anchor-id="context">2.1 Context</h2>
<p>In this exercise, we are going to calibrate SIM to determine factors affecting the public bus passenger flows during the morning peak in Singapore.</p>
</section>
<section id="loading-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-r-packages"><strong>2.2 Loading R Packages</strong></h2>
<p>For the purpose of this exercise, four r packages will be used. They are:</p>
<ul>
<li><p>sf for importing, integrating, processing and transforming geospatial data.</p></li>
<li><p>tidyverse for importing, integrating, wrangling and visualising data.</p></li>
<li><p>tmap for creating thematic maps.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tmap, sf, sp,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               performance, reshape2,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggpubr, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-importing-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-importing-and-preparation">2.3 Data Importing and Preparation</h2>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">2.3.1 Dataset</h3>
<p>This exercise is a continuation of <strong>Chapter 15: Processing and Visualising Flow Data</strong> and the following data will be used:</p>
<ul>
<li><p><em>od_data.rds</em>, weekday morning peak passenger flows at planning subzone level.</p></li>
<li><p><em>mpsz.rds</em>, URA Master Plan 2019 Planning Subzone boundary in simple feature tibble data frame format.</p></li>
</ul>
<p>Beside these two data sets, an additional attribute data file called pop.csv will be provided.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mpsz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21 / Singapore TM
First 10 features:
   OBJECTID SUBZONE_NO           SUBZONE_N SUBZONE_C CA_IND    PLN_AREA_N
1         1          2       PEOPLE'S PARK    OTSZ02      Y        OUTRAM
2         2          2         BUKIT MERAH    BMSZ02      N   BUKIT MERAH
3         3          3           CHINATOWN    OTSZ03      Y        OUTRAM
4         4          4             PHILLIP    DTSZ04      Y DOWNTOWN CORE
5         5          5       RAFFLES PLACE    DTSZ05      Y DOWNTOWN CORE
6         6          4        CHINA SQUARE    OTSZ04      Y        OUTRAM
7         7         10         TIONG BAHRU    BMSZ10      N   BUKIT MERAH
8         8         12    BAYFRONT SUBZONE    DTSZ12      Y DOWNTOWN CORE
9         9          4 TIONG BAHRU STATION    BMSZ04      N   BUKIT MERAH
10       10          6       CLIFFORD PIER    DTSZ06      Y DOWNTOWN CORE
   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR
1          OT CENTRAL REGION       CR B4120D23006C932A 2016-05-11 28831.78
2          BM CENTRAL REGION       CR 1C51019439A68700 2016-05-11 26360.80
3          OT CENTRAL REGION       CR 0FF1661344C84AED 2016-05-11 29153.97
4          DT CENTRAL REGION       CR 615D4EDDEF809F8E 2016-05-11 29706.72
5          DT CENTRAL REGION       CR 72107B11807074F4 2016-05-11 29968.62
6          OT CENTRAL REGION       CR B609DF5587626C8F 2016-05-11 29509.64
7          BM CENTRAL REGION       CR A0FB4B68155D164A 2016-05-11 27785.67
8          DT CENTRAL REGION       CR 197F5E664DA4D5E1 2016-05-11 30806.24
9          BM CENTRAL REGION       CR 91FFE927ABE3E4DB 2016-05-11 27277.47
10         DT CENTRAL REGION       CR 945CC212CA80626F 2016-05-11 30379.50
     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry
1  29419.65  1822.1927   93140.44 MULTIPOLYGON (((29099.02 29...
2  29384.14  3074.9632  411722.82 MULTIPOLYGON (((26750.09 29...
3  29158.04  4297.5999  587222.68 MULTIPOLYGON (((29161.2 297...
4  29744.91   871.5549   39437.94 MULTIPOLYGON (((29814.11 29...
5  29572.76  1872.7522  188767.49 MULTIPOLYGON (((30137.77 29...
6  29646.45  1605.2797  133006.94 MULTIPOLYGON (((29699.44 29...
7  29590.40  3303.2149  448127.58 MULTIPOLYGON (((27748.04 29...
8  29530.17  2897.1264  521200.52 MULTIPOLYGON (((30844.87 29...
9  29607.02  2506.6879  350787.56 MULTIPOLYGON (((27444.04 29...
10 29776.43  2405.9909  261843.90 MULTIPOLYGON (((30436.73 29...</code></pre>
</div>
</div>
</section>
<section id="importing-the-od-data" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-od-data"><strong>2.3.2 Importing the OD data</strong></h3>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>odbus <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/origin_destination_bus_202210.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type. Hence, the code chunk below is used to convert these data values into character data type.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>ORIGIN_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus<span class="sc">$</span>ORIGIN_PT_CODE)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>odbus<span class="sc">$</span>DESTINATION_PT_CODE <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(odbus<span class="sc">$</span>DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>odbus6_9 <span class="ot">&lt;-</span> odbus <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DAY_TYPE <span class="sc">==</span> <span class="st">"WEEKDAY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME_PER_HOUR <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           TIME_PER_HOUR <span class="sc">&lt;=</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_PT_CODE,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           DESTINATION_PT_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(TOTAL_TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>busstop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">layer =</span> <span class="st">"BusStop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/jacksontan/Documents/Sashimii0219/IS415-GAA/Hands-on_Ex/Hands-on_Ex11/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5159 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
</div>
</section>
<section id="combining-busstop-and-mpsz" class="level3">
<h3 class="anchored" data-anchor-id="combining-busstop-and-mpsz"><strong>2.3.3 Combining Busstop and mpsz</strong></h3>
<p>Code chunk below populates the planning subzone code (i.e.&nbsp;SUBZONE_C) of mpsz sf data frame into busstop sf data frame.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>busstop_mpsz <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(busstop, mpsz) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(BUS_STOP_N, SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we are going to append the planning subzone code from busstop_mpsz data frame onto odbus6_9 data frame.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(odbus6_9 , busstop_mpsz,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_PT_CODE"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_BS =</span> ORIGIN_PT_CODE,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_SZ =</span> SUBZONE_C,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_BS =</span> DESTINATION_PT_CODE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before continue, it is a good practice for us to check for duplicating records.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>duplicate <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If duplicated records are found, the code chunk below will be used to retain the unique records.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It will be a good practice to confirm if the duplicating records issue has been addressed fully.</p>
<p>Next, we will update od_data data frame cwith the planning subzone codes.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(od_data , busstop_mpsz,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"DESTIN_BS"</span> <span class="ot">=</span> <span class="st">"BUS_STOP_N"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>duplicate <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by_all</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> <span class="fu">unique</span>(od_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>od_data <span class="ot">&lt;-</span> od_data <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_SZ =</span> SUBZONE_C) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DESTIN_SZ) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MORNING_PEAK =</span> <span class="fu">sum</span>(TRIPS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It is time to save the output into an rds file format.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(od_data, <span class="st">"data/rds/od_data_fii.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="computing-distance-matrix" class="level1">
<h1><strong>3. Computing Distance Matrix</strong></h1>
<p>In spatial interaction, a distance matrix is a table that shows the distance between pairs of locations. For example, in the table below we can see an Euclidean distance of 3926.0025 between MESZ01 and RVSZ05, of 3939.1079 between MESZ01 and SRSZ01, and so on. By definition, an location’s distance from itself, which is shown in the main diagonal of the table, is 0.</p>
<p><img src="https://r4gdsa.netlify.app/chap16/img/image16-1.jpg" class="img-fluid"></p>
<section id="converting-from-sf-data.table-to-spatialpolygonsdataframe" class="level2">
<h2 class="anchored" data-anchor-id="converting-from-sf-data.table-to-spatialpolygonsdataframe">3.1 <strong>Converting from sf data.table to SpatialPolygonsDataFrame</strong></h2>
<p>There are at least two ways to compute the required distance matrix. One is based on sf and the other is based on sp. Past experience shown that computing distance matrix by using sf function took relatively longer time that sp method especially the data set is large. In view of this, sp method is used in the code chunks below.</p>
<p>First <a href="https://r-spatial.github.io/sf/reference/coerce-methods.html"><code>as.Spatial()</code></a> will be used to convert <em>mpsz</em> from sf tibble data frame to SpatialPolygonsDataFrame of sp object as shown in the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mpsz_sp <span class="ot">&lt;-</span> <span class="fu">as</span>(mpsz, <span class="st">"Spatial"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mpsz_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 323 
extent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 15
names       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area 
min values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16932,  5092.8949,  19579.069, 871.554887798, 39437.9352703 
max values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16932, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 </code></pre>
</div>
</div>
</section>
<section id="computing-the-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="computing-the-distance-matrix">3.2 <strong>Computing the distance matrix</strong></h2>
<p>Next, <a href="https://www.rdocumentation.org/packages/sp/versions/2.1-1/topics/spDistsN1"><code>spDists()</code></a> of sp package will be used to compute the Euclidean distance between the centroids of the planning subzones.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dist <span class="ot">&lt;-</span> <span class="fu">spDists</span>(mpsz_sp, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dist, <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
 [1,]    0.0000 2471.2367  415.0177  933.4461 1147.1018  714.7994 1059.9522
 [2,] 2471.2367    0.0000 2802.3046 3365.3182 3612.7457 3159.7511 1439.7232
 [3,]  415.0177 2802.3046    0.0000  806.1939  914.1363  604.1895 1434.9774
 [4,]  933.4461 3365.3182  806.1939    0.0000  313.4045  220.3061 1927.2560
 [5,] 1147.1018 3612.7457  914.1363  313.4045    0.0000  464.8515 2183.0167
 [6,]  714.7994 3159.7511  604.1895  220.3061  464.8515    0.0000 1724.8827
 [7,] 1059.9522 1439.7232 1434.9774 1927.2560 2183.0167 1724.8827    0.0000
 [8,] 1977.5520 4447.8405 1693.6604 1120.2913  838.7066 1301.8020 3021.1702
 [9,] 1565.5647  943.3775 1929.4628 2433.1644 2691.3659 2232.5220  508.4742
[10,] 1588.3152 4037.8066 1372.7144  673.5181  458.5956  879.5186 2600.4952
           [,8]      [,9]     [,10]
 [1,] 1977.5520 1565.5647 1588.3152
 [2,] 4447.8405  943.3775 4037.8066
 [3,] 1693.6604 1929.4628 1372.7144
 [4,] 1120.2913 2433.1644  673.5181
 [5,]  838.7066 2691.3659  458.5956
 [6,] 1301.8020 2232.5220  879.5186
 [7,] 3021.1702  508.4742 2600.4952
 [8,]    0.0000 3529.6089  492.6989
 [9,] 3529.6089    0.0000 3106.6568
[10,]  492.6989 3106.6568    0.0000</code></pre>
</div>
</div>
</section>
<section id="labelling-column-and-row-heanders-of-a-distance-matrix" class="level2">
<h2 class="anchored" data-anchor-id="labelling-column-and-row-heanders-of-a-distance-matrix"><strong>3.3 Labelling column and row heanders of a distance matrix</strong></h2>
<p>First, we will create a list sorted according to the the distance matrix by planning sub-zone code.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sz_names <span class="ot">&lt;-</span> mpsz<span class="sc">$</span>SUBZONE_C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we will attach <code>SUBZONE_C</code> to row and column for distance matrix matching ahead</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(sz_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pivoting-distance-value-by-subzone_c" class="level2">
<h2 class="anchored" data-anchor-id="pivoting-distance-value-by-subzone_c"><strong>3.4 Pivoting distance value by SUBZONE_C</strong></h2>
<p>Next, we will pivot the distance matrix into a long table by using the row and column subzone codes as show in the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">melt</span>(dist) <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist =</span> value)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(distPair, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Var1   Var2      dist
1  OTSZ02 OTSZ02    0.0000
2  BMSZ02 OTSZ02 2471.2367
3  OTSZ03 OTSZ02  415.0177
4  DTSZ04 OTSZ02  933.4461
5  DTSZ05 OTSZ02 1147.1018
6  OTSZ04 OTSZ02  714.7994
7  BMSZ10 OTSZ02 1059.9522
8  DTSZ12 OTSZ02 1977.5520
9  BMSZ04 OTSZ02 1565.5647
10 DTSZ06 OTSZ02 1588.3152</code></pre>
</div>
</div>
<p>Notice that the within zone distance is 0.</p>
</section>
<section id="updating-intra-zonal-distances" class="level2">
<h2 class="anchored" data-anchor-id="updating-intra-zonal-distances"><strong>3.5 Updating intra-zonal distances</strong></h2>
<p>In this section, we are going to append a constant value to replace the intra-zonal distance of 0.</p>
<p>First, we will select and find out the minimum value of the distance by using <code>summary()</code>.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dist <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist        
 OTSZ02 :   322   OTSZ02 :   322   Min.   :  182.5  
 BMSZ02 :   322   BMSZ02 :   322   1st Qu.: 7092.5  
 OTSZ03 :   322   OTSZ03 :   322   Median :11765.1  
 DTSZ04 :   322   DTSZ04 :   322   Mean   :12159.0  
 DTSZ05 :   322   DTSZ05 :   322   3rd Qu.:16309.3  
 OTSZ04 :   322   OTSZ04 :   322   Max.   :49896.9  
 (Other):102074   (Other):102074                    </code></pre>
</div>
</div>
<p>Next, a constant distance value of 50m is added into intra-zones distance.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>distPair<span class="sc">$</span>dist <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distPair<span class="sc">$</span>dist <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">50</span>, distPair<span class="sc">$</span>dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The code chunk below will be used to check the result data.frame.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Var1             Var2             dist      
 OTSZ02 :   323   OTSZ02 :   323   Min.   :   50  
 BMSZ02 :   323   BMSZ02 :   323   1st Qu.: 7033  
 OTSZ03 :   323   OTSZ03 :   323   Median :11739  
 DTSZ04 :   323   DTSZ04 :   323   Mean   :12121  
 DTSZ05 :   323   DTSZ05 :   323   3rd Qu.:16295  
 OTSZ04 :   323   OTSZ04 :   323   Max.   :49897  
 (Other):102391   (Other):102391                  </code></pre>
</div>
</div>
<p>The code chunk below is used to rename the origin and destination fields.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> distPair <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orig =</span> Var1,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dest =</span> Var2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below is used to save the dataframe for future use.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(distPair, <span class="st">"data/rds/distPair.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>distPair <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/distPair.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="preparing-flow-data" class="level1">
<h1><strong>4. Preparing flow data</strong></h1>
<p>The code chunk below is used import <em>od_data</em> save in Chapter 15 into R environment.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>od_data_fii <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/od_data_fii.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the total passenger trip between and within planning subzones by using the code chunk below. The output is all <em>flow_data</em>.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>flow_data <span class="ot">&lt;-</span> od_data_fii <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ORIGIN_SZ, DESTIN_SZ) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">TRIPS =</span> <span class="fu">sum</span>(MORNING_PEAK)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Use the code chunk below to display flow_data dataframe.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flow_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
# Groups:   ORIGIN_SZ [1]
   ORIGIN_SZ DESTIN_SZ TRIPS
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
 1 AMSZ01    AMSZ01     1998
 2 AMSZ01    AMSZ02     8289
 3 AMSZ01    AMSZ03     8971
 4 AMSZ01    AMSZ04     2252
 5 AMSZ01    AMSZ05     6136
 6 AMSZ01    AMSZ06     2148
 7 AMSZ01    AMSZ07     1620
 8 AMSZ01    AMSZ08     1925
 9 AMSZ01    AMSZ09     1773
10 AMSZ01    AMSZ10       63</code></pre>
</div>
</div>
<section id="separating-intra-flow-from-passenger-volume-df" class="level2">
<h2 class="anchored" data-anchor-id="separating-intra-flow-from-passenger-volume-df"><strong>4.1 Separating intra-flow from passenger volume df</strong></h2>
<p>Code chunk below is used to add three new fields in <code>flow_data</code> dataframe.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>FlowNoIntra <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, flow_data<span class="sc">$</span>TRIPS)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>offset <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  flow_data<span class="sc">$</span>ORIGIN_SZ <span class="sc">==</span> flow_data<span class="sc">$</span>DESTIN_SZ, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000001</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="combining-passenger-volume-data-with-distance-value" class="level2">
<h2 class="anchored" data-anchor-id="combining-passenger-volume-data-with-distance-value"><strong>4.2 Combining passenger volume data with distance value</strong></h2>
<p>Before we can join <em>flow_data</em> and <em>distPair</em>, we need to convert data value type of <em>ORIGIN_SZ</em> and <em>DESTIN_SZ</em> fields of flow_data dataframe into factor data type.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>ORIGIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>ORIGIN_SZ)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>flow_data<span class="sc">$</span>DESTIN_SZ <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(flow_data<span class="sc">$</span>DESTIN_SZ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, <code>left_join()</code> of <strong>dplyr</strong> will be used to <em>flow_data</em> dataframe and <em>distPair</em> dataframe. The output is called <em>flow_data1</em>.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span> (distPair,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ORIGIN_SZ"</span> <span class="ot">=</span> <span class="st">"orig"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"DESTIN_SZ"</span> <span class="ot">=</span> <span class="st">"dest"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="preparing-origin-and-destination-attributes" class="level1">
<h1><strong>5. Preparing Origin and Destination Attributes</strong></h1>
<section id="importing-population-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-population-data"><strong>5.1 Importing population data</strong></h2>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/pop.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="geospatial-data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data-wrangling"><strong>5.2 Geospatial data wrangling</strong></h3>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(pop <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 332
Columns: 7
$ PA        &lt;chr&gt; "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG…
$ SZ        &lt;chr&gt; "ANG MO KIO TOWN CENTRE", "CHENG SAN", "CHONG BOON", "KEBUN …
$ AGE7_12   &lt;dbl&gt; 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, …
$ AGE13_24  &lt;dbl&gt; 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 32…
$ AGE25_64  &lt;dbl&gt; 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500,…
$ OBJECTID  &lt;int&gt; 213, 212, 204, 214, 225, 205, 251, 202, 249, 248, 294, 234, …
$ SUBZONE_C &lt;chr&gt; "AMSZ01", "AMSZ02", "AMSZ03", "AMSZ06", "AMSZ07", "AMSZ05", …</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mpsz,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"PA"</span> <span class="ot">=</span> <span class="st">"PLN_AREA_N"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"SZ"</span> <span class="ot">=</span> <span class="st">"SUBZONE_N"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SZ_NAME =</span> SZ,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">SZ =</span> SUBZONE_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="preparing-origin-attribute" class="level2">
<h2 class="anchored" data-anchor-id="preparing-origin-attribute"><strong>5.3 Preparing origin attribute</strong></h2>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">ORIGIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ORIGIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ORIGIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="preparing-destination-attribute" class="level2">
<h2 class="anchored" data-anchor-id="preparing-destination-attribute"><strong>5.4 Preparing destination attribute</strong></h2>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>flow_data1 <span class="ot">&lt;-</span> flow_data1 <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="at">DESTIN_SZ =</span> <span class="st">"SZ"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">DESTIN_AGE7_12 =</span> AGE7_12,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE13_24 =</span> AGE13_24,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">DESTIN_AGE25_64 =</span> AGE25_64) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(PA, SZ_NAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will called the output data file <em>SIM_data</em>. it is in rds data file format.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(flow_data1, <span class="st">"data/rds/SIM_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="calibrating-spatial-interaction-models" class="level1">
<h1><strong>6. Calibrating Spatial Interaction Models</strong></h1>
<p>In this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.</p>
<section id="importing-the-modelling-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-the-modelling-data"><strong>6.1 Importing the modelling data</strong></h2>
<p>Firstly, let us import the modelling data by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/SIM_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualising-the-dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="visualising-the-dependent-variable"><strong>6.2 Visualising the dependent variable</strong></h2>
<p>Firstly, let us plot the distribution of the dependent variable (i.e.&nbsp;TRIPS) by using histogram method by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex11_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.</p>
<p>Next, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> dist,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex11_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notice that their relationship hardly resemble linear relationship.</p>
<p>On the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(dist),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="fu">log</span>(TRIPS))) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex11_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="checking-for-variables-with-zero-values" class="level2">
<h2 class="anchored" data-anchor-id="checking-for-variables-with-zero-values"><strong>6.3 Checking for variables with zero values</strong></h2>
<p>Since Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.</p>
<p>In the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in <em>SIM_data</em> data frame.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      
 Length:14621       Length:14621       Min.   :     1   Min.   :     0.0  
 Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  
 Mode  :character   Mode  :character   Median :    77   Median :    70.0  
                                       Mean   :  1029   Mean   :   846.2  
                                       3rd Qu.:   431   3rd Qu.:   384.0  
                                       Max.   :232187   Max.   :148274.0  
                                                                          
     offset              dist       ORIGIN_AGE7_12 ORIGIN_AGE13_24
 Min.   :0.000001   Min.   :   50   Min.   :   0   Min.   :    0  
 1st Qu.:1.000000   1st Qu.: 3361   1st Qu.: 260   1st Qu.:  550  
 Median :1.000000   Median : 6084   Median : 710   Median : 1420  
 Mean   :0.982217   Mean   : 6894   Mean   :1044   Mean   : 2295  
 3rd Qu.:1.000000   3rd Qu.: 9737   3rd Qu.:1500   3rd Qu.: 3290  
 Max.   :1.000000   Max.   :26122   Max.   :6340   Max.   :16380  
                                    NA's   :109    NA's   :109    
 ORIGIN_AGE25_64   OBJECTID.x    DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64
 Min.   :    0   Min.   :  2.0   Min.   :   0   Min.   :    0   Min.   :    0  
 1st Qu.: 2320   1st Qu.:100.0   1st Qu.: 260   1st Qu.:  550   1st Qu.: 2280  
 Median : 7030   Median :165.0   Median : 720   Median : 1430   Median : 7120  
 Mean   :10614   Mean   :160.6   Mean   :1042   Mean   : 2310   Mean   :10668  
 3rd Qu.:15830   3rd Qu.:222.0   3rd Qu.:1500   3rd Qu.: 3290   3rd Qu.:15830  
 Max.   :74610   Max.   :323.0   Max.   :6340   Max.   :16380   Max.   :74610  
 NA's   :109     NA's   :109     NA's   :77     NA's   :77      NA's   :77     
   OBJECTID.y   
 Min.   :  2.0  
 1st Qu.:104.0  
 Median :165.0  
 Mean   :161.4  
 3rd Qu.:224.0  
 Max.   :323.0  
 NA's   :77     </code></pre>
</div>
</div>
<p>The print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.</p>
<p>In view of this, code chunk below will be used to replace zero values to 0.99.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE7_12)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE13_24)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>DESTIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>DESTIN_AGE25_64)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE7_12 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE7_12)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE13_24 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE13_24)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  SIM_data<span class="sc">$</span>ORIGIN_AGE25_64 <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.99</span>, SIM_data<span class="sc">$</span>ORIGIN_AGE25_64)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can run the summary() again.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SIM_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra    
 Length:14440       Length:14440       Min.   :     1   Min.   :     0  
 Class :character   Class :character   1st Qu.:    14   1st Qu.:    13  
 Mode  :character   Mode  :character   Median :    77   Median :    70  
                                       Mean   :  1030   Mean   :   845  
                                       3rd Qu.:   431   3rd Qu.:   384  
                                       Max.   :232187   Max.   :148274  
     offset              dist       ORIGIN_AGE7_12    ORIGIN_AGE13_24   
 Min.   :0.000001   Min.   :   50   Min.   :   0.99   Min.   :    0.99  
 1st Qu.:1.000000   1st Qu.: 3374   1st Qu.: 260.00   1st Qu.:  550.00  
 Median :1.000000   Median : 6094   Median : 710.00   Median : 1420.00  
 Mean   :0.982202   Mean   : 6897   Mean   :1043.75   Mean   : 2293.60  
 3rd Qu.:1.000000   3rd Qu.: 9743   3rd Qu.:1500.00   3rd Qu.: 3290.00  
 Max.   :1.000000   Max.   :26122   Max.   :6340.00   Max.   :16380.00  
 ORIGIN_AGE25_64      OBJECTID.x    DESTIN_AGE7_12    DESTIN_AGE13_24   
 Min.   :    0.99   Min.   :  2.0   Min.   :   0.99   Min.   :    0.99  
 1st Qu.: 2320.00   1st Qu.:100.0   1st Qu.: 260.00   1st Qu.:  550.00  
 Median : 7030.00   Median :165.0   Median : 720.00   Median : 1430.00  
 Mean   :10610.77   Mean   :160.7   Mean   :1042.18   Mean   : 2308.45  
 3rd Qu.:15830.00   3rd Qu.:222.0   3rd Qu.:1500.00   3rd Qu.: 3290.00  
 Max.   :74610.00   Max.   :323.0   Max.   :6340.00   Max.   :16380.00  
 DESTIN_AGE25_64      OBJECTID.y   
 Min.   :    0.99   Min.   :  2.0  
 1st Qu.: 2280.00   1st Qu.:104.0  
 Median : 7120.00   Median :165.0  
 Mean   :10667.00   Mean   :161.2  
 3rd Qu.:15830.00   3rd Qu.:223.0  
 Max.   :74610.00   Max.   :323.0  </code></pre>
</div>
</div>
<p>Notice that all the 0 values have been replaced by 0.99.</p>
</section>
<section id="unconstrained-spatial-interaction-model" class="level2">
<h2 class="anchored" data-anchor-id="unconstrained-spatial-interaction-model"><strong>6.4 Unconstrained Spatial Interaction Model</strong></h2>
<p>In this section, we will learn how to calibrate an unconstrained spatial interaction model by using <code>glm()</code> of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e.&nbsp;<em>ORIGIN_AGE25_64</em>) and distance between origin and destination in km (i.e.&nbsp;<em>dist</em>).</p>
<p>The general formula of Unconstrained Spatial Interaction Model</p>
<p><img src="https://r4gdsa.netlify.app/chap15/img/image1.jpg" class="img-fluid"></p>
<p>The code chunk used to calibrate to model is shown below:</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>uncSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.omit)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>uncSIM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + 
    log(dist), family = poisson(link = "log"), data = SIM_data, 
    na.action = na.omit)

Coefficients:
         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  
           10.485540              0.241483              0.006128  
           log(dist)  
           -0.708973  

Degrees of Freedom: 14439 Total (i.e. Null);  14436 Residual
Null Deviance:      59970000 
Residual Deviance: 35860000     AIC: 35950000</code></pre>
</div>
</div>
</section>
<section id="r-squared-function" class="level2">
<h2 class="anchored" data-anchor-id="r-squared-function"><strong>6.5 R-squared function</strong></h2>
<p>In order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>CalcRSquared <span class="ot">&lt;-</span> <span class="cf">function</span>(observed,estimated){</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">cor</span>(observed,estimated)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  R2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  R2</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the R-squared of the unconstrained SIM by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(uncSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, uncSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1884445</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_mcfadden</span>(uncSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Generalized Linear Regression
       R2: 0.401
  adj. R2: 0.401</code></pre>
</div>
</div>
</section>
<section id="origin-production-constrained-sim" class="level2">
<h2 class="anchored" data-anchor-id="origin-production-constrained-sim"><strong>6.6 Origin (Production) constrained SIM</strong></h2>
<p>In this section, we will fit an origin constrained SIM by using the code3 chunk below.</p>
<p>The general formula of Origin Constrained Spatial Interaction Model</p>
<p><img src="https://r4gdsa.netlify.app/chap15/img/image2.jpg" class="img-fluid"></p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>orcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                 ORIGIN_SZ <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(DESTIN_AGE25_64) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log</span>(dist),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(orcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)           1.217e+01  3.788e-03  3214.227  &lt; 2e-16 ***
ORIGIN_SZAMSZ02       1.010e+00  4.450e-03   227.002  &lt; 2e-16 ***
ORIGIN_SZAMSZ03       5.497e-01  4.563e-03   120.473  &lt; 2e-16 ***
ORIGIN_SZAMSZ04      -7.837e-02  5.187e-03   -15.108  &lt; 2e-16 ***
ORIGIN_SZAMSZ05      -1.927e-01  5.790e-03   -33.283  &lt; 2e-16 ***
ORIGIN_SZAMSZ06       4.192e-01  5.130e-03    81.705  &lt; 2e-16 ***
ORIGIN_SZAMSZ07      -1.374e+00  9.683e-03  -141.918  &lt; 2e-16 ***
ORIGIN_SZAMSZ08      -1.025e+00  8.956e-03  -114.430  &lt; 2e-16 ***
ORIGIN_SZAMSZ09       2.238e-01  5.408e-03    41.385  &lt; 2e-16 ***
ORIGIN_SZAMSZ10       4.965e-01  4.717e-03   105.266  &lt; 2e-16 ***
ORIGIN_SZAMSZ11      -1.871e+00  1.285e-02  -145.585  &lt; 2e-16 ***
ORIGIN_SZAMSZ12      -1.580e+00  1.076e-02  -146.895  &lt; 2e-16 ***
ORIGIN_SZBDSZ01       1.080e+00  4.345e-03   248.486  &lt; 2e-16 ***
ORIGIN_SZBDSZ02       5.220e-01  5.079e-03   102.778  &lt; 2e-16 ***
ORIGIN_SZBDSZ03       9.923e-01  4.490e-03   221.025  &lt; 2e-16 ***
ORIGIN_SZBDSZ04       1.775e+00  3.895e-03   455.784  &lt; 2e-16 ***
ORIGIN_SZBDSZ05       6.428e-01  4.546e-03   141.403  &lt; 2e-16 ***
ORIGIN_SZBDSZ06       9.406e-01  4.543e-03   207.038  &lt; 2e-16 ***
ORIGIN_SZBDSZ07      -1.281e+00  9.558e-03  -133.973  &lt; 2e-16 ***
ORIGIN_SZBDSZ08      -1.165e+00  9.032e-03  -128.981  &lt; 2e-16 ***
ORIGIN_SZBKSZ01      -4.615e-01  6.634e-03   -69.559  &lt; 2e-16 ***
ORIGIN_SZBKSZ02       3.935e-01  5.154e-03    76.335  &lt; 2e-16 ***
ORIGIN_SZBKSZ03       5.458e-01  5.039e-03   108.325  &lt; 2e-16 ***
ORIGIN_SZBKSZ04      -1.165e-01  5.914e-03   -19.708  &lt; 2e-16 ***
ORIGIN_SZBKSZ05      -2.147e-01  5.832e-03   -36.813  &lt; 2e-16 ***
ORIGIN_SZBKSZ06       3.150e-02  5.902e-03     5.336 9.49e-08 ***
ORIGIN_SZBKSZ07       7.590e-01  4.427e-03   171.456  &lt; 2e-16 ***
ORIGIN_SZBKSZ08      -2.132e-02  5.348e-03    -3.987 6.69e-05 ***
ORIGIN_SZBKSZ09      -9.643e-02  5.721e-03   -16.857  &lt; 2e-16 ***
ORIGIN_SZBLSZ01      -1.725e+00  1.482e-02  -116.412  &lt; 2e-16 ***
ORIGIN_SZBLSZ02      -2.193e+00  1.924e-02  -113.963  &lt; 2e-16 ***
ORIGIN_SZBLSZ03      -3.298e+00  3.930e-02   -83.922  &lt; 2e-16 ***
ORIGIN_SZBLSZ04      -2.253e+00  2.306e-02   -97.705  &lt; 2e-16 ***
ORIGIN_SZBMSZ01      -1.265e-01  5.224e-03   -24.210  &lt; 2e-16 ***
ORIGIN_SZBMSZ02      -1.072e+00  6.747e-03  -158.945  &lt; 2e-16 ***
ORIGIN_SZBMSZ03      -4.407e-01  5.794e-03   -76.064  &lt; 2e-16 ***
ORIGIN_SZBMSZ04      -6.575e-02  5.157e-03   -12.750  &lt; 2e-16 ***
ORIGIN_SZBMSZ05      -2.264e+00  1.247e-02  -181.592  &lt; 2e-16 ***
ORIGIN_SZBMSZ06      -2.381e+00  1.618e-02  -147.201  &lt; 2e-16 ***
ORIGIN_SZBMSZ07      -4.734e-01  5.659e-03   -83.665  &lt; 2e-16 ***
ORIGIN_SZBMSZ08      -5.667e-01  5.811e-03   -97.514  &lt; 2e-16 ***
ORIGIN_SZBMSZ09      -1.231e+00  8.688e-03  -141.739  &lt; 2e-16 ***
ORIGIN_SZBMSZ10      -1.474e+00  9.130e-03  -161.473  &lt; 2e-16 ***
ORIGIN_SZBMSZ11      -7.887e-01  6.602e-03  -119.465  &lt; 2e-16 ***
ORIGIN_SZBMSZ12      -1.076e+00  9.149e-03  -117.586  &lt; 2e-16 ***
ORIGIN_SZBMSZ13      -1.227e-01  5.691e-03   -21.554  &lt; 2e-16 ***
ORIGIN_SZBMSZ14      -5.360e-01  6.633e-03   -80.808  &lt; 2e-16 ***
ORIGIN_SZBMSZ15      -3.271e-01  6.054e-03   -54.029  &lt; 2e-16 ***
ORIGIN_SZBMSZ16      -1.548e+00  9.147e-03  -169.231  &lt; 2e-16 ***
ORIGIN_SZBMSZ17      -2.187e+00  1.576e-02  -138.756  &lt; 2e-16 ***
ORIGIN_SZBPSZ01       1.402e-01  5.553e-03    25.244  &lt; 2e-16 ***
ORIGIN_SZBPSZ02      -2.943e-02  6.462e-03    -4.554 5.26e-06 ***
ORIGIN_SZBPSZ03       1.525e-01  6.150e-03    24.792  &lt; 2e-16 ***
ORIGIN_SZBPSZ04       3.564e-01  5.084e-03    70.101  &lt; 2e-16 ***
ORIGIN_SZBPSZ05       5.165e-01  4.601e-03   112.266  &lt; 2e-16 ***
ORIGIN_SZBPSZ06      -1.405e+00  9.311e-03  -150.880  &lt; 2e-16 ***
ORIGIN_SZBPSZ07      -1.006e+00  8.575e-03  -117.332  &lt; 2e-16 ***
ORIGIN_SZBSSZ01      -1.478e-02  5.276e-03    -2.801  0.00509 ** 
ORIGIN_SZBSSZ02       3.117e-01  4.788e-03    65.112  &lt; 2e-16 ***
ORIGIN_SZBSSZ03       2.581e-01  4.689e-03    55.036  &lt; 2e-16 ***
ORIGIN_SZBTSZ01      -6.322e-02  5.385e-03   -11.739  &lt; 2e-16 ***
ORIGIN_SZBTSZ02      -1.077e+00  7.797e-03  -138.090  &lt; 2e-16 ***
ORIGIN_SZBTSZ03      -2.281e-01  5.727e-03   -39.825  &lt; 2e-16 ***
ORIGIN_SZBTSZ04      -1.056e+00  1.019e-02  -103.678  &lt; 2e-16 ***
ORIGIN_SZBTSZ05      -1.645e+00  1.100e-02  -149.529  &lt; 2e-16 ***
ORIGIN_SZBTSZ06      -7.804e-01  7.181e-03  -108.685  &lt; 2e-16 ***
ORIGIN_SZBTSZ07      -1.872e+00  1.075e-02  -174.104  &lt; 2e-16 ***
ORIGIN_SZBTSZ08      -1.282e+00  9.394e-03  -136.455  &lt; 2e-16 ***
ORIGIN_SZCCSZ01      -1.774e+00  1.331e-02  -133.243  &lt; 2e-16 ***
ORIGIN_SZCHSZ01      -1.243e+00  1.178e-02  -105.523  &lt; 2e-16 ***
ORIGIN_SZCHSZ02      -5.438e-01  7.940e-03   -68.490  &lt; 2e-16 ***
ORIGIN_SZCHSZ03       4.424e-01  5.829e-03    75.890  &lt; 2e-16 ***
ORIGIN_SZCKSZ01       2.030e-01  5.140e-03    39.499  &lt; 2e-16 ***
ORIGIN_SZCKSZ02       7.258e-01  5.100e-03   142.306  &lt; 2e-16 ***
ORIGIN_SZCKSZ03       7.115e-01  4.634e-03   153.537  &lt; 2e-16 ***
ORIGIN_SZCKSZ04       1.356e+00  4.582e-03   295.987  &lt; 2e-16 ***
ORIGIN_SZCKSZ05       1.013e+00  5.305e-03   190.987  &lt; 2e-16 ***
ORIGIN_SZCKSZ06       1.264e+00  5.042e-03   250.731  &lt; 2e-16 ***
ORIGIN_SZCLSZ01      -6.938e-01  7.661e-03   -90.567  &lt; 2e-16 ***
ORIGIN_SZCLSZ02      -1.838e+00  1.364e-02  -134.718  &lt; 2e-16 ***
ORIGIN_SZCLSZ03      -1.003e+00  7.949e-03  -126.166  &lt; 2e-16 ***
ORIGIN_SZCLSZ04       6.984e-01  4.460e-03   156.605  &lt; 2e-16 ***
ORIGIN_SZCLSZ05      -2.033e+00  1.546e-02  -131.526  &lt; 2e-16 ***
ORIGIN_SZCLSZ06       8.690e-01  4.205e-03   206.665  &lt; 2e-16 ***
ORIGIN_SZCLSZ07      -2.893e-01  5.582e-03   -51.827  &lt; 2e-16 ***
ORIGIN_SZCLSZ08       3.305e-01  5.812e-03    56.866  &lt; 2e-16 ***
ORIGIN_SZCLSZ09      -1.776e+00  1.615e-02  -109.949  &lt; 2e-16 ***
ORIGIN_SZDTSZ02      -4.060e+00  8.341e-02   -48.674  &lt; 2e-16 ***
ORIGIN_SZDTSZ03      -4.031e+00  7.381e-02   -54.617  &lt; 2e-16 ***
ORIGIN_SZGLSZ01      -1.414e+00  9.192e-03  -153.826  &lt; 2e-16 ***
ORIGIN_SZGLSZ02       2.562e-01  4.889e-03    52.412  &lt; 2e-16 ***
ORIGIN_SZGLSZ03       2.410e-01  4.855e-03    49.634  &lt; 2e-16 ***
ORIGIN_SZGLSZ04       8.370e-01  4.200e-03   199.298  &lt; 2e-16 ***
ORIGIN_SZGLSZ05       6.247e-01  4.375e-03   142.765  &lt; 2e-16 ***
ORIGIN_SZHGSZ01       2.784e-01  4.746e-03    58.670  &lt; 2e-16 ***
ORIGIN_SZHGSZ02       4.940e-01  4.712e-03   104.831  &lt; 2e-16 ***
ORIGIN_SZHGSZ03       2.479e-01  5.113e-03    48.476  &lt; 2e-16 ***
ORIGIN_SZHGSZ04       9.074e-01  4.303e-03   210.858  &lt; 2e-16 ***
ORIGIN_SZHGSZ05       1.173e+00  4.253e-03   275.762  &lt; 2e-16 ***
ORIGIN_SZHGSZ06      -9.803e-02  5.413e-03   -18.110  &lt; 2e-16 ***
ORIGIN_SZHGSZ07       6.999e-01  4.455e-03   157.088  &lt; 2e-16 ***
ORIGIN_SZHGSZ08       1.005e-01  5.354e-03    18.766  &lt; 2e-16 ***
ORIGIN_SZHGSZ09      -5.521e-01  6.963e-03   -79.296  &lt; 2e-16 ***
ORIGIN_SZHGSZ10      -3.551e+00  4.211e-02   -84.322  &lt; 2e-16 ***
ORIGIN_SZJESZ01       4.233e-01  4.912e-03    86.170  &lt; 2e-16 ***
ORIGIN_SZJESZ02       2.107e-01  5.015e-03    42.017  &lt; 2e-16 ***
ORIGIN_SZJESZ03       1.816e-01  5.286e-03    34.358  &lt; 2e-16 ***
ORIGIN_SZJESZ05       2.844e-01  4.867e-03    58.427  &lt; 2e-16 ***
ORIGIN_SZJESZ06      -1.901e+00  1.183e-02  -160.665  &lt; 2e-16 ***
ORIGIN_SZJESZ07      -1.056e+00  1.176e-02   -89.775  &lt; 2e-16 ***
ORIGIN_SZJESZ08       4.952e-01  5.034e-03    98.375  &lt; 2e-16 ***
ORIGIN_SZJESZ09      -1.867e+00  1.800e-02  -103.724  &lt; 2e-16 ***
ORIGIN_SZJESZ10      -2.065e+00  1.966e-02  -105.011  &lt; 2e-16 ***
ORIGIN_SZJWSZ01       2.112e-01  6.405e-03    32.980  &lt; 2e-16 ***
ORIGIN_SZJWSZ02       9.365e-01  4.539e-03   206.339  &lt; 2e-16 ***
ORIGIN_SZJWSZ03       1.337e+00  4.196e-03   318.716  &lt; 2e-16 ***
ORIGIN_SZJWSZ04       1.350e+00  4.286e-03   314.883  &lt; 2e-16 ***
ORIGIN_SZJWSZ05      -1.396e+00  1.252e-02  -111.543  &lt; 2e-16 ***
ORIGIN_SZJWSZ06      -1.048e+00  1.067e-02   -98.181  &lt; 2e-16 ***
ORIGIN_SZJWSZ07      -2.726e+00  2.751e-02   -99.095  &lt; 2e-16 ***
ORIGIN_SZJWSZ08       1.968e+00  4.136e-03   475.878  &lt; 2e-16 ***
ORIGIN_SZJWSZ09       1.759e+00  3.954e-03   444.846  &lt; 2e-16 ***
ORIGIN_SZKLSZ01       1.670e-01  4.902e-03    34.071  &lt; 2e-16 ***
ORIGIN_SZKLSZ02      -5.154e-01  6.321e-03   -81.534  &lt; 2e-16 ***
ORIGIN_SZKLSZ03      -4.123e-01  5.949e-03   -69.296  &lt; 2e-16 ***
ORIGIN_SZKLSZ04      -2.283e+00  1.188e-02  -192.202  &lt; 2e-16 ***
ORIGIN_SZKLSZ05      -8.643e-01  8.271e-03  -104.489  &lt; 2e-16 ***
ORIGIN_SZKLSZ06      -4.739e+00  1.857e-01   -25.513  &lt; 2e-16 ***
ORIGIN_SZKLSZ07      -1.124e+00  8.408e-03  -133.651  &lt; 2e-16 ***
ORIGIN_SZKLSZ08      -1.483e+00  9.152e-03  -162.074  &lt; 2e-16 ***
ORIGIN_SZKLSZ09      -3.001e+00  3.129e-02   -95.919  &lt; 2e-16 ***
ORIGIN_SZLKSZ01      -3.407e+00  4.112e-02   -82.854  &lt; 2e-16 ***
ORIGIN_SZMDSZ01      -2.656e+00  2.802e-02   -94.772  &lt; 2e-16 ***
ORIGIN_SZMDSZ02      -9.216e-01  1.036e-02   -88.993  &lt; 2e-16 ***
ORIGIN_SZMDSZ03      -2.005e+00  1.703e-02  -117.719  &lt; 2e-16 ***
ORIGIN_SZMPSZ01      -1.090e+00  8.368e-03  -130.210  &lt; 2e-16 ***
ORIGIN_SZMPSZ02      -5.966e-01  6.898e-03   -86.477  &lt; 2e-16 ***
ORIGIN_SZMPSZ03      -7.337e-03  5.319e-03    -1.379  0.16779    
ORIGIN_SZMUSZ02      -3.914e+00  1.038e-01   -37.724  &lt; 2e-16 ***
ORIGIN_SZNTSZ01      -2.824e+00  3.529e-02   -80.022  &lt; 2e-16 ***
ORIGIN_SZNTSZ02      -3.261e+00  2.323e-02  -140.392  &lt; 2e-16 ***
ORIGIN_SZNTSZ03      -9.932e-01  7.777e-03  -127.711  &lt; 2e-16 ***
ORIGIN_SZNTSZ05      -3.355e+00  4.964e-02   -67.596  &lt; 2e-16 ***
ORIGIN_SZNTSZ06      -3.822e+00  5.576e-02   -68.554  &lt; 2e-16 ***
ORIGIN_SZNVSZ01       4.493e-01  4.482e-03   100.244  &lt; 2e-16 ***
ORIGIN_SZNVSZ02      -6.281e-01  6.470e-03   -97.079  &lt; 2e-16 ***
ORIGIN_SZNVSZ03      -1.212e+00  7.788e-03  -155.631  &lt; 2e-16 ***
ORIGIN_SZNVSZ04      -1.454e+00  9.091e-03  -159.939  &lt; 2e-16 ***
ORIGIN_SZNVSZ05      -2.618e+00  1.579e-02  -165.843  &lt; 2e-16 ***
ORIGIN_SZPGSZ01      -9.554e-01  1.223e-02   -78.143  &lt; 2e-16 ***
ORIGIN_SZPGSZ02      -5.298e-01  7.233e-03   -73.255  &lt; 2e-16 ***
ORIGIN_SZPGSZ03       9.636e-01  4.437e-03   217.164  &lt; 2e-16 ***
ORIGIN_SZPGSZ04       1.115e+00  4.417e-03   252.455  &lt; 2e-16 ***
ORIGIN_SZPGSZ05       2.723e-01  5.758e-03    47.301  &lt; 2e-16 ***
ORIGIN_SZPLSZ01      -8.414e-01  1.044e-02   -80.616  &lt; 2e-16 ***
ORIGIN_SZPLSZ02      -1.704e+00  1.478e-02  -115.290  &lt; 2e-16 ***
ORIGIN_SZPLSZ03      -3.011e+00  3.672e-02   -81.995  &lt; 2e-16 ***
ORIGIN_SZPLSZ04      -3.313e+00  3.684e-02   -89.923  &lt; 2e-16 ***
ORIGIN_SZPLSZ05      -2.494e+00  2.245e-02  -111.086  &lt; 2e-16 ***
ORIGIN_SZPNSZ01       1.390e+00  4.587e-03   303.067  &lt; 2e-16 ***
ORIGIN_SZPNSZ02      -5.588e-01  1.108e-02   -50.420  &lt; 2e-16 ***
ORIGIN_SZPNSZ03      -1.927e+00  1.940e-02   -99.323  &lt; 2e-16 ***
ORIGIN_SZPNSZ04      -2.812e+00  3.112e-02   -90.351  &lt; 2e-16 ***
ORIGIN_SZPNSZ05      -2.325e+00  2.628e-02   -88.494  &lt; 2e-16 ***
ORIGIN_SZPRSZ01      -8.278e-01  1.142e-02   -72.506  &lt; 2e-16 ***
ORIGIN_SZPRSZ02       9.441e-01  4.615e-03   204.580  &lt; 2e-16 ***
ORIGIN_SZPRSZ03       7.722e-01  4.626e-03   166.924  &lt; 2e-16 ***
ORIGIN_SZPRSZ04      -3.771e-01  7.516e-03   -50.170  &lt; 2e-16 ***
ORIGIN_SZPRSZ05       1.332e+00  4.326e-03   307.840  &lt; 2e-16 ***
ORIGIN_SZPRSZ06      -4.352e-01  8.652e-03   -50.302  &lt; 2e-16 ***
ORIGIN_SZPRSZ07      -2.153e+00  1.610e-02  -133.686  &lt; 2e-16 ***
ORIGIN_SZPRSZ08       2.034e-03  6.383e-03     0.319  0.74997    
ORIGIN_SZQTSZ01      -4.154e-01  6.846e-03   -60.687  &lt; 2e-16 ***
ORIGIN_SZQTSZ02      -8.964e-01  6.554e-03  -136.764  &lt; 2e-16 ***
ORIGIN_SZQTSZ03      -2.433e-01  5.681e-03   -42.827  &lt; 2e-16 ***
ORIGIN_SZQTSZ04      -1.014e+00  7.147e-03  -141.878  &lt; 2e-16 ***
ORIGIN_SZQTSZ05      -3.924e-01  5.994e-03   -65.469  &lt; 2e-16 ***
ORIGIN_SZQTSZ06      -5.652e-01  6.481e-03   -87.212  &lt; 2e-16 ***
ORIGIN_SZQTSZ07      -1.557e+00  9.661e-03  -161.147  &lt; 2e-16 ***
ORIGIN_SZQTSZ08      -1.742e-01  5.711e-03   -30.508  &lt; 2e-16 ***
ORIGIN_SZQTSZ09      -6.298e-01  6.633e-03   -94.939  &lt; 2e-16 ***
ORIGIN_SZQTSZ10      -4.540e-01  6.512e-03   -69.717  &lt; 2e-16 ***
ORIGIN_SZQTSZ11      -1.474e+00  9.854e-03  -149.591  &lt; 2e-16 ***
ORIGIN_SZQTSZ12      -1.507e+00  1.048e-02  -143.798  &lt; 2e-16 ***
ORIGIN_SZQTSZ13      -3.515e-01  6.415e-03   -54.787  &lt; 2e-16 ***
ORIGIN_SZQTSZ14      -1.601e+00  9.848e-03  -162.557  &lt; 2e-16 ***
ORIGIN_SZQTSZ15      -9.283e-01  1.037e-02   -89.550  &lt; 2e-16 ***
ORIGIN_SZRCSZ01      -1.375e+00  1.265e-02  -108.643  &lt; 2e-16 ***
ORIGIN_SZRCSZ06      -6.220e-01  8.475e-03   -73.399  &lt; 2e-16 ***
ORIGIN_SZRVSZ01      -3.528e+00  3.237e-02  -108.977  &lt; 2e-16 ***
ORIGIN_SZRVSZ02      -2.914e+00  2.776e-02  -104.969  &lt; 2e-16 ***
ORIGIN_SZRVSZ03      -3.151e+00  2.379e-02  -132.454  &lt; 2e-16 ***
ORIGIN_SZRVSZ04      -3.360e+00  5.567e-02   -60.356  &lt; 2e-16 ***
ORIGIN_SZRVSZ05      -2.441e+00  1.644e-02  -148.448  &lt; 2e-16 ***
ORIGIN_SZSBSZ01       5.918e-01  5.529e-03   107.026  &lt; 2e-16 ***
ORIGIN_SZSBSZ02      -7.116e-01  8.213e-03   -86.651  &lt; 2e-16 ***
ORIGIN_SZSBSZ03       9.629e-01  4.611e-03   208.849  &lt; 2e-16 ***
ORIGIN_SZSBSZ04       7.689e-01  5.289e-03   145.378  &lt; 2e-16 ***
ORIGIN_SZSBSZ05      -9.923e-02  6.543e-03   -15.165  &lt; 2e-16 ***
ORIGIN_SZSBSZ06      -1.785e+00  1.719e-02  -103.815  &lt; 2e-16 ***
ORIGIN_SZSBSZ07      -1.188e+00  1.256e-02   -94.633  &lt; 2e-16 ***
ORIGIN_SZSBSZ08      -1.245e+00  1.222e-02  -101.924  &lt; 2e-16 ***
ORIGIN_SZSBSZ09      -6.004e-01  8.580e-03   -69.982  &lt; 2e-16 ***
ORIGIN_SZSESZ02       1.006e+00  4.409e-03   228.108  &lt; 2e-16 ***
ORIGIN_SZSESZ03       1.219e+00  4.164e-03   292.883  &lt; 2e-16 ***
ORIGIN_SZSESZ04       8.171e-01  4.868e-03   167.840  &lt; 2e-16 ***
ORIGIN_SZSESZ05      -2.153e-01  5.915e-03   -36.395  &lt; 2e-16 ***
ORIGIN_SZSESZ06       7.333e-01  4.689e-03   156.388  &lt; 2e-16 ***
ORIGIN_SZSESZ07      -2.561e+00  1.961e-02  -130.595  &lt; 2e-16 ***
ORIGIN_SZSGSZ01      -1.015e+00  8.550e-03  -118.682  &lt; 2e-16 ***
ORIGIN_SZSGSZ02      -1.133e+00  9.590e-03  -118.117  &lt; 2e-16 ***
ORIGIN_SZSGSZ03       2.195e-01  5.167e-03    42.469  &lt; 2e-16 ***
ORIGIN_SZSGSZ04       2.709e-01  4.792e-03    56.540  &lt; 2e-16 ***
ORIGIN_SZSGSZ05      -1.783e+00  1.060e-02  -168.215  &lt; 2e-16 ***
ORIGIN_SZSGSZ06       4.037e-01  4.541e-03    88.909  &lt; 2e-16 ***
ORIGIN_SZSGSZ07      -6.271e-01  6.235e-03  -100.591  &lt; 2e-16 ***
ORIGIN_SZSKSZ01      -2.229e-01  7.766e-03   -28.702  &lt; 2e-16 ***
ORIGIN_SZSKSZ02       3.738e-01  5.689e-03    65.704  &lt; 2e-16 ***
ORIGIN_SZSKSZ03      -7.007e-01  7.984e-03   -87.762  &lt; 2e-16 ***
ORIGIN_SZSKSZ04      -2.572e+00  2.702e-02   -95.190  &lt; 2e-16 ***
ORIGIN_SZSKSZ05      -1.416e+00  1.552e-02   -91.244  &lt; 2e-16 ***
ORIGIN_SZSLSZ01      -3.240e+00  3.058e-02  -105.930  &lt; 2e-16 ***
ORIGIN_SZSLSZ04      -6.855e-01  7.683e-03   -89.212  &lt; 2e-16 ***
ORIGIN_SZSRSZ01      -2.392e+00  1.583e-02  -151.179  &lt; 2e-16 ***
ORIGIN_SZTMSZ01       4.030e-01  5.814e-03    69.317  &lt; 2e-16 ***
ORIGIN_SZTMSZ02       2.225e+00  3.795e-03   586.433  &lt; 2e-16 ***
ORIGIN_SZTMSZ03       1.415e+00  4.108e-03   344.346  &lt; 2e-16 ***
ORIGIN_SZTMSZ04       9.131e-01  4.742e-03   192.571  &lt; 2e-16 ***
ORIGIN_SZTMSZ05      -3.267e-01  7.534e-03   -43.356  &lt; 2e-16 ***
ORIGIN_SZTNSZ01      -1.807e+00  1.038e-02  -174.116  &lt; 2e-16 ***
ORIGIN_SZTNSZ02      -1.743e+00  9.778e-03  -178.256  &lt; 2e-16 ***
ORIGIN_SZTNSZ03      -2.279e+00  1.338e-02  -170.383  &lt; 2e-16 ***
ORIGIN_SZTNSZ04      -7.728e-01  7.197e-03  -107.380  &lt; 2e-16 ***
ORIGIN_SZTPSZ01      -6.450e-01  6.287e-03  -102.586  &lt; 2e-16 ***
ORIGIN_SZTPSZ02       4.679e-01  4.347e-03   107.628  &lt; 2e-16 ***
ORIGIN_SZTPSZ03      -5.153e-01  6.085e-03   -84.696  &lt; 2e-16 ***
ORIGIN_SZTPSZ04      -2.885e-01  5.779e-03   -49.929  &lt; 2e-16 ***
ORIGIN_SZTPSZ05      -2.171e-01  6.072e-03   -35.747  &lt; 2e-16 ***
ORIGIN_SZTPSZ06       3.343e-01  5.942e-03    56.255  &lt; 2e-16 ***
ORIGIN_SZTPSZ07      -2.529e-01  6.317e-03   -40.027  &lt; 2e-16 ***
ORIGIN_SZTPSZ08      -1.076e+00  9.109e-03  -118.071  &lt; 2e-16 ***
ORIGIN_SZTPSZ09      -3.700e-01  6.189e-03   -59.777  &lt; 2e-16 ***
ORIGIN_SZTPSZ10      -7.008e-01  7.635e-03   -91.794  &lt; 2e-16 ***
ORIGIN_SZTPSZ11       7.676e-02  5.459e-03    14.060  &lt; 2e-16 ***
ORIGIN_SZTPSZ12      -5.960e-01  6.522e-03   -91.388  &lt; 2e-16 ***
ORIGIN_SZTSSZ01      -3.551e+00  4.755e-02   -74.678  &lt; 2e-16 ***
ORIGIN_SZTSSZ02       2.582e-01  7.339e-03    35.182  &lt; 2e-16 ***
ORIGIN_SZTSSZ03       3.057e-01  7.074e-03    43.214  &lt; 2e-16 ***
ORIGIN_SZTSSZ04       2.841e-01  7.479e-03    37.985  &lt; 2e-16 ***
ORIGIN_SZTSSZ05      -1.103e+00  1.389e-02   -79.411  &lt; 2e-16 ***
ORIGIN_SZTSSZ06      -1.362e+00  1.718e-02   -79.311  &lt; 2e-16 ***
ORIGIN_SZWDSZ01       1.359e+00  4.146e-03   327.844  &lt; 2e-16 ***
ORIGIN_SZWDSZ02       1.042e+00  4.747e-03   219.450  &lt; 2e-16 ***
ORIGIN_SZWDSZ03       2.192e+00  4.035e-03   543.223  &lt; 2e-16 ***
ORIGIN_SZWDSZ04       1.146e+00  4.963e-03   230.968  &lt; 2e-16 ***
ORIGIN_SZWDSZ05       5.149e-01  4.998e-03   103.010  &lt; 2e-16 ***
ORIGIN_SZWDSZ06       1.205e+00  4.611e-03   261.314  &lt; 2e-16 ***
ORIGIN_SZWDSZ07      -4.076e-01  8.035e-03   -50.729  &lt; 2e-16 ***
ORIGIN_SZWDSZ08      -5.072e-01  7.878e-03   -64.380  &lt; 2e-16 ***
ORIGIN_SZWDSZ09       1.469e+00  4.402e-03   333.784  &lt; 2e-16 ***
ORIGIN_SZYSSZ01      -1.543e-01  5.643e-03   -27.335  &lt; 2e-16 ***
ORIGIN_SZYSSZ02       8.990e-01  4.973e-03   180.778  &lt; 2e-16 ***
ORIGIN_SZYSSZ03       1.761e+00  4.275e-03   411.879  &lt; 2e-16 ***
ORIGIN_SZYSSZ04       8.478e-01  4.538e-03   186.812  &lt; 2e-16 ***
ORIGIN_SZYSSZ05      -9.798e-02  5.920e-03   -16.551  &lt; 2e-16 ***
ORIGIN_SZYSSZ06      -1.180e+00  1.079e-02  -109.309  &lt; 2e-16 ***
ORIGIN_SZYSSZ07      -1.212e+00  1.127e-02  -107.523  &lt; 2e-16 ***
ORIGIN_SZYSSZ08       1.173e-02  6.104e-03     1.921  0.05474 .  
ORIGIN_SZYSSZ09       1.386e+00  4.239e-03   326.910  &lt; 2e-16 ***
log(DESTIN_AGE25_64)  1.725e-02  8.976e-05   192.206  &lt; 2e-16 ***
log(dist)            -6.974e-01  1.299e-04 -5369.356  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 59965744  on 14439  degrees of freedom
Residual deviance: 26225309  on 14169  degrees of freedom
AIC: 26315774

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(orcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, orcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4176108</code></pre>
</div>
</div>
</section>
<section id="destination-constrained" class="level2">
<h2 class="anchored" data-anchor-id="destination-constrained"><strong>6.7 Destination constrained</strong></h2>
<p>In this section, we will fit a destination constrained SIM by using the code chunk below.</p>
<p>The general formula of Destination Constrained Spatial Interaction Model</p>
<p><img src="https://r4gdsa.netlify.app/chap15/img/image3.jpg" class="img-fluid"></p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>decSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(ORIGIN_AGE25_64) <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(decSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), 
    family = poisson(link = "log"), data = SIM_data, na.action = na.exclude)

Coefficients:
                       Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)          10.9048570  0.0033523  3252.910  &lt; 2e-16 ***
DESTIN_SZAMSZ02       0.1794342  0.0041531    43.205  &lt; 2e-16 ***
DESTIN_SZAMSZ03       0.2090428  0.0040888    51.125  &lt; 2e-16 ***
DESTIN_SZAMSZ04      -0.9401652  0.0060637  -155.047  &lt; 2e-16 ***
DESTIN_SZAMSZ05      -1.1572689  0.0061804  -187.249  &lt; 2e-16 ***
DESTIN_SZAMSZ06      -0.8873938  0.0059241  -149.794  &lt; 2e-16 ***
DESTIN_SZAMSZ07      -1.7747577  0.0096070  -184.735  &lt; 2e-16 ***
DESTIN_SZAMSZ08      -1.0725433  0.0067763  -158.278  &lt; 2e-16 ***
DESTIN_SZAMSZ09      -0.9677570  0.0060435  -160.132  &lt; 2e-16 ***
DESTIN_SZAMSZ10       0.2626640  0.0043738    60.054  &lt; 2e-16 ***
DESTIN_SZAMSZ11      -0.3817442  0.0086203   -44.284  &lt; 2e-16 ***
DESTIN_SZAMSZ12       0.0227389  0.0049853     4.561 5.09e-06 ***
DESTIN_SZBDSZ01       0.5188375  0.0037828   137.158  &lt; 2e-16 ***
DESTIN_SZBDSZ02      -0.2810011  0.0049518   -56.748  &lt; 2e-16 ***
DESTIN_SZBDSZ03      -0.0094520  0.0042692    -2.214   0.0268 *  
DESTIN_SZBDSZ04       1.0072820  0.0034465   292.261  &lt; 2e-16 ***
DESTIN_SZBDSZ05       0.3727823  0.0038992    95.604  &lt; 2e-16 ***
DESTIN_SZBDSZ06       0.2034898  0.0042183    48.240  &lt; 2e-16 ***
DESTIN_SZBDSZ07      -1.0700301  0.0092942  -115.128  &lt; 2e-16 ***
DESTIN_SZBDSZ08      -1.7761373  0.0105722  -168.001  &lt; 2e-16 ***
DESTIN_SZBKSZ01      -1.1851806  0.0065623  -180.605  &lt; 2e-16 ***
DESTIN_SZBKSZ02      -0.2605523  0.0052044   -50.064  &lt; 2e-16 ***
DESTIN_SZBKSZ03      -0.5859135  0.0055889  -104.836  &lt; 2e-16 ***
DESTIN_SZBKSZ04      -0.0396635  0.0048300    -8.212  &lt; 2e-16 ***
DESTIN_SZBKSZ05      -0.8199651  0.0057162  -143.446  &lt; 2e-16 ***
DESTIN_SZBKSZ06      -0.8595238  0.0061131  -140.602  &lt; 2e-16 ***
DESTIN_SZBKSZ07       0.2328526  0.0040343    57.718  &lt; 2e-16 ***
DESTIN_SZBKSZ08      -1.1213047  0.0068909  -162.723  &lt; 2e-16 ***
DESTIN_SZBKSZ09      -0.2885351  0.0049057   -58.817  &lt; 2e-16 ***
DESTIN_SZBLSZ01      -0.4314048  0.0070373   -61.302  &lt; 2e-16 ***
DESTIN_SZBLSZ02       0.6225445  0.0065214    95.461  &lt; 2e-16 ***
DESTIN_SZBLSZ03       1.2994918  0.0074176   175.191  &lt; 2e-16 ***
DESTIN_SZBLSZ04      -0.0867525  0.0131590    -6.593 4.32e-11 ***
DESTIN_SZBMSZ01      -0.3519222  0.0046932   -74.986  &lt; 2e-16 ***
DESTIN_SZBMSZ02      -0.6047253  0.0048827  -123.849  &lt; 2e-16 ***
DESTIN_SZBMSZ03      -0.8764932  0.0056851  -154.173  &lt; 2e-16 ***
DESTIN_SZBMSZ04      -0.5386213  0.0048888  -110.175  &lt; 2e-16 ***
DESTIN_SZBMSZ05      -0.5045702  0.0065972   -76.483  &lt; 2e-16 ***
DESTIN_SZBMSZ06      -2.0715224  0.0123050  -168.348  &lt; 2e-16 ***
DESTIN_SZBMSZ07      -0.3146773  0.0045283   -69.491  &lt; 2e-16 ***
DESTIN_SZBMSZ08      -1.2783009  0.0062622  -204.130  &lt; 2e-16 ***
DESTIN_SZBMSZ09      -2.8159501  0.0143531  -196.190  &lt; 2e-16 ***
DESTIN_SZBMSZ10      -1.9257815  0.0089273  -215.718  &lt; 2e-16 ***
DESTIN_SZBMSZ11      -1.7330104  0.0079280  -218.592  &lt; 2e-16 ***
DESTIN_SZBMSZ12      -1.1563618  0.0077721  -148.784  &lt; 2e-16 ***
DESTIN_SZBMSZ13      -0.5415215  0.0050827  -106.543  &lt; 2e-16 ***
DESTIN_SZBMSZ14      -1.1498161  0.0076325  -150.647  &lt; 2e-16 ***
DESTIN_SZBMSZ15      -1.2258914  0.0068685  -178.481  &lt; 2e-16 ***
DESTIN_SZBMSZ16      -2.4130400  0.0107906  -223.625  &lt; 2e-16 ***
DESTIN_SZBMSZ17      -2.6995857  0.0164771  -163.839  &lt; 2e-16 ***
DESTIN_SZBPSZ01      -0.6609664  0.0055422  -119.262  &lt; 2e-16 ***
DESTIN_SZBPSZ02      -1.4575221  0.0083272  -175.032  &lt; 2e-16 ***
DESTIN_SZBPSZ03      -1.0776369  0.0075110  -143.475  &lt; 2e-16 ***
DESTIN_SZBPSZ04      -0.6644971  0.0058070  -114.430  &lt; 2e-16 ***
DESTIN_SZBPSZ05       0.3370210  0.0039665    84.968  &lt; 2e-16 ***
DESTIN_SZBPSZ06      -0.9405736  0.0077394  -121.531  &lt; 2e-16 ***
DESTIN_SZBPSZ07      -0.6923515  0.0077761   -89.035  &lt; 2e-16 ***
DESTIN_SZBSSZ01      -0.3132696  0.0045803   -68.395  &lt; 2e-16 ***
DESTIN_SZBSSZ02      -0.7502434  0.0051075  -146.890  &lt; 2e-16 ***
DESTIN_SZBSSZ03       0.1994211  0.0038256    52.129  &lt; 2e-16 ***
DESTIN_SZBTSZ01       0.0756101  0.0041655    18.152  &lt; 2e-16 ***
DESTIN_SZBTSZ02      -0.8223330  0.0065871  -124.840  &lt; 2e-16 ***
DESTIN_SZBTSZ03      -0.1686173  0.0047942   -35.171  &lt; 2e-16 ***
DESTIN_SZBTSZ04      -1.7768580  0.0103706  -171.336  &lt; 2e-16 ***
DESTIN_SZBTSZ05      -0.8248176  0.0067753  -121.739  &lt; 2e-16 ***
DESTIN_SZBTSZ06      -0.8184079  0.0059754  -136.964  &lt; 2e-16 ***
DESTIN_SZBTSZ07      -2.0091001  0.0098567  -203.831  &lt; 2e-16 ***
DESTIN_SZBTSZ08      -1.3637279  0.0086828  -157.061  &lt; 2e-16 ***
DESTIN_SZCCSZ01      -1.0100002  0.0080160  -125.998  &lt; 2e-16 ***
DESTIN_SZCHSZ01      -1.1944563  0.0095262  -125.387  &lt; 2e-16 ***
DESTIN_SZCHSZ02       0.0873727  0.0052277    16.713  &lt; 2e-16 ***
DESTIN_SZCHSZ03       1.4948319  0.0039093   382.380  &lt; 2e-16 ***
DESTIN_SZCKSZ01      -0.1634909  0.0047877   -34.148  &lt; 2e-16 ***
DESTIN_SZCKSZ02      -0.4336030  0.0051906   -83.537  &lt; 2e-16 ***
DESTIN_SZCKSZ03       0.6144175  0.0038938   157.794  &lt; 2e-16 ***
DESTIN_SZCKSZ04      -0.6374068  0.0060213  -105.858  &lt; 2e-16 ***
DESTIN_SZCKSZ05      -0.4158835  0.0065477   -63.516  &lt; 2e-16 ***
DESTIN_SZCKSZ06       0.7039272  0.0045205   155.720  &lt; 2e-16 ***
DESTIN_SZCLSZ01       0.3720426  0.0047401    78.489  &lt; 2e-16 ***
DESTIN_SZCLSZ02      -2.2890079  0.0133640  -171.282  &lt; 2e-16 ***
DESTIN_SZCLSZ03      -1.0640354  0.0077341  -137.576  &lt; 2e-16 ***
DESTIN_SZCLSZ04      -0.1350210  0.0045276   -29.822  &lt; 2e-16 ***
DESTIN_SZCLSZ05      -1.3066824  0.0084133  -155.311  &lt; 2e-16 ***
DESTIN_SZCLSZ06       0.1706115  0.0040204    42.437  &lt; 2e-16 ***
DESTIN_SZCLSZ07      -0.6384155  0.0052626  -121.311  &lt; 2e-16 ***
DESTIN_SZCLSZ08      -0.4303467  0.0057208   -75.225  &lt; 2e-16 ***
DESTIN_SZCLSZ09       0.3781519  0.0063762    59.306  &lt; 2e-16 ***
DESTIN_SZDTSZ02      -3.0113027  0.0348374   -86.439  &lt; 2e-16 ***
DESTIN_SZDTSZ03      -1.4638228  0.0144110  -101.577  &lt; 2e-16 ***
DESTIN_SZGLSZ01       0.0008007  0.0051224     0.156   0.8758    
DESTIN_SZGLSZ02      -0.3400452  0.0046225   -73.564  &lt; 2e-16 ***
DESTIN_SZGLSZ03       0.3707011  0.0038385    96.576  &lt; 2e-16 ***
DESTIN_SZGLSZ04       0.2962045  0.0038027    77.894  &lt; 2e-16 ***
DESTIN_SZGLSZ05       0.1799813  0.0038854    46.322  &lt; 2e-16 ***
DESTIN_SZHGSZ01       0.2999418  0.0038825    77.255  &lt; 2e-16 ***
DESTIN_SZHGSZ02      -0.5667530  0.0051182  -110.733  &lt; 2e-16 ***
DESTIN_SZHGSZ03      -1.0354679  0.0061020  -169.693  &lt; 2e-16 ***
DESTIN_SZHGSZ04      -0.2229674  0.0043617   -51.119  &lt; 2e-16 ***
DESTIN_SZHGSZ05      -0.2243046  0.0044852   -50.010  &lt; 2e-16 ***
DESTIN_SZHGSZ06      -0.7873601  0.0054082  -145.588  &lt; 2e-16 ***
DESTIN_SZHGSZ07       0.2301402  0.0040336    57.055  &lt; 2e-16 ***
DESTIN_SZHGSZ08      -0.4244403  0.0048967   -86.678  &lt; 2e-16 ***
DESTIN_SZHGSZ09       0.1040754  0.0051341    20.271  &lt; 2e-16 ***
DESTIN_SZHGSZ10      -2.8620769  0.0262064  -109.213  &lt; 2e-16 ***
DESTIN_SZJESZ01      -0.0833734  0.0048513   -17.186  &lt; 2e-16 ***
DESTIN_SZJESZ02      -0.5229790  0.0051627  -101.299  &lt; 2e-16 ***
DESTIN_SZJESZ03      -0.6268850  0.0056619  -110.719  &lt; 2e-16 ***
DESTIN_SZJESZ05       0.3672967  0.0040723    90.194  &lt; 2e-16 ***
DESTIN_SZJESZ06      -1.1830729  0.0083207  -142.184  &lt; 2e-16 ***
DESTIN_SZJESZ07      -0.5998690  0.0078072   -76.835  &lt; 2e-16 ***
DESTIN_SZJESZ08      -0.3569870  0.0054074   -66.019  &lt; 2e-16 ***
DESTIN_SZJESZ09       0.7544414  0.0069536   108.497  &lt; 2e-16 ***
DESTIN_SZJESZ10       0.9279204  0.0065841   140.934  &lt; 2e-16 ***
DESTIN_SZJWSZ01      -0.4429734  0.0064901   -68.253  &lt; 2e-16 ***
DESTIN_SZJWSZ02      -0.2696030  0.0051841   -52.006  &lt; 2e-16 ***
DESTIN_SZJWSZ03       0.6692064  0.0039405   169.829  &lt; 2e-16 ***
DESTIN_SZJWSZ04       0.9668460  0.0037235   259.663  &lt; 2e-16 ***
DESTIN_SZJWSZ05      -0.1811230  0.0061053   -29.667  &lt; 2e-16 ***
DESTIN_SZJWSZ06       0.3956140  0.0054555    72.517  &lt; 2e-16 ***
DESTIN_SZJWSZ07      -1.2441505  0.0280511   -44.353  &lt; 2e-16 ***
DESTIN_SZJWSZ08       0.5105167  0.0044598   114.471  &lt; 2e-16 ***
DESTIN_SZJWSZ09       1.4261488  0.0033999   419.472  &lt; 2e-16 ***
DESTIN_SZKLSZ01      -0.6889038  0.0051541  -133.662  &lt; 2e-16 ***
DESTIN_SZKLSZ02      -0.8142969  0.0057129  -142.536  &lt; 2e-16 ***
DESTIN_SZKLSZ03      -1.3947234  0.0065167  -214.024  &lt; 2e-16 ***
DESTIN_SZKLSZ04      -1.9197258  0.0087370  -219.724  &lt; 2e-16 ***
DESTIN_SZKLSZ05      -0.9261163  0.0071089  -130.275  &lt; 2e-16 ***
DESTIN_SZKLSZ06      -2.5352994  0.0362062   -70.024  &lt; 2e-16 ***
DESTIN_SZKLSZ07      -1.2046443  0.0065751  -183.214  &lt; 2e-16 ***
DESTIN_SZKLSZ08      -0.6069437  0.0050916  -119.205  &lt; 2e-16 ***
DESTIN_SZKLSZ09      -2.2332579  0.0161428  -138.344  &lt; 2e-16 ***
DESTIN_SZLKSZ01      -1.7173865  0.0227798   -75.391  &lt; 2e-16 ***
DESTIN_SZMDSZ01      -1.4826104  0.0198353   -74.746  &lt; 2e-16 ***
DESTIN_SZMDSZ02      -1.1635489  0.0111347  -104.497  &lt; 2e-16 ***
DESTIN_SZMDSZ03      -3.0041676  0.0250839  -119.765  &lt; 2e-16 ***
DESTIN_SZMPSZ01      -1.1815844  0.0077128  -153.198  &lt; 2e-16 ***
DESTIN_SZMPSZ02      -0.9424158  0.0060321  -156.233  &lt; 2e-16 ***
DESTIN_SZMPSZ03      -0.1783623  0.0046389   -38.449  &lt; 2e-16 ***
DESTIN_SZMUSZ02      -2.4549101  0.0199631  -122.973  &lt; 2e-16 ***
DESTIN_SZNTSZ01      -3.6621849  0.0447752   -81.790  &lt; 2e-16 ***
DESTIN_SZNTSZ02      -2.0133234  0.0108737  -185.156  &lt; 2e-16 ***
DESTIN_SZNTSZ03      -1.2431428  0.0076142  -163.267  &lt; 2e-16 ***
DESTIN_SZNTSZ05      -1.8045038  0.0249540   -72.313  &lt; 2e-16 ***
DESTIN_SZNTSZ06      -2.9433484  0.0428601   -68.673  &lt; 2e-16 ***
DESTIN_SZNVSZ01      -0.4079260  0.0044288   -92.107  &lt; 2e-16 ***
DESTIN_SZNVSZ02      -0.6882643  0.0052770  -130.428  &lt; 2e-16 ***
DESTIN_SZNVSZ03      -0.7347477  0.0054243  -135.454  &lt; 2e-16 ***
DESTIN_SZNVSZ04      -2.2122891  0.0107185  -206.399  &lt; 2e-16 ***
DESTIN_SZNVSZ05      -1.8739867  0.0089167  -210.166  &lt; 2e-16 ***
DESTIN_SZPGSZ01      -1.8848423  0.0153008  -123.186  &lt; 2e-16 ***
DESTIN_SZPGSZ02      -0.9406940  0.0067225  -139.933  &lt; 2e-16 ***
DESTIN_SZPGSZ03       0.3510796  0.0040153    87.435  &lt; 2e-16 ***
DESTIN_SZPGSZ04      -0.0213665  0.0044806    -4.769 1.85e-06 ***
DESTIN_SZPGSZ05      -0.8888067  0.0070731  -125.660  &lt; 2e-16 ***
DESTIN_SZPLSZ01      -0.2161571  0.0068270   -31.662  &lt; 2e-16 ***
DESTIN_SZPLSZ02      -1.3661949  0.0131155  -104.166  &lt; 2e-16 ***
DESTIN_SZPLSZ03      -0.1023407  0.0095847   -10.678  &lt; 2e-16 ***
DESTIN_SZPLSZ04      -0.2719250  0.0093344   -29.131  &lt; 2e-16 ***
DESTIN_SZPLSZ05      -0.7320516  0.0116840   -62.654  &lt; 2e-16 ***
DESTIN_SZPNSZ01       1.1346701  0.0050030   226.800  &lt; 2e-16 ***
DESTIN_SZPNSZ02       1.5968935  0.0064539   247.431  &lt; 2e-16 ***
DESTIN_SZPNSZ03       0.8152494  0.0077064   105.789  &lt; 2e-16 ***
DESTIN_SZPNSZ04       1.6117326  0.0075820   212.573  &lt; 2e-16 ***
DESTIN_SZPNSZ05       0.6627057  0.0115960    57.149  &lt; 2e-16 ***
DESTIN_SZPRSZ01      -1.0227494  0.0084651  -120.819  &lt; 2e-16 ***
DESTIN_SZPRSZ02      -0.1997262  0.0049840   -40.074  &lt; 2e-16 ***
DESTIN_SZPRSZ03       0.5602753  0.0038497   145.538  &lt; 2e-16 ***
DESTIN_SZPRSZ04      -0.6872884  0.0079048   -86.946  &lt; 2e-16 ***
DESTIN_SZPRSZ05       0.0360643  0.0044947     8.024 1.03e-15 ***
DESTIN_SZPRSZ06       0.3731070  0.0052006    71.744  &lt; 2e-16 ***
DESTIN_SZPRSZ07      -1.4843250  0.0117304  -126.536  &lt; 2e-16 ***
DESTIN_SZPRSZ08      -0.7859293  0.0064863  -121.168  &lt; 2e-16 ***
DESTIN_SZQTSZ01      -1.2844606  0.0085392  -150.419  &lt; 2e-16 ***
DESTIN_SZQTSZ02      -1.5532989  0.0075748  -205.062  &lt; 2e-16 ***
DESTIN_SZQTSZ03      -0.9417558  0.0064036  -147.068  &lt; 2e-16 ***
DESTIN_SZQTSZ04      -1.0568943  0.0065335  -161.766  &lt; 2e-16 ***
DESTIN_SZQTSZ05      -0.9791783  0.0058471  -167.464  &lt; 2e-16 ***
DESTIN_SZQTSZ06      -1.2229471  0.0063559  -192.410  &lt; 2e-16 ***
DESTIN_SZQTSZ07      -1.6880979  0.0108728  -155.258  &lt; 2e-16 ***
DESTIN_SZQTSZ08      -0.1267999  0.0047981   -26.427  &lt; 2e-16 ***
DESTIN_SZQTSZ09      -0.5271811  0.0057372   -91.888  &lt; 2e-16 ***
DESTIN_SZQTSZ10      -0.6033522  0.0054192  -111.335  &lt; 2e-16 ***
DESTIN_SZQTSZ11      -0.1065174  0.0053446   -19.930  &lt; 2e-16 ***
DESTIN_SZQTSZ12      -0.6207776  0.0070682   -87.827  &lt; 2e-16 ***
DESTIN_SZQTSZ13      -0.1713212  0.0051327   -33.379  &lt; 2e-16 ***
DESTIN_SZQTSZ14      -0.5412722  0.0062295   -86.888  &lt; 2e-16 ***
DESTIN_SZQTSZ15      -0.2018865  0.0073133   -27.605  &lt; 2e-16 ***
DESTIN_SZRCSZ01      -0.5887462  0.0071799   -82.000  &lt; 2e-16 ***
DESTIN_SZRCSZ06      -2.0792352  0.0188789  -110.135  &lt; 2e-16 ***
DESTIN_SZRVSZ01      -2.6275247  0.0162319  -161.874  &lt; 2e-16 ***
DESTIN_SZRVSZ02      -3.2048147  0.0326141   -98.265  &lt; 2e-16 ***
DESTIN_SZRVSZ03      -2.6101244  0.0135074  -193.236  &lt; 2e-16 ***
DESTIN_SZRVSZ04      -1.9761848  0.0154961  -127.528  &lt; 2e-16 ***
DESTIN_SZRVSZ05      -3.1658254  0.0256310  -123.516  &lt; 2e-16 ***
DESTIN_SZSBSZ01      -0.3141815  0.0060601   -51.845  &lt; 2e-16 ***
DESTIN_SZSBSZ02      -1.1269245  0.0076338  -147.623  &lt; 2e-16 ***
DESTIN_SZSBSZ03       0.6278879  0.0041400   151.665  &lt; 2e-16 ***
DESTIN_SZSBSZ04       0.1390338  0.0051357    27.072  &lt; 2e-16 ***
DESTIN_SZSBSZ05      -0.9300945  0.0071963  -129.246  &lt; 2e-16 ***
DESTIN_SZSBSZ06      -2.3688755  0.0221612  -106.893  &lt; 2e-16 ***
DESTIN_SZSBSZ07      -0.8266276  0.0181719   -45.489  &lt; 2e-16 ***
DESTIN_SZSBSZ08       1.3086845  0.0051611   253.569  &lt; 2e-16 ***
DESTIN_SZSBSZ09       0.8367350  0.0048334   173.117  &lt; 2e-16 ***
DESTIN_SZSESZ02      -0.2330407  0.0046619   -49.989  &lt; 2e-16 ***
DESTIN_SZSESZ03       0.5496954  0.0036933   148.836  &lt; 2e-16 ***
DESTIN_SZSESZ04      -0.6672495  0.0054223  -123.057  &lt; 2e-16 ***
DESTIN_SZSESZ05      -0.3560664  0.0047508   -74.949  &lt; 2e-16 ***
DESTIN_SZSESZ06      -0.6054775  0.0057017  -106.192  &lt; 2e-16 ***
DESTIN_SZSESZ07      -2.9485846  0.0226797  -130.010  &lt; 2e-16 ***
DESTIN_SZSGSZ01      -0.5148041  0.0058281   -88.332  &lt; 2e-16 ***
DESTIN_SZSGSZ02      -0.0421213  0.0051633    -8.158 3.41e-16 ***
DESTIN_SZSGSZ03      -0.3703320  0.0047152   -78.539  &lt; 2e-16 ***
DESTIN_SZSGSZ04      -0.3030801  0.0046866   -64.670  &lt; 2e-16 ***
DESTIN_SZSGSZ05      -2.2243063  0.0097908  -227.183  &lt; 2e-16 ***
DESTIN_SZSGSZ06       0.2963958  0.0037948    78.106  &lt; 2e-16 ***
DESTIN_SZSGSZ07      -0.5960150  0.0051371  -116.022  &lt; 2e-16 ***
DESTIN_SZSISZ01      -1.4550850  0.0257791   -56.444  &lt; 2e-16 ***
DESTIN_SZSKSZ01      -0.0265314  0.0066937    -3.964 7.38e-05 ***
DESTIN_SZSKSZ02       0.7256080  0.0050282   144.306  &lt; 2e-16 ***
DESTIN_SZSKSZ03      -0.0530996  0.0059298    -8.955  &lt; 2e-16 ***
DESTIN_SZSKSZ04      -0.5929247  0.0139688   -42.446  &lt; 2e-16 ***
DESTIN_SZSKSZ05       0.1156798  0.0104889    11.029  &lt; 2e-16 ***
DESTIN_SZSLSZ01      -0.5835210  0.0083356   -70.003  &lt; 2e-16 ***
DESTIN_SZSLSZ04      -0.8160693  0.0070329  -116.037  &lt; 2e-16 ***
DESTIN_SZSRSZ01      -2.3393753  0.0127215  -183.891  &lt; 2e-16 ***
DESTIN_SZTMSZ01      -0.1231510  0.0055152   -22.329  &lt; 2e-16 ***
DESTIN_SZTMSZ02       1.6030248  0.0032600   491.725  &lt; 2e-16 ***
DESTIN_SZTMSZ03       0.7037004  0.0037139   189.479  &lt; 2e-16 ***
DESTIN_SZTMSZ04       0.8612441  0.0037593   229.098  &lt; 2e-16 ***
DESTIN_SZTMSZ05       0.3752259  0.0051282    73.170  &lt; 2e-16 ***
DESTIN_SZTNSZ01      -1.2636218  0.0066979  -188.659  &lt; 2e-16 ***
DESTIN_SZTNSZ02      -2.0845757  0.0096538  -215.934  &lt; 2e-16 ***
DESTIN_SZTNSZ03      -2.1182988  0.0115717  -183.058  &lt; 2e-16 ***
DESTIN_SZTNSZ04      -1.2431885  0.0068503  -181.479  &lt; 2e-16 ***
DESTIN_SZTPSZ01      -0.7102436  0.0055768  -127.356  &lt; 2e-16 ***
DESTIN_SZTPSZ02       0.1529801  0.0037262    41.056  &lt; 2e-16 ***
DESTIN_SZTPSZ03      -0.5006066  0.0054878   -91.222  &lt; 2e-16 ***
DESTIN_SZTPSZ04      -1.5151733  0.0071592  -211.640  &lt; 2e-16 ***
DESTIN_SZTPSZ05      -0.9189658  0.0056750  -161.932  &lt; 2e-16 ***
DESTIN_SZTPSZ06      -0.2784194  0.0062637   -44.450  &lt; 2e-16 ***
DESTIN_SZTPSZ07      -2.0207635  0.0116674  -173.198  &lt; 2e-16 ***
DESTIN_SZTPSZ08      -1.4907652  0.0085532  -174.294  &lt; 2e-16 ***
DESTIN_SZTPSZ09      -0.5879097  0.0059429   -98.927  &lt; 2e-16 ***
DESTIN_SZTPSZ10      -1.1216467  0.0084488  -132.758  &lt; 2e-16 ***
DESTIN_SZTPSZ11      -0.4823156  0.0050940   -94.684  &lt; 2e-16 ***
DESTIN_SZTPSZ12      -0.8718941  0.0061326  -142.173  &lt; 2e-16 ***
DESTIN_SZTSSZ01      -0.6337757  0.0208548   -30.390  &lt; 2e-16 ***
DESTIN_SZTSSZ02       0.7617504  0.0093787    81.222  &lt; 2e-16 ***
DESTIN_SZTSSZ03       1.6285172  0.0064448   252.688  &lt; 2e-16 ***
DESTIN_SZTSSZ04       1.2272135  0.0074573   164.566  &lt; 2e-16 ***
DESTIN_SZTSSZ05       1.8512518  0.0067488   274.309  &lt; 2e-16 ***
DESTIN_SZTSSZ06       0.3803253  0.0137938    27.572  &lt; 2e-16 ***
DESTIN_SZWDSZ01       1.5206993  0.0034774   437.313  &lt; 2e-16 ***
DESTIN_SZWDSZ02      -0.3006326  0.0055149   -54.512  &lt; 2e-16 ***
DESTIN_SZWDSZ03       1.2549921  0.0036112   347.527  &lt; 2e-16 ***
DESTIN_SZWDSZ04      -0.1698327  0.0058296   -29.133  &lt; 2e-16 ***
DESTIN_SZWDSZ05       0.0007569  0.0053912     0.140   0.8883    
DESTIN_SZWDSZ06       0.5251769  0.0040323   130.243  &lt; 2e-16 ***
DESTIN_SZWDSZ07       0.5858817  0.0061753    94.875  &lt; 2e-16 ***
DESTIN_SZWDSZ08       0.6530283  0.0060875   107.274  &lt; 2e-16 ***
DESTIN_SZWDSZ09       0.6234289  0.0044864   138.961  &lt; 2e-16 ***
DESTIN_SZYSSZ01       1.0442691  0.0038255   272.973  &lt; 2e-16 ***
DESTIN_SZYSSZ02       0.2332146  0.0048213    48.372  &lt; 2e-16 ***
DESTIN_SZYSSZ03      -0.0899327  0.0051336   -17.519  &lt; 2e-16 ***
DESTIN_SZYSSZ04      -0.0080433  0.0048684    -1.652   0.0985 .  
DESTIN_SZYSSZ05      -1.5781767  0.0100298  -157.349  &lt; 2e-16 ***
DESTIN_SZYSSZ06      -1.8140862  0.0098617  -183.953  &lt; 2e-16 ***
DESTIN_SZYSSZ07      -1.1854731  0.0111526  -106.296  &lt; 2e-16 ***
DESTIN_SZYSSZ08       0.5263279  0.0039556   133.060  &lt; 2e-16 ***
DESTIN_SZYSSZ09       0.4386227  0.0038890   112.786  &lt; 2e-16 ***
log(ORIGIN_AGE25_64)  0.2173081  0.0001419  1531.715  &lt; 2e-16 ***
log(dist)            -0.7025308  0.0001291 -5441.812  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 59965744  on 14439  degrees of freedom
Residual deviance: 25825494  on 14168  degrees of freedom
AIC: 25915960

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(decSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, decSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5019401</code></pre>
</div>
</div>
</section>
<section id="doubly-constrained" class="level2">
<h2 class="anchored" data-anchor-id="doubly-constrained"><strong>6.8 Doubly constrained</strong></h2>
<p>In this section, we will fit a doubly constrained SIM by using the code chunk below.</p>
<p>The general formula of Doubly Constrained Spatial Interaction Model</p>
<p><img src="https://r4gdsa.netlify.app/chap15/img/image4.jpg" class="img-fluid"></p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>dbcSIM <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> TRIPS <span class="sc">~</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                ORIGIN_SZ <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                DESTIN_SZ <span class="sc">+</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(dist),</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> SIM_data,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.action =</span> na.exclude)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = "log"), 
    data = SIM_data, na.action = na.exclude)

Coefficients:
                  Estimate Std. Error   z value Pr(&gt;|z|)    
(Intercept)     12.4351573  0.0043926  2830.937  &lt; 2e-16 ***
ORIGIN_SZAMSZ02  0.9481862  0.0045758   207.218  &lt; 2e-16 ***
ORIGIN_SZAMSZ03  0.5512068  0.0046690   118.057  &lt; 2e-16 ***
ORIGIN_SZAMSZ04  0.1020551  0.0052479    19.447  &lt; 2e-16 ***
ORIGIN_SZAMSZ05  0.0866741  0.0058678    14.771  &lt; 2e-16 ***
ORIGIN_SZAMSZ06  0.6620333  0.0052597   125.870  &lt; 2e-16 ***
ORIGIN_SZAMSZ07 -0.9494010  0.0097696   -97.180  &lt; 2e-16 ***
ORIGIN_SZAMSZ08 -0.7267160  0.0090969   -79.886  &lt; 2e-16 ***
ORIGIN_SZAMSZ09  0.4898190  0.0055220    88.702  &lt; 2e-16 ***
ORIGIN_SZAMSZ10  0.4817015  0.0048193    99.952  &lt; 2e-16 ***
ORIGIN_SZAMSZ11 -1.7720704  0.0130731  -135.550  &lt; 2e-16 ***
ORIGIN_SZAMSZ12 -1.7703564  0.0108797  -162.721  &lt; 2e-16 ***
ORIGIN_SZBDSZ01  0.8311685  0.0045214   183.829  &lt; 2e-16 ***
ORIGIN_SZBDSZ02  0.4304377  0.0052562    81.892  &lt; 2e-16 ***
ORIGIN_SZBDSZ03  0.8000192  0.0046407   172.390  &lt; 2e-16 ***
ORIGIN_SZBDSZ04  1.4549610  0.0040480   359.428  &lt; 2e-16 ***
ORIGIN_SZBDSZ05  0.4494551  0.0046985    95.658  &lt; 2e-16 ***
ORIGIN_SZBDSZ06  0.7737918  0.0047455   163.057  &lt; 2e-16 ***
ORIGIN_SZBDSZ07 -1.1787122  0.0098150  -120.093  &lt; 2e-16 ***
ORIGIN_SZBDSZ08 -0.9813682  0.0091150  -107.665  &lt; 2e-16 ***
ORIGIN_SZBKSZ01 -0.2761892  0.0068055   -40.583  &lt; 2e-16 ***
ORIGIN_SZBKSZ02  0.4738148  0.0054643    86.712  &lt; 2e-16 ***
ORIGIN_SZBKSZ03  0.7255878  0.0053084   136.686  &lt; 2e-16 ***
ORIGIN_SZBKSZ04 -0.1267202  0.0061778   -20.512  &lt; 2e-16 ***
ORIGIN_SZBKSZ05 -0.0206871  0.0060233    -3.435 0.000594 ***
ORIGIN_SZBKSZ06  0.2199823  0.0061571    35.728  &lt; 2e-16 ***
ORIGIN_SZBKSZ07  0.7489618  0.0046639   160.588  &lt; 2e-16 ***
ORIGIN_SZBKSZ08  0.1674888  0.0055251    30.314  &lt; 2e-16 ***
ORIGIN_SZBKSZ09 -0.0855886  0.0059575   -14.367  &lt; 2e-16 ***
ORIGIN_SZBLSZ01 -2.1263634  0.0150444  -141.339  &lt; 2e-16 ***
ORIGIN_SZBLSZ02 -2.9919512  0.0195865  -152.756  &lt; 2e-16 ***
ORIGIN_SZBLSZ03 -5.0577490  0.0398706  -126.854  &lt; 2e-16 ***
ORIGIN_SZBLSZ04 -2.8068667  0.0239713  -117.093  &lt; 2e-16 ***
ORIGIN_SZBMSZ01 -0.0254725  0.0053689    -4.744 2.09e-06 ***
ORIGIN_SZBMSZ02 -0.8615244  0.0068584  -125.616  &lt; 2e-16 ***
ORIGIN_SZBMSZ03 -0.1728894  0.0059636   -28.991  &lt; 2e-16 ***
ORIGIN_SZBMSZ04  0.2159782  0.0053604    40.292  &lt; 2e-16 ***
ORIGIN_SZBMSZ05 -2.0248124  0.0126131  -160.533  &lt; 2e-16 ***
ORIGIN_SZBMSZ06 -1.7659748  0.0163959  -107.708  &lt; 2e-16 ***
ORIGIN_SZBMSZ07 -0.3243677  0.0058222   -55.713  &lt; 2e-16 ***
ORIGIN_SZBMSZ08 -0.2530534  0.0059352   -42.636  &lt; 2e-16 ***
ORIGIN_SZBMSZ09 -0.7697075  0.0087953   -87.513  &lt; 2e-16 ***
ORIGIN_SZBMSZ10 -1.0097880  0.0092535  -109.125  &lt; 2e-16 ***
ORIGIN_SZBMSZ11 -0.3806507  0.0067391   -56.484  &lt; 2e-16 ***
ORIGIN_SZBMSZ12 -0.6694871  0.0095721   -69.941  &lt; 2e-16 ***
ORIGIN_SZBMSZ13 -0.0101471  0.0059077    -1.718 0.085868 .  
ORIGIN_SZBMSZ14 -0.1664721  0.0069473   -23.962  &lt; 2e-16 ***
ORIGIN_SZBMSZ15  0.0901559  0.0062848    14.345  &lt; 2e-16 ***
ORIGIN_SZBMSZ16 -1.1763158  0.0092298  -127.447  &lt; 2e-16 ***
ORIGIN_SZBMSZ17 -1.7146793  0.0158424  -108.233  &lt; 2e-16 ***
ORIGIN_SZBPSZ01  0.4501196  0.0058050    77.539  &lt; 2e-16 ***
ORIGIN_SZBPSZ02  0.5215500  0.0068249    76.418  &lt; 2e-16 ***
ORIGIN_SZBPSZ03  0.6824757  0.0066233   103.042  &lt; 2e-16 ***
ORIGIN_SZBPSZ04  0.5291294  0.0053263    99.343  &lt; 2e-16 ***
ORIGIN_SZBPSZ05  0.5321073  0.0048397   109.945  &lt; 2e-16 ***
ORIGIN_SZBPSZ06 -1.2280468  0.0094982  -129.293  &lt; 2e-16 ***
ORIGIN_SZBPSZ07 -0.9022406  0.0088783  -101.623  &lt; 2e-16 ***
ORIGIN_SZBSSZ01  0.1211237  0.0054011    22.426  &lt; 2e-16 ***
ORIGIN_SZBSSZ02  0.4627529  0.0048656    95.108  &lt; 2e-16 ***
ORIGIN_SZBSSZ03  0.2149054  0.0047853    44.909  &lt; 2e-16 ***
ORIGIN_SZBTSZ01 -0.1078033  0.0055635   -19.377  &lt; 2e-16 ***
ORIGIN_SZBTSZ02 -0.8886056  0.0079246  -112.132  &lt; 2e-16 ***
ORIGIN_SZBTSZ03 -0.2171668  0.0059358   -36.586  &lt; 2e-16 ***
ORIGIN_SZBTSZ04 -0.6380972  0.0105509   -60.478  &lt; 2e-16 ***
ORIGIN_SZBTSZ05 -1.4667250  0.0111833  -131.153  &lt; 2e-16 ***
ORIGIN_SZBTSZ06 -0.6081745  0.0073483   -82.764  &lt; 2e-16 ***
ORIGIN_SZBTSZ07 -1.4898983  0.0108321  -137.544  &lt; 2e-16 ***
ORIGIN_SZBTSZ08 -1.0613236  0.0096004  -110.550  &lt; 2e-16 ***
ORIGIN_SZCCSZ01 -1.5303734  0.0134653  -113.653  &lt; 2e-16 ***
ORIGIN_SZCHSZ01 -1.2039205  0.0119502  -100.745  &lt; 2e-16 ***
ORIGIN_SZCHSZ02 -0.8329820  0.0082028  -101.549  &lt; 2e-16 ***
ORIGIN_SZCHSZ03 -0.5141842  0.0061868   -83.110  &lt; 2e-16 ***
ORIGIN_SZCKSZ01  0.2838684  0.0053889    52.676  &lt; 2e-16 ***
ORIGIN_SZCKSZ02  1.0135749  0.0054735   185.178  &lt; 2e-16 ***
ORIGIN_SZCKSZ03  0.6605218  0.0049537   133.339  &lt; 2e-16 ***
ORIGIN_SZCKSZ04  1.8337941  0.0050485   363.238  &lt; 2e-16 ***
ORIGIN_SZCKSZ05  1.4366501  0.0062443   230.075  &lt; 2e-16 ***
ORIGIN_SZCKSZ06  1.1116811  0.0066231   167.850  &lt; 2e-16 ***
ORIGIN_SZCLSZ01 -0.8537671  0.0079266  -107.709  &lt; 2e-16 ***
ORIGIN_SZCLSZ02 -1.3781271  0.0137466  -100.252  &lt; 2e-16 ***
ORIGIN_SZCLSZ03 -0.8497367  0.0081217  -104.625  &lt; 2e-16 ***
ORIGIN_SZCLSZ04  0.7939673  0.0046441   170.964  &lt; 2e-16 ***
ORIGIN_SZCLSZ05 -1.8810308  0.0156209  -120.418  &lt; 2e-16 ***
ORIGIN_SZCLSZ06  0.8397547  0.0043958   191.035  &lt; 2e-16 ***
ORIGIN_SZCLSZ07 -0.2246146  0.0057541   -39.035  &lt; 2e-16 ***
ORIGIN_SZCLSZ08  0.2689832  0.0062807    42.827  &lt; 2e-16 ***
ORIGIN_SZCLSZ09 -2.3024961  0.0166876  -137.977  &lt; 2e-16 ***
ORIGIN_SZDTSZ02 -4.0674351  0.0834193   -48.759  &lt; 2e-16 ***
ORIGIN_SZDTSZ03 -3.4522457  0.0738296   -46.760  &lt; 2e-16 ***
ORIGIN_SZGLSZ01 -1.4696686  0.0093157  -157.762  &lt; 2e-16 ***
ORIGIN_SZGLSZ02  0.2741891  0.0050071    54.760  &lt; 2e-16 ***
ORIGIN_SZGLSZ03  0.0758920  0.0049770    15.249  &lt; 2e-16 ***
ORIGIN_SZGLSZ04  0.8158791  0.0043281   188.506  &lt; 2e-16 ***
ORIGIN_SZGLSZ05  0.5285343  0.0044899   117.715  &lt; 2e-16 ***
ORIGIN_SZHGSZ01  0.2323559  0.0048572    47.837  &lt; 2e-16 ***
ORIGIN_SZHGSZ02  0.5716591  0.0048273   118.422  &lt; 2e-16 ***
ORIGIN_SZHGSZ03  0.4243062  0.0052165    81.339  &lt; 2e-16 ***
ORIGIN_SZHGSZ04  0.9349895  0.0044145   211.799  &lt; 2e-16 ***
ORIGIN_SZHGSZ05  1.2202652  0.0043808   278.547  &lt; 2e-16 ***
ORIGIN_SZHGSZ06  0.0496899  0.0054976     9.039  &lt; 2e-16 ***
ORIGIN_SZHGSZ07  0.6329714  0.0045754   138.342  &lt; 2e-16 ***
ORIGIN_SZHGSZ08  0.0306742  0.0054702     5.608 2.05e-08 ***
ORIGIN_SZHGSZ09 -0.6979586  0.0071798   -97.212  &lt; 2e-16 ***
ORIGIN_SZHGSZ10 -2.9931688  0.0422315   -70.875  &lt; 2e-16 ***
ORIGIN_SZJESZ01  0.4172498  0.0051788    80.569  &lt; 2e-16 ***
ORIGIN_SZJESZ02  0.3047260  0.0052291    58.275  &lt; 2e-16 ***
ORIGIN_SZJESZ03  0.2982254  0.0055141    54.084  &lt; 2e-16 ***
ORIGIN_SZJESZ05  0.1847967  0.0050874    36.325  &lt; 2e-16 ***
ORIGIN_SZJESZ06 -1.8185579  0.0119403  -152.304  &lt; 2e-16 ***
ORIGIN_SZJESZ07 -1.1601494  0.0121003   -95.877  &lt; 2e-16 ***
ORIGIN_SZJESZ08  0.4323918  0.0053682    80.547  &lt; 2e-16 ***
ORIGIN_SZJESZ09 -2.7001311  0.0186968  -144.416  &lt; 2e-16 ***
ORIGIN_SZJESZ10 -3.1218012  0.0203316  -153.544  &lt; 2e-16 ***
ORIGIN_SZJWSZ01  0.4566391  0.0068638    66.528  &lt; 2e-16 ***
ORIGIN_SZJWSZ02  0.9961038  0.0048126   206.978  &lt; 2e-16 ***
ORIGIN_SZJWSZ03  1.1828675  0.0045348   260.844  &lt; 2e-16 ***
ORIGIN_SZJWSZ04  0.9302202  0.0046898   198.349  &lt; 2e-16 ***
ORIGIN_SZJWSZ05 -1.7240666  0.0127581  -135.135  &lt; 2e-16 ***
ORIGIN_SZJWSZ06 -1.3138514  0.0109876  -119.576  &lt; 2e-16 ***
ORIGIN_SZJWSZ07 -2.3021923  0.0281440   -81.800  &lt; 2e-16 ***
ORIGIN_SZJWSZ08  2.0278336  0.0046395   437.076  &lt; 2e-16 ***
ORIGIN_SZJWSZ09  1.2729457  0.0043328   293.795  &lt; 2e-16 ***
ORIGIN_SZKLSZ01  0.2629143  0.0050107    52.471  &lt; 2e-16 ***
ORIGIN_SZKLSZ02 -0.4326316  0.0064296   -67.287  &lt; 2e-16 ***
ORIGIN_SZKLSZ03 -0.2774193  0.0060394   -45.935  &lt; 2e-16 ***
ORIGIN_SZKLSZ04 -1.9399521  0.0119219  -162.721  &lt; 2e-16 ***
ORIGIN_SZKLSZ05 -0.5457247  0.0085596   -63.756  &lt; 2e-16 ***
ORIGIN_SZKLSZ06 -4.2987108  0.1857686   -23.140  &lt; 2e-16 ***
ORIGIN_SZKLSZ07 -0.8592455  0.0085195  -100.856  &lt; 2e-16 ***
ORIGIN_SZKLSZ08 -1.3842047  0.0092337  -149.908  &lt; 2e-16 ***
ORIGIN_SZKLSZ09 -2.8325949  0.0313083   -90.474  &lt; 2e-16 ***
ORIGIN_SZLKSZ01 -2.6119775  0.0417633   -62.542  &lt; 2e-16 ***
ORIGIN_SZMDSZ01 -1.6790256  0.0296857   -56.560  &lt; 2e-16 ***
ORIGIN_SZMDSZ02 -0.8188019  0.0106679   -76.754  &lt; 2e-16 ***
ORIGIN_SZMDSZ03 -1.5066376  0.0172057   -87.566  &lt; 2e-16 ***
ORIGIN_SZMPSZ01 -0.9839202  0.0085086  -115.638  &lt; 2e-16 ***
ORIGIN_SZMPSZ02 -0.5959675  0.0070116   -84.998  &lt; 2e-16 ***
ORIGIN_SZMPSZ03 -0.0493260  0.0054606    -9.033  &lt; 2e-16 ***
ORIGIN_SZMUSZ02 -3.5212400  0.1037750   -33.931  &lt; 2e-16 ***
ORIGIN_SZNTSZ01 -2.6367957  0.0353128   -74.670  &lt; 2e-16 ***
ORIGIN_SZNTSZ02 -2.7669211  0.0232853  -118.827  &lt; 2e-16 ***
ORIGIN_SZNTSZ03 -0.6095155  0.0079108   -77.049  &lt; 2e-16 ***
ORIGIN_SZNTSZ05 -2.9160857  0.0496710   -58.708  &lt; 2e-16 ***
ORIGIN_SZNTSZ06 -3.3158278  0.0557977   -59.426  &lt; 2e-16 ***
ORIGIN_SZNVSZ01  0.6448576  0.0046055   140.019  &lt; 2e-16 ***
ORIGIN_SZNVSZ02 -0.4263007  0.0065909   -64.680  &lt; 2e-16 ***
ORIGIN_SZNVSZ03 -1.0760662  0.0078782  -136.588  &lt; 2e-16 ***
ORIGIN_SZNVSZ04 -1.2191855  0.0091479  -133.274  &lt; 2e-16 ***
ORIGIN_SZNVSZ05 -2.3477319  0.0158229  -148.376  &lt; 2e-16 ***
ORIGIN_SZPGSZ01  0.1521890  0.0154995     9.819  &lt; 2e-16 ***
ORIGIN_SZPGSZ02 -0.4051735  0.0073805   -54.898  &lt; 2e-16 ***
ORIGIN_SZPGSZ03  0.8974565  0.0046147   194.477  &lt; 2e-16 ***
ORIGIN_SZPGSZ04  1.1168395  0.0045874   243.457  &lt; 2e-16 ***
ORIGIN_SZPGSZ05  0.4811711  0.0060247    79.866  &lt; 2e-16 ***
ORIGIN_SZPLSZ01 -0.8346640  0.0107954   -77.317  &lt; 2e-16 ***
ORIGIN_SZPLSZ02 -1.2961415  0.0149883   -86.477  &lt; 2e-16 ***
ORIGIN_SZPLSZ03 -3.2841214  0.0374586   -87.673  &lt; 2e-16 ***
ORIGIN_SZPLSZ04 -3.5535584  0.0372639   -95.362  &lt; 2e-16 ***
ORIGIN_SZPLSZ05 -2.4368263  0.0227865  -106.942  &lt; 2e-16 ***
ORIGIN_SZPNSZ01  0.8737507  0.0057208   152.734  &lt; 2e-16 ***
ORIGIN_SZPNSZ02 -1.7927704  0.0129284  -138.669  &lt; 2e-16 ***
ORIGIN_SZPNSZ03 -2.6053457  0.0200175  -130.153  &lt; 2e-16 ***
ORIGIN_SZPNSZ04 -4.7852810  0.0320335  -149.384  &lt; 2e-16 ***
ORIGIN_SZPNSZ05 -3.5942397  0.0286332  -125.527  &lt; 2e-16 ***
ORIGIN_SZPRSZ01 -0.5658791  0.0117172   -48.295  &lt; 2e-16 ***
ORIGIN_SZPRSZ02  0.9149188  0.0048164   189.959  &lt; 2e-16 ***
ORIGIN_SZPRSZ03  0.4459459  0.0048129    92.656  &lt; 2e-16 ***
ORIGIN_SZPRSZ04 -0.5324343  0.0079070   -67.337  &lt; 2e-16 ***
ORIGIN_SZPRSZ05  1.1460635  0.0045276   253.127  &lt; 2e-16 ***
ORIGIN_SZPRSZ06 -0.7455804  0.0090390   -82.485  &lt; 2e-16 ***
ORIGIN_SZPRSZ07 -2.1664325  0.0162558  -133.271  &lt; 2e-16 ***
ORIGIN_SZPRSZ08 -0.1335351  0.0065739   -20.313  &lt; 2e-16 ***
ORIGIN_SZQTSZ01  0.1083852  0.0071560    15.146  &lt; 2e-16 ***
ORIGIN_SZQTSZ02 -0.5904523  0.0066637   -88.607  &lt; 2e-16 ***
ORIGIN_SZQTSZ03  0.1148816  0.0058850    19.521  &lt; 2e-16 ***
ORIGIN_SZQTSZ04 -0.8068751  0.0072950  -110.606  &lt; 2e-16 ***
ORIGIN_SZQTSZ05 -0.0416544  0.0061944    -6.725 1.76e-11 ***
ORIGIN_SZQTSZ06 -0.2513123  0.0066473   -37.807  &lt; 2e-16 ***
ORIGIN_SZQTSZ07 -1.2317647  0.0097782  -125.971  &lt; 2e-16 ***
ORIGIN_SZQTSZ08 -0.1128259  0.0059531   -18.953  &lt; 2e-16 ***
ORIGIN_SZQTSZ09 -0.5040685  0.0067915   -74.220  &lt; 2e-16 ***
ORIGIN_SZQTSZ10 -0.3847934  0.0067031   -57.406  &lt; 2e-16 ***
ORIGIN_SZQTSZ11 -1.5310869  0.0100340  -152.590  &lt; 2e-16 ***
ORIGIN_SZQTSZ12 -1.3973122  0.0107317  -130.204  &lt; 2e-16 ***
ORIGIN_SZQTSZ13 -0.3766193  0.0066803   -56.377  &lt; 2e-16 ***
ORIGIN_SZQTSZ14 -1.4930778  0.0100170  -149.055  &lt; 2e-16 ***
ORIGIN_SZQTSZ15 -1.0741455  0.0109880   -97.756  &lt; 2e-16 ***
ORIGIN_SZRCSZ01 -1.3137496  0.0126992  -103.452  &lt; 2e-16 ***
ORIGIN_SZRCSZ06 -0.2357988  0.0085520   -27.573  &lt; 2e-16 ***
ORIGIN_SZRVSZ01 -2.9255095  0.0324983   -90.020  &lt; 2e-16 ***
ORIGIN_SZRVSZ02 -2.2982248  0.0278205   -82.609  &lt; 2e-16 ***
ORIGIN_SZRVSZ03 -2.4668577  0.0238686  -103.351  &lt; 2e-16 ***
ORIGIN_SZRVSZ04 -3.1839853  0.0556942   -57.169  &lt; 2e-16 ***
ORIGIN_SZRVSZ05 -1.5691633  0.0166718   -94.121  &lt; 2e-16 ***
ORIGIN_SZSBSZ01  0.7675759  0.0061870   124.063  &lt; 2e-16 ***
ORIGIN_SZSBSZ02 -0.7301842  0.0084130   -86.792  &lt; 2e-16 ***
ORIGIN_SZSBSZ03  0.5905522  0.0050212   117.613  &lt; 2e-16 ***
ORIGIN_SZSBSZ04  0.3666025  0.0058632    62.526  &lt; 2e-16 ***
ORIGIN_SZSBSZ05 -0.0027927  0.0068497    -0.408 0.683488    
ORIGIN_SZSBSZ06 -1.1929280  0.0181677   -65.662  &lt; 2e-16 ***
ORIGIN_SZSBSZ07 -0.4881624  0.0135753   -35.960  &lt; 2e-16 ***
ORIGIN_SZSBSZ08 -2.1296756  0.0127299  -167.297  &lt; 2e-16 ***
ORIGIN_SZSBSZ09 -1.2071163  0.0089657  -134.638  &lt; 2e-16 ***
ORIGIN_SZSESZ02  1.0732486  0.0045356   236.630  &lt; 2e-16 ***
ORIGIN_SZSESZ03  1.0806868  0.0042943   251.655  &lt; 2e-16 ***
ORIGIN_SZSESZ04  1.0143659  0.0050693   200.102  &lt; 2e-16 ***
ORIGIN_SZSESZ05 -0.1677508  0.0060223   -27.855  &lt; 2e-16 ***
ORIGIN_SZSESZ06  0.9177050  0.0048344   189.829  &lt; 2e-16 ***
ORIGIN_SZSESZ07 -2.2480778  0.0196332  -114.504  &lt; 2e-16 ***
ORIGIN_SZSGSZ01 -0.9382577  0.0087311  -107.461  &lt; 2e-16 ***
ORIGIN_SZSGSZ02 -1.1711279  0.0097150  -120.548  &lt; 2e-16 ***
ORIGIN_SZSGSZ03  0.2601806  0.0052726    49.345  &lt; 2e-16 ***
ORIGIN_SZSGSZ04  0.3471408  0.0048914    70.970  &lt; 2e-16 ***
ORIGIN_SZSGSZ05 -1.5917536  0.0106314  -149.723  &lt; 2e-16 ***
ORIGIN_SZSGSZ06  0.3598356  0.0046378    77.587  &lt; 2e-16 ***
ORIGIN_SZSGSZ07 -0.5333213  0.0063133   -84.475  &lt; 2e-16 ***
ORIGIN_SZSKSZ01 -0.2731723  0.0083002   -32.912  &lt; 2e-16 ***
ORIGIN_SZSKSZ02  0.0900779  0.0063560    14.172  &lt; 2e-16 ***
ORIGIN_SZSKSZ03 -0.6885954  0.0082605   -83.360  &lt; 2e-16 ***
ORIGIN_SZSKSZ04 -2.3873135  0.0285077   -83.743  &lt; 2e-16 ***
ORIGIN_SZSKSZ05 -1.5486234  0.0179572   -86.240  &lt; 2e-16 ***
ORIGIN_SZSLSZ01 -2.9461043  0.0307309   -95.868  &lt; 2e-16 ***
ORIGIN_SZSLSZ04 -0.5718659  0.0077870   -73.438  &lt; 2e-16 ***
ORIGIN_SZSRSZ01 -1.6140902  0.0160228  -100.737  &lt; 2e-16 ***
ORIGIN_SZTMSZ01  0.1239212  0.0060961    20.328  &lt; 2e-16 ***
ORIGIN_SZTMSZ02  1.6644603  0.0039861   417.566  &lt; 2e-16 ***
ORIGIN_SZTMSZ03  1.0931061  0.0042936   254.588  &lt; 2e-16 ***
ORIGIN_SZTMSZ04  0.3164017  0.0050386    62.796  &lt; 2e-16 ***
ORIGIN_SZTMSZ05 -0.8202309  0.0079426  -103.270  &lt; 2e-16 ***
ORIGIN_SZTNSZ01 -1.4206354  0.0104655  -135.744  &lt; 2e-16 ***
ORIGIN_SZTNSZ02 -1.2698547  0.0098674  -128.692  &lt; 2e-16 ***
ORIGIN_SZTNSZ03 -1.7945209  0.0134691  -133.232  &lt; 2e-16 ***
ORIGIN_SZTNSZ04 -0.3488649  0.0073586   -47.409  &lt; 2e-16 ***
ORIGIN_SZTPSZ01 -0.3837703  0.0064157   -59.817  &lt; 2e-16 ***
ORIGIN_SZTPSZ02  0.5322150  0.0044515   119.558  &lt; 2e-16 ***
ORIGIN_SZTPSZ03 -0.4669869  0.0062181   -75.102  &lt; 2e-16 ***
ORIGIN_SZTPSZ04 -0.0618768  0.0058844   -10.515  &lt; 2e-16 ***
ORIGIN_SZTPSZ05  0.0710389  0.0062154    11.430  &lt; 2e-16 ***
ORIGIN_SZTPSZ06  0.6768679  0.0069498    97.394  &lt; 2e-16 ***
ORIGIN_SZTPSZ07 -0.0433789  0.0064403    -6.736 1.63e-11 ***
ORIGIN_SZTPSZ08 -0.6985163  0.0092440   -75.564  &lt; 2e-16 ***
ORIGIN_SZTPSZ09 -0.3734306  0.0063586   -58.728  &lt; 2e-16 ***
ORIGIN_SZTPSZ10 -0.4074383  0.0077824   -52.354  &lt; 2e-16 ***
ORIGIN_SZTPSZ11  0.1027811  0.0056140    18.308  &lt; 2e-16 ***
ORIGIN_SZTPSZ12 -0.5107246  0.0066279   -77.057  &lt; 2e-16 ***
ORIGIN_SZTSSZ01 -3.3769221  0.0491306   -68.734  &lt; 2e-16 ***
ORIGIN_SZTSSZ02  0.0505638  0.0098191     5.150 2.61e-07 ***
ORIGIN_SZTSSZ03 -0.3871866  0.0095826   -40.405  &lt; 2e-16 ***
ORIGIN_SZTSSZ04 -0.4378131  0.0100379   -43.616  &lt; 2e-16 ***
ORIGIN_SZTSSZ05 -2.8779256  0.0160283  -179.553  &lt; 2e-16 ***
ORIGIN_SZTSSZ06 -2.5839480  0.0253242  -102.035  &lt; 2e-16 ***
ORIGIN_SZWDSZ01  0.8699118  0.0043756   198.811  &lt; 2e-16 ***
ORIGIN_SZWDSZ02  0.9130427  0.0050360   181.304  &lt; 2e-16 ***
ORIGIN_SZWDSZ03  1.6191782  0.0045298   357.452  &lt; 2e-16 ***
ORIGIN_SZWDSZ04  1.2098683  0.0054321   222.726  &lt; 2e-16 ***
ORIGIN_SZWDSZ05  0.4311467  0.0052797    81.661  &lt; 2e-16 ***
ORIGIN_SZWDSZ06  0.8987620  0.0049874   180.206  &lt; 2e-16 ***
ORIGIN_SZWDSZ07 -0.6467532  0.0084781   -76.286  &lt; 2e-16 ***
ORIGIN_SZWDSZ08 -0.8783026  0.0082670  -106.243  &lt; 2e-16 ***
ORIGIN_SZWDSZ09  1.3292210  0.0048729   272.781  &lt; 2e-16 ***
ORIGIN_SZYSSZ01 -0.4795145  0.0058518   -81.944  &lt; 2e-16 ***
ORIGIN_SZYSSZ02  0.9318048  0.0054446   171.142  &lt; 2e-16 ***
ORIGIN_SZYSSZ03  2.0589587  0.0046764   440.284  &lt; 2e-16 ***
ORIGIN_SZYSSZ04  0.8710201  0.0047295   184.169  &lt; 2e-16 ***
ORIGIN_SZYSSZ05  0.1691225  0.0060394    28.003  &lt; 2e-16 ***
ORIGIN_SZYSSZ06 -0.8103984  0.0109104   -74.278  &lt; 2e-16 ***
ORIGIN_SZYSSZ07 -0.8959565  0.0119336   -75.079  &lt; 2e-16 ***
ORIGIN_SZYSSZ08 -0.2772121  0.0063585   -43.597  &lt; 2e-16 ***
ORIGIN_SZYSSZ09  1.2272070  0.0044981   272.829  &lt; 2e-16 ***
DESTIN_SZAMSZ02 -0.0528821  0.0042848   -12.342  &lt; 2e-16 ***
DESTIN_SZAMSZ03  0.0793639  0.0041920    18.932  &lt; 2e-16 ***
DESTIN_SZAMSZ04 -0.9288471  0.0061333  -151.443  &lt; 2e-16 ***
DESTIN_SZAMSZ05 -1.0807633  0.0062560  -172.756  &lt; 2e-16 ***
DESTIN_SZAMSZ06 -0.8871448  0.0060872  -145.739  &lt; 2e-16 ***
DESTIN_SZAMSZ07 -1.5838629  0.0096859  -163.522  &lt; 2e-16 ***
DESTIN_SZAMSZ08 -0.9751233  0.0068847  -141.636  &lt; 2e-16 ***
DESTIN_SZAMSZ09 -1.0374241  0.0061671  -168.218  &lt; 2e-16 ***
DESTIN_SZAMSZ10 -0.1232634  0.0044806   -27.511  &lt; 2e-16 ***
DESTIN_SZAMSZ11 -0.4809473  0.0088133   -54.571  &lt; 2e-16 ***
DESTIN_SZAMSZ12  0.2157037  0.0050664    42.575  &lt; 2e-16 ***
DESTIN_SZBDSZ01  0.3577958  0.0039604    90.342  &lt; 2e-16 ***
DESTIN_SZBDSZ02 -0.4365698  0.0051412   -84.916  &lt; 2e-16 ***
DESTIN_SZBDSZ03 -0.1562123  0.0044354   -35.219  &lt; 2e-16 ***
DESTIN_SZBDSZ04  0.6734444  0.0036242   185.820  &lt; 2e-16 ***
DESTIN_SZBDSZ05  0.3655436  0.0040519    90.215  &lt; 2e-16 ***
DESTIN_SZBDSZ06  0.0587526  0.0044385    13.237  &lt; 2e-16 ***
DESTIN_SZBDSZ07 -0.6642209  0.0095786   -69.344  &lt; 2e-16 ***
DESTIN_SZBDSZ08 -1.7194314  0.0106616  -161.273  &lt; 2e-16 ***
DESTIN_SZBKSZ01 -1.2823137  0.0067370  -190.340  &lt; 2e-16 ***
DESTIN_SZBKSZ02 -0.3849964  0.0055555   -69.300  &lt; 2e-16 ***
DESTIN_SZBKSZ03 -0.8637897  0.0059017  -146.364  &lt; 2e-16 ***
DESTIN_SZBKSZ04 -0.1290178  0.0051351   -25.125  &lt; 2e-16 ***
DESTIN_SZBKSZ05 -0.7364048  0.0059233  -124.324  &lt; 2e-16 ***
DESTIN_SZBKSZ06 -1.0010292  0.0063640  -157.296  &lt; 2e-16 ***
DESTIN_SZBKSZ07  0.0848101  0.0042992    19.727  &lt; 2e-16 ***
DESTIN_SZBKSZ08 -1.1122874  0.0070954  -156.762  &lt; 2e-16 ***
DESTIN_SZBKSZ09 -0.1758378  0.0051364   -34.233  &lt; 2e-16 ***
DESTIN_SZBLSZ01 -0.7663393  0.0072091  -106.301  &lt; 2e-16 ***
DESTIN_SZBLSZ02  0.4469128  0.0068127    65.600  &lt; 2e-16 ***
DESTIN_SZBLSZ03  1.6565076  0.0078654   210.608  &lt; 2e-16 ***
DESTIN_SZBLSZ04 -0.3227781  0.0137626   -23.453  &lt; 2e-16 ***
DESTIN_SZBMSZ01 -0.2083045  0.0048358   -43.075  &lt; 2e-16 ***
DESTIN_SZBMSZ02 -0.3277638  0.0049977   -65.583  &lt; 2e-16 ***
DESTIN_SZBMSZ03 -0.5138312  0.0058556   -87.750  &lt; 2e-16 ***
DESTIN_SZBMSZ04 -0.2211825  0.0051054   -43.323  &lt; 2e-16 ***
DESTIN_SZBMSZ05 -0.2102805  0.0067728   -31.048  &lt; 2e-16 ***
DESTIN_SZBMSZ06 -1.3825827  0.0124845  -110.744  &lt; 2e-16 ***
DESTIN_SZBMSZ07 -0.0117779  0.0046812    -2.516 0.011870 *  
DESTIN_SZBMSZ08 -0.9057219  0.0063885  -141.775  &lt; 2e-16 ***
DESTIN_SZBMSZ09 -2.3169339  0.0144540  -160.298  &lt; 2e-16 ***
DESTIN_SZBMSZ10 -1.3978304  0.0090477  -154.495  &lt; 2e-16 ***
DESTIN_SZBMSZ11 -1.3943466  0.0080479  -173.257  &lt; 2e-16 ***
DESTIN_SZBMSZ12 -0.6892586  0.0081575   -84.494  &lt; 2e-16 ***
DESTIN_SZBMSZ13 -0.2681927  0.0053006   -50.596  &lt; 2e-16 ***
DESTIN_SZBMSZ14 -0.7612269  0.0080270   -94.834  &lt; 2e-16 ***
DESTIN_SZBMSZ15 -0.9340708  0.0071123  -131.332  &lt; 2e-16 ***
DESTIN_SZBMSZ16 -2.0598119  0.0108507  -189.831  &lt; 2e-16 ***
DESTIN_SZBMSZ17 -2.5091125  0.0165380  -151.718  &lt; 2e-16 ***
DESTIN_SZBPSZ01 -0.8827572  0.0058530  -150.820  &lt; 2e-16 ***
DESTIN_SZBPSZ02 -1.5411421  0.0087563  -176.003  &lt; 2e-16 ***
DESTIN_SZBPSZ03 -1.2565472  0.0081001  -155.128  &lt; 2e-16 ***
DESTIN_SZBPSZ04 -0.7843346  0.0060959  -128.666  &lt; 2e-16 ***
DESTIN_SZBPSZ05  0.1512915  0.0042553    35.554  &lt; 2e-16 ***
DESTIN_SZBPSZ06 -0.6789990  0.0079773   -85.117  &lt; 2e-16 ***
DESTIN_SZBPSZ07 -0.5056200  0.0081202   -62.267  &lt; 2e-16 ***
DESTIN_SZBSSZ01 -0.1274523  0.0046968   -27.136  &lt; 2e-16 ***
DESTIN_SZBSSZ02 -0.7523273  0.0051912  -144.925  &lt; 2e-16 ***
DESTIN_SZBSSZ03  0.2774715  0.0039129    70.911  &lt; 2e-16 ***
DESTIN_SZBTSZ01  0.1708490  0.0043480    39.294  &lt; 2e-16 ***
DESTIN_SZBTSZ02 -0.6785590  0.0067486  -100.548  &lt; 2e-16 ***
DESTIN_SZBTSZ03  0.0576814  0.0049854    11.570  &lt; 2e-16 ***
DESTIN_SZBTSZ04 -1.3219421  0.0107136  -123.389  &lt; 2e-16 ***
DESTIN_SZBTSZ05 -0.4174864  0.0069606   -59.978  &lt; 2e-16 ***
DESTIN_SZBTSZ06 -0.5272616  0.0061169   -86.197  &lt; 2e-16 ***
DESTIN_SZBTSZ07 -1.6006743  0.0099385  -161.057  &lt; 2e-16 ***
DESTIN_SZBTSZ08 -0.8053037  0.0089197   -90.284  &lt; 2e-16 ***
DESTIN_SZCCSZ01 -0.9246058  0.0081445  -113.525  &lt; 2e-16 ***
DESTIN_SZCHSZ01 -1.2777041  0.0096802  -131.992  &lt; 2e-16 ***
DESTIN_SZCHSZ02  0.0105074  0.0054352     1.933 0.053208 .  
DESTIN_SZCHSZ03  1.1022701  0.0041409   266.190  &lt; 2e-16 ***
DESTIN_SZCKSZ01 -0.3607465  0.0051067   -70.641  &lt; 2e-16 ***
DESTIN_SZCKSZ02 -0.8461482  0.0055930  -151.287  &lt; 2e-16 ***
DESTIN_SZCKSZ03  0.2325574  0.0042928    54.174  &lt; 2e-16 ***
DESTIN_SZCKSZ04 -1.5022789  0.0065964  -227.743  &lt; 2e-16 ***
DESTIN_SZCKSZ05 -1.2606947  0.0077048  -163.624  &lt; 2e-16 ***
DESTIN_SZCKSZ06  0.0765191  0.0061808    12.380  &lt; 2e-16 ***
DESTIN_SZCLSZ01  0.1826532  0.0050012    36.522  &lt; 2e-16 ***
DESTIN_SZCLSZ02 -2.0861752  0.0134894  -154.653  &lt; 2e-16 ***
DESTIN_SZCLSZ03 -0.8932420  0.0079142  -112.866  &lt; 2e-16 ***
DESTIN_SZCLSZ04 -0.2655376  0.0047608   -55.776  &lt; 2e-16 ***
DESTIN_SZCLSZ05 -0.9950959  0.0085622  -116.220  &lt; 2e-16 ***
DESTIN_SZCLSZ06  0.0656155  0.0042205    15.547  &lt; 2e-16 ***
DESTIN_SZCLSZ07 -0.4907686  0.0054227   -90.503  &lt; 2e-16 ***
DESTIN_SZCLSZ08 -0.3865747  0.0061470   -62.889  &lt; 2e-16 ***
DESTIN_SZCLSZ09  0.4256956  0.0067051    63.488  &lt; 2e-16 ***
DESTIN_SZDTSZ02 -2.6464959  0.0348727   -75.890  &lt; 2e-16 ***
DESTIN_SZDTSZ03 -1.5139864  0.0144478  -104.790  &lt; 2e-16 ***
DESTIN_SZGLSZ01 -0.0119465  0.0052478    -2.276 0.022818 *  
DESTIN_SZGLSZ02 -0.2846539  0.0047516   -59.907  &lt; 2e-16 ***
DESTIN_SZGLSZ03  0.3547159  0.0039490    89.823  &lt; 2e-16 ***
DESTIN_SZGLSZ04  0.2927196  0.0039458    74.185  &lt; 2e-16 ***
DESTIN_SZGLSZ05  0.1868090  0.0040031    46.666  &lt; 2e-16 ***
DESTIN_SZHGSZ01  0.1420578  0.0039890    35.612  &lt; 2e-16 ***
DESTIN_SZHGSZ02 -0.7244780  0.0052393  -138.277  &lt; 2e-16 ***
DESTIN_SZHGSZ03 -1.1926172  0.0062147  -191.903  &lt; 2e-16 ***
DESTIN_SZHGSZ04 -0.4396143  0.0044857   -98.003  &lt; 2e-16 ***
DESTIN_SZHGSZ05 -0.5698266  0.0046449  -122.677  &lt; 2e-16 ***
DESTIN_SZHGSZ06 -0.8269648  0.0054949  -150.495  &lt; 2e-16 ***
DESTIN_SZHGSZ07  0.0716018  0.0041608    17.209  &lt; 2e-16 ***
DESTIN_SZHGSZ08 -0.4296529  0.0050037   -85.868  &lt; 2e-16 ***
DESTIN_SZHGSZ09 -0.2075701  0.0052562   -39.490  &lt; 2e-16 ***
DESTIN_SZHGSZ10 -2.9167710  0.0262709  -111.027  &lt; 2e-16 ***
DESTIN_SZJESZ01 -0.2940281  0.0051512   -57.080  &lt; 2e-16 ***
DESTIN_SZJESZ02 -0.6771250  0.0053784  -125.897  &lt; 2e-16 ***
DESTIN_SZJESZ03 -0.7433609  0.0059024  -125.941  &lt; 2e-16 ***
DESTIN_SZJESZ05  0.1665584  0.0042970    38.762  &lt; 2e-16 ***
DESTIN_SZJESZ06 -1.2553540  0.0084363  -148.804  &lt; 2e-16 ***
DESTIN_SZJESZ07 -0.8432165  0.0080550  -104.683  &lt; 2e-16 ***
DESTIN_SZJESZ08 -0.4103337  0.0057196   -71.741  &lt; 2e-16 ***
DESTIN_SZJESZ09  0.6659263  0.0073935    90.069  &lt; 2e-16 ***
DESTIN_SZJESZ10  0.9913424  0.0070579   140.459  &lt; 2e-16 ***
DESTIN_SZJWSZ01 -0.9456240  0.0069942  -135.200  &lt; 2e-16 ***
DESTIN_SZJWSZ02 -0.7545179  0.0055146  -136.821  &lt; 2e-16 ***
DESTIN_SZJWSZ03  0.2290724  0.0043493    52.668  &lt; 2e-16 ***
DESTIN_SZJWSZ04  0.6807777  0.0041356   164.614  &lt; 2e-16 ***
DESTIN_SZJWSZ05 -0.4554805  0.0063159   -72.116  &lt; 2e-16 ***
DESTIN_SZJWSZ06 -0.2606152  0.0057697   -45.170  &lt; 2e-16 ***
DESTIN_SZJWSZ07 -1.9182195  0.0288449   -66.501  &lt; 2e-16 ***
DESTIN_SZJWSZ08 -0.6251637  0.0051508  -121.371  &lt; 2e-16 ***
DESTIN_SZJWSZ09  0.9092588  0.0037935   239.689  &lt; 2e-16 ***
DESTIN_SZKLSZ01 -0.5812998  0.0052729  -110.242  &lt; 2e-16 ***
DESTIN_SZKLSZ02 -0.7079661  0.0058176  -121.694  &lt; 2e-16 ***
DESTIN_SZKLSZ03 -1.2181962  0.0065996  -184.585  &lt; 2e-16 ***
DESTIN_SZKLSZ04 -1.6935244  0.0087873  -192.724  &lt; 2e-16 ***
DESTIN_SZKLSZ05 -0.6848266  0.0073653   -92.980  &lt; 2e-16 ***
DESTIN_SZKLSZ06 -2.2958926  0.0362606   -63.316  &lt; 2e-16 ***
DESTIN_SZKLSZ07 -0.9525903  0.0066790  -142.624  &lt; 2e-16 ***
DESTIN_SZKLSZ08 -0.4545161  0.0051747   -87.835  &lt; 2e-16 ***
DESTIN_SZKLSZ09 -2.2042604  0.0161728  -136.295  &lt; 2e-16 ***
DESTIN_SZLKSZ01 -1.9976089  0.0231807   -86.175  &lt; 2e-16 ***
DESTIN_SZMDSZ01 -1.7108459  0.0210309   -81.349  &lt; 2e-16 ***
DESTIN_SZMDSZ02 -1.3692320  0.0114225  -119.871  &lt; 2e-16 ***
DESTIN_SZMDSZ03 -2.7193376  0.0252710  -107.607  &lt; 2e-16 ***
DESTIN_SZMPSZ01 -0.8035620  0.0078591  -102.246  &lt; 2e-16 ***
DESTIN_SZMPSZ02 -0.7608823  0.0061403  -123.917  &lt; 2e-16 ***
DESTIN_SZMPSZ03 -0.0636068  0.0047809   -13.304  &lt; 2e-16 ***
DESTIN_SZMUSZ02 -1.9516133  0.0200165   -97.500  &lt; 2e-16 ***
DESTIN_SZNTSZ01 -3.3062955  0.0448055   -73.792  &lt; 2e-16 ***
DESTIN_SZNTSZ02 -1.6433056  0.0109346  -150.285  &lt; 2e-16 ***
DESTIN_SZNTSZ03 -1.1384753  0.0077421  -147.051  &lt; 2e-16 ***
DESTIN_SZNTSZ05 -2.0239135  0.0250238   -80.879  &lt; 2e-16 ***
DESTIN_SZNTSZ06 -3.3469527  0.0428996   -78.018  &lt; 2e-16 ***
DESTIN_SZNVSZ01 -0.3417972  0.0045513   -75.100  &lt; 2e-16 ***
DESTIN_SZNVSZ02 -0.4970905  0.0053959   -92.124  &lt; 2e-16 ***
DESTIN_SZNVSZ03 -0.4913022  0.0055171   -89.051  &lt; 2e-16 ***
DESTIN_SZNVSZ04 -1.9126556  0.0107757  -177.497  &lt; 2e-16 ***
DESTIN_SZNVSZ05 -1.5343622  0.0089693  -171.069  &lt; 2e-16 ***
DESTIN_SZPGSZ01 -1.7816379  0.0194565   -91.571  &lt; 2e-16 ***
DESTIN_SZPGSZ02 -0.9285806  0.0069031  -134.516  &lt; 2e-16 ***
DESTIN_SZPGSZ03  0.0867038  0.0042171    20.560  &lt; 2e-16 ***
DESTIN_SZPGSZ04 -0.3905945  0.0046891   -83.298  &lt; 2e-16 ***
DESTIN_SZPGSZ05 -0.9693952  0.0074671  -129.821  &lt; 2e-16 ***
DESTIN_SZPLSZ01 -0.6142679  0.0070882   -86.660  &lt; 2e-16 ***
DESTIN_SZPLSZ02 -1.7537338  0.0133117  -131.743  &lt; 2e-16 ***
DESTIN_SZPLSZ03 -0.1339343  0.0098718   -13.567  &lt; 2e-16 ***
DESTIN_SZPLSZ04 -0.1300144  0.0096427   -13.483  &lt; 2e-16 ***
DESTIN_SZPLSZ05 -0.8459266  0.0119080   -71.038  &lt; 2e-16 ***
DESTIN_SZPNSZ01 -0.2150030  0.0058003   -37.067  &lt; 2e-16 ***
DESTIN_SZPNSZ02  1.0184197  0.0077892   130.747  &lt; 2e-16 ***
DESTIN_SZPNSZ03  0.0165385  0.0081747     2.023 0.043060 *  
DESTIN_SZPNSZ04  1.8301032  0.0088120   207.683  &lt; 2e-16 ***
DESTIN_SZPNSZ05  0.9672854  0.0131454    73.583  &lt; 2e-16 ***
DESTIN_SZPRSZ01 -1.4027802  0.0086947  -161.338  &lt; 2e-16 ***
DESTIN_SZPRSZ02 -0.4964525  0.0052437   -94.675  &lt; 2e-16 ***
DESTIN_SZPRSZ03  0.4225059  0.0040305   104.828  &lt; 2e-16 ***
DESTIN_SZPRSZ04 -0.4852985  0.0083552   -58.083  &lt; 2e-16 ***
DESTIN_SZPRSZ05 -0.3009483  0.0047546   -63.297  &lt; 2e-16 ***
DESTIN_SZPRSZ06  0.0042718  0.0054557     0.783 0.433631    
DESTIN_SZPRSZ07 -1.1382651  0.0118867   -95.759  &lt; 2e-16 ***
DESTIN_SZPRSZ08 -0.8250111  0.0066786  -123.531  &lt; 2e-16 ***
DESTIN_SZQTSZ01 -1.2208796  0.0089253  -136.789  &lt; 2e-16 ***
DESTIN_SZQTSZ02 -1.2907100  0.0076825  -168.007  &lt; 2e-16 ***
DESTIN_SZQTSZ03 -0.7460808  0.0066541  -112.124  &lt; 2e-16 ***
DESTIN_SZQTSZ04 -0.6266190  0.0066841   -93.748  &lt; 2e-16 ***
DESTIN_SZQTSZ05 -0.6112222  0.0060485  -101.054  &lt; 2e-16 ***
DESTIN_SZQTSZ06 -0.9150752  0.0065120  -140.522  &lt; 2e-16 ***
DESTIN_SZQTSZ07 -1.4602389  0.0110006  -132.742  &lt; 2e-16 ***
DESTIN_SZQTSZ08  0.0025596  0.0050217     0.510 0.610261    
DESTIN_SZQTSZ09 -0.5295772  0.0058924   -89.874  &lt; 2e-16 ***
DESTIN_SZQTSZ10 -0.3846301  0.0055907   -68.798  &lt; 2e-16 ***
DESTIN_SZQTSZ11  0.0254408  0.0055085     4.618 3.87e-06 ***
DESTIN_SZQTSZ12 -0.3339155  0.0072806   -45.864  &lt; 2e-16 ***
DESTIN_SZQTSZ13 -0.0427531  0.0053733    -7.957 1.77e-15 ***
DESTIN_SZQTSZ14 -0.2464326  0.0063884   -38.575  &lt; 2e-16 ***
DESTIN_SZQTSZ15 -0.1759645  0.0077595   -22.677  &lt; 2e-16 ***
DESTIN_SZRCSZ01 -0.4629071  0.0072523   -63.829  &lt; 2e-16 ***
DESTIN_SZRCSZ06 -2.0895157  0.0189109  -110.493  &lt; 2e-16 ***
DESTIN_SZRVSZ01 -1.7920888  0.0163501  -109.607  &lt; 2e-16 ***
DESTIN_SZRVSZ02 -3.1630811  0.0326322   -96.931  &lt; 2e-16 ***
DESTIN_SZRVSZ03 -2.0290505  0.0135758  -149.461  &lt; 2e-16 ***
DESTIN_SZRVSZ04 -1.5081652  0.0155642   -96.900  &lt; 2e-16 ***
DESTIN_SZRVSZ05 -2.3685160  0.0259385   -91.313  &lt; 2e-16 ***
DESTIN_SZSBSZ01 -0.5888699  0.0068663   -85.763  &lt; 2e-16 ***
DESTIN_SZSBSZ02 -1.0776774  0.0078313  -137.612  &lt; 2e-16 ***
DESTIN_SZSBSZ03  0.4713695  0.0045925   102.639  &lt; 2e-16 ***
DESTIN_SZSBSZ04  0.0524108  0.0057578     9.103  &lt; 2e-16 ***
DESTIN_SZSBSZ05 -0.9603240  0.0075285  -127.558  &lt; 2e-16 ***
DESTIN_SZSBSZ06 -1.8555956  0.0234217   -79.226  &lt; 2e-16 ***
DESTIN_SZSBSZ07 -1.8441975  0.0196079   -94.054  &lt; 2e-16 ***
DESTIN_SZSBSZ08  0.9229582  0.0055729   165.616  &lt; 2e-16 ***
DESTIN_SZSBSZ09  0.5177040  0.0051971    99.614  &lt; 2e-16 ***
DESTIN_SZSESZ02 -0.5752271  0.0048295  -119.106  &lt; 2e-16 ***
DESTIN_SZSESZ03  0.2539038  0.0038355    66.198  &lt; 2e-16 ***
DESTIN_SZSESZ04 -0.9015792  0.0056730  -158.925  &lt; 2e-16 ***
DESTIN_SZSESZ05 -0.4661640  0.0048593   -95.932  &lt; 2e-16 ***
DESTIN_SZSESZ06 -0.8428573  0.0059227  -142.310  &lt; 2e-16 ***
DESTIN_SZSESZ07 -3.2171210  0.0227093  -141.666  &lt; 2e-16 ***
DESTIN_SZSGSZ01 -0.2743200  0.0059602   -46.025  &lt; 2e-16 ***
DESTIN_SZSGSZ02 -0.2944017  0.0052527   -56.048  &lt; 2e-16 ***
DESTIN_SZSGSZ03 -0.4469952  0.0048197   -92.743  &lt; 2e-16 ***
DESTIN_SZSGSZ04 -0.2852039  0.0047978   -59.444  &lt; 2e-16 ***
DESTIN_SZSGSZ05 -2.0628346  0.0098257  -209.942  &lt; 2e-16 ***
DESTIN_SZSGSZ06  0.2519107  0.0038889    64.777  &lt; 2e-16 ***
DESTIN_SZSGSZ07 -0.5730279  0.0052196  -109.784  &lt; 2e-16 ***
DESTIN_SZSISZ01 -1.1013977  0.0259118   -42.506  &lt; 2e-16 ***
DESTIN_SZSKSZ01 -0.5357627  0.0071643   -74.782  &lt; 2e-16 ***
DESTIN_SZSKSZ02  0.3082925  0.0056874    54.206  &lt; 2e-16 ***
DESTIN_SZSKSZ03 -0.4548663  0.0062436   -72.853  &lt; 2e-16 ***
DESTIN_SZSKSZ04 -0.6592695  0.0148535   -44.385  &lt; 2e-16 ***
DESTIN_SZSKSZ05 -0.1435321  0.0122342   -11.732  &lt; 2e-16 ***
DESTIN_SZSLSZ01 -0.8841264  0.0084599  -104.508  &lt; 2e-16 ***
DESTIN_SZSLSZ04 -1.1777458  0.0071372  -165.014  &lt; 2e-16 ***
DESTIN_SZSRSZ01 -1.6424671  0.0128847  -127.475  &lt; 2e-16 ***
DESTIN_SZTMSZ01 -0.3256898  0.0058105   -56.052  &lt; 2e-16 ***
DESTIN_SZTMSZ02  1.1542864  0.0034729   332.374  &lt; 2e-16 ***
DESTIN_SZTMSZ03  0.4515253  0.0039272   114.973  &lt; 2e-16 ***
DESTIN_SZTMSZ04  0.8237768  0.0040089   205.488  &lt; 2e-16 ***
DESTIN_SZTMSZ05  0.3945339  0.0054359    72.580  &lt; 2e-16 ***
DESTIN_SZTNSZ01 -0.9491109  0.0067868  -139.847  &lt; 2e-16 ***
DESTIN_SZTNSZ02 -1.5904128  0.0097408  -163.273  &lt; 2e-16 ***
DESTIN_SZTNSZ03 -1.6443092  0.0116613  -141.006  &lt; 2e-16 ***
DESTIN_SZTNSZ04 -1.0649240  0.0069877  -152.399  &lt; 2e-16 ***
DESTIN_SZTPSZ01 -0.5177358  0.0056904   -90.985  &lt; 2e-16 ***
DESTIN_SZTPSZ02  0.2191562  0.0038300    57.221  &lt; 2e-16 ***
DESTIN_SZTPSZ03 -0.2491157  0.0056669   -43.960  &lt; 2e-16 ***
DESTIN_SZTPSZ04 -1.4990877  0.0072458  -206.892  &lt; 2e-16 ***
DESTIN_SZTPSZ05 -0.9530068  0.0058002  -164.306  &lt; 2e-16 ***
DESTIN_SZTPSZ06 -0.4887558  0.0074669   -65.456  &lt; 2e-16 ***
DESTIN_SZTPSZ07 -1.9724982  0.0118448  -166.529  &lt; 2e-16 ***
DESTIN_SZTPSZ08 -1.3431220  0.0086933  -154.501  &lt; 2e-16 ***
DESTIN_SZTPSZ09 -0.3490548  0.0061370   -56.877  &lt; 2e-16 ***
DESTIN_SZTPSZ10 -1.3208517  0.0085973  -153.636  &lt; 2e-16 ***
DESTIN_SZTPSZ11 -0.3873761  0.0052467   -73.832  &lt; 2e-16 ***
DESTIN_SZTPSZ12 -0.7056368  0.0062488  -112.923  &lt; 2e-16 ***
DESTIN_SZTSSZ01 -0.9638767  0.0219669   -43.879  &lt; 2e-16 ***
DESTIN_SZTSSZ02 -0.6901972  0.0118074   -58.455  &lt; 2e-16 ***
DESTIN_SZTSSZ03  0.4084395  0.0087714    46.565  &lt; 2e-16 ***
DESTIN_SZTSSZ04  0.1014502  0.0097771    10.376  &lt; 2e-16 ***
DESTIN_SZTSSZ05  1.6410733  0.0088309   185.834  &lt; 2e-16 ***
DESTIN_SZTSSZ06  0.8538192  0.0207512    41.146  &lt; 2e-16 ***
DESTIN_SZWDSZ01  0.8194046  0.0037338   219.454  &lt; 2e-16 ***
DESTIN_SZWDSZ02 -0.7887372  0.0058696  -134.376  &lt; 2e-16 ***
DESTIN_SZWDSZ03  0.5699823  0.0041938   135.911  &lt; 2e-16 ***
DESTIN_SZWDSZ04 -0.8453975  0.0065140  -129.781  &lt; 2e-16 ***
DESTIN_SZWDSZ05 -0.3539899  0.0057303   -61.775  &lt; 2e-16 ***
DESTIN_SZWDSZ06  0.1376776  0.0044027    31.271  &lt; 2e-16 ***
DESTIN_SZWDSZ07 -0.2219013  0.0066416   -33.411  &lt; 2e-16 ***
DESTIN_SZWDSZ08 -0.0268026  0.0065105    -4.117 3.84e-05 ***
DESTIN_SZWDSZ09 -0.2102375  0.0050646   -41.511  &lt; 2e-16 ***
DESTIN_SZYSSZ01  0.7462605  0.0041004   181.996  &lt; 2e-16 ***
DESTIN_SZYSSZ02 -0.3039302  0.0053484   -56.826  &lt; 2e-16 ***
DESTIN_SZYSSZ03 -1.1164663  0.0057256  -194.995  &lt; 2e-16 ***
DESTIN_SZYSSZ04 -0.3783796  0.0051512   -73.454  &lt; 2e-16 ***
DESTIN_SZYSSZ05 -1.7934064  0.0102089  -175.671  &lt; 2e-16 ***
DESTIN_SZYSSZ06 -1.8508129  0.0099619  -185.789  &lt; 2e-16 ***
DESTIN_SZYSSZ07 -0.9261476  0.0118216   -78.343  &lt; 2e-16 ***
DESTIN_SZYSSZ08  0.4416628  0.0041290   106.967  &lt; 2e-16 ***
DESTIN_SZYSSZ09  0.0248623  0.0041426     6.002 1.95e-09 ***
log(dist)       -0.6747463  0.0001358 -4970.372  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 59965744  on 14439  degrees of freedom
Residual deviance: 20664335  on 13901  degrees of freedom
AIC: 20755335

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>We can examine how the constraints hold for destinations this time.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CalcRSquared</span>(dbcSIM<span class="sc">$</span>data<span class="sc">$</span>TRIPS, dbcSIM<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5831464</code></pre>
</div>
</div>
<p>Notice that there is a relatively greater improvement in the R^2 value.</p>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison"><strong>6.9 Model comparison</strong></h2>
<p>Another useful model performance measure for continuous dependent variable is <a href="https://towardsdatascience.com/what-does-rmse-really-mean-806b65f2e48e">Root Mean Squared Error</a>. In this sub-section, you will learn how to use <a href="https://easystats.github.io/performance/reference/compare_performance.html"><code>compare_performance()</code></a> of <a href="https://easystats.github.io/performance/"><strong>performance</strong></a> package</p>
<p>First of all, let us create a list called <em>model_list</em> by using the code chun below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>model_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">unconstrained=</span>uncSIM,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">originConstrained=</span>orcSIM,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">destinationConstrained=</span>decSIM,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">doublyConstrained=</span>dbcSIM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will compute the RMSE of all the models in <em>model_list</em> file by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(model_list,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metrics =</span> <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                   | Model |     RMSE
-----------------------------------------
unconstrained          |   glm | 4316.028
originConstrained      |   glm | 3679.154
destinationConstrained |   glm | 3393.268
doublyConstrained      |   glm | 3230.276</code></pre>
</div>
</div>
<p>The print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.</p>
</section>
<section id="visualising-fitted-values" class="level2">
<h2 class="anchored" data-anchor-id="visualising-fitted-values"><strong>6.10 Visualising fitted values</strong></h2>
<p>In this section, you will learn how to visualise the observed values and the fitted values.</p>
<p>Firstly we will extract the fitted values from each model by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(uncSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we will join the values to <em>SIM_data</em> data frame.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uncTRIPS =</span> <span class="st">"uncSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Origin Constrained SIM (i.e.&nbsp;orcSIM)</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(orcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">orcTRIPS =</span> <span class="st">"orcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Destination Constrained SIM (i.e.&nbsp;decSIM)</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(decSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decTRIPS =</span> <span class="st">"decSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Repeat the same step by for Doubly Constrained SIM (i.e.&nbsp;dbcSIM)</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dbcSIM<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>SIM_data <span class="ot">&lt;-</span> SIM_data <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dbcTRIPS =</span> <span class="st">"dbcSIM$fitted.values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>unc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> uncTRIPS,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>orc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> orcTRIPS,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>dec_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> decTRIPS,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>dbc_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> SIM_data,</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> dbcTRIPS,</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> TRIPS)) <span class="sc">+</span></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, we will put all the graphs into a single visual for better comparison by using the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(unc_p, orc_p, dec_p, dbc_p,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Hands-on_Ex11_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>