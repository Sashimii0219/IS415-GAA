{
  "hash": "aaf617d66d0cff661c6c87ae73fa67e1",
  "result": {
    "markdown": "---\ntitle: \"Hands-on Exercise 11\"\nformat: \n  html:\n    code-fold: true\n    code-summary: \"Show code\"\nexecute: \n  eval: true\n  echo: true\n  freeze: auto\n  warning: false\ndate: \"2024-03-31\"\n---\n\n\n# 1. Learning Objective\n\nSpatial Interaction Models (SIMs) are mathematical models for estimating flows between spatial entities developed by Alan Wilson in the late 1960s and early 1970, with considerable uptake and refinement for transport modelling since then Boyce and Williams (2015).\n\nThere are four main types of traditional SIMs (Wilson 1971):\n\n-   Unconstrained\n\n-   Production-constrained\n\n-   Attraction-constrained\n\n-   Doubly-constrained\n\nOrdinary least square (OLS), log-normal, Poisson and negative binomial (NB) regression methods have been used extensively to calibrate OD flow models by processing flow data as different types of dependent variables. In this chapter, you will gain hands-on experiences on using appropriate R packages to calibrate SIM by using there four regression methods.\n\n# 2. Getting Started\n\n## 2.1 Context\n\nIn this exercise, we are going to calibrate SIM to determine factors affecting the public bus passenger flows during the morning peak in Singapore.\n\n## **2.2 Loading R Packages**\n\nFor the purpose of this exercise, four r packages will be used. They are:\n\n-   sf for importing, integrating, processing and transforming geospatial data.\n\n-   tidyverse for importing, integrating, wrangling and visualising data.\n\n-   tmap for creating thematic maps.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tmap, sf, sp,\n               performance, reshape2,\n               ggpubr, tidyverse)\n```\n:::\n\n\n## 2.3 Data Importing and Preparation\n\n### 2.3.1 Dataset\n\nThis exercise is a continuation of **Chapter 15: Processing and Visualising Flow Data** and the following data will be used:\n\n-   *od_data.rds*, weekday morning peak passenger flows at planning subzone level.\n\n-   *mpsz.rds*, URA Master Plan 2019 Planning Subzone boundary in simple feature tibble data frame format.\n\nBeside these two data sets, an additional attribute data file called pop.csv will be provided.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- read_rds(\"data/rds/mpsz.rds\")\nmpsz\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n   OBJECTID SUBZONE_NO           SUBZONE_N SUBZONE_C CA_IND    PLN_AREA_N\n1         1          2       PEOPLE'S PARK    OTSZ02      Y        OUTRAM\n2         2          2         BUKIT MERAH    BMSZ02      N   BUKIT MERAH\n3         3          3           CHINATOWN    OTSZ03      Y        OUTRAM\n4         4          4             PHILLIP    DTSZ04      Y DOWNTOWN CORE\n5         5          5       RAFFLES PLACE    DTSZ05      Y DOWNTOWN CORE\n6         6          4        CHINA SQUARE    OTSZ04      Y        OUTRAM\n7         7         10         TIONG BAHRU    BMSZ10      N   BUKIT MERAH\n8         8         12    BAYFRONT SUBZONE    DTSZ12      Y DOWNTOWN CORE\n9         9          4 TIONG BAHRU STATION    BMSZ04      N   BUKIT MERAH\n10       10          6       CLIFFORD PIER    DTSZ06      Y DOWNTOWN CORE\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          OT CENTRAL REGION       CR B4120D23006C932A 2016-05-11 28831.78\n2          BM CENTRAL REGION       CR 1C51019439A68700 2016-05-11 26360.80\n3          OT CENTRAL REGION       CR 0FF1661344C84AED 2016-05-11 29153.97\n4          DT CENTRAL REGION       CR 615D4EDDEF809F8E 2016-05-11 29706.72\n5          DT CENTRAL REGION       CR 72107B11807074F4 2016-05-11 29968.62\n6          OT CENTRAL REGION       CR B609DF5587626C8F 2016-05-11 29509.64\n7          BM CENTRAL REGION       CR A0FB4B68155D164A 2016-05-11 27785.67\n8          DT CENTRAL REGION       CR 197F5E664DA4D5E1 2016-05-11 30806.24\n9          BM CENTRAL REGION       CR 91FFE927ABE3E4DB 2016-05-11 27277.47\n10         DT CENTRAL REGION       CR 945CC212CA80626F 2016-05-11 30379.50\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1  29419.65  1822.1927   93140.44 MULTIPOLYGON (((29099.02 29...\n2  29384.14  3074.9632  411722.82 MULTIPOLYGON (((26750.09 29...\n3  29158.04  4297.5999  587222.68 MULTIPOLYGON (((29161.2 297...\n4  29744.91   871.5549   39437.94 MULTIPOLYGON (((29814.11 29...\n5  29572.76  1872.7522  188767.49 MULTIPOLYGON (((30137.77 29...\n6  29646.45  1605.2797  133006.94 MULTIPOLYGON (((29699.44 29...\n7  29590.40  3303.2149  448127.58 MULTIPOLYGON (((27748.04 29...\n8  29530.17  2897.1264  521200.52 MULTIPOLYGON (((30844.87 29...\n9  29607.02  2506.6879  350787.56 MULTIPOLYGON (((27444.04 29...\n10 29776.43  2405.9909  261843.90 MULTIPOLYGON (((30436.73 29...\n```\n:::\n:::\n\n\n### **2.3.2 Importing the OD data** \n\n\n::: {.cell}\n\n```{.r .cell-code}\nodbus <- read_csv(\"data/aspatial/origin_destination_bus_202210.csv\")\n```\n:::\n\n\nA quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type. Hence, the code chunk below is used to convert these data values into character data type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nodbus$ORIGIN_PT_CODE <- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE <- as.factor(odbus$DESTINATION_PT_CODE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nodbus6_9 <- odbus %>%\n  filter(DAY_TYPE == \"WEEKDAY\") %>%\n  filter(TIME_PER_HOUR >= 6 &\n           TIME_PER_HOUR <= 9) %>%\n  group_by(ORIGIN_PT_CODE,\n           DESTINATION_PT_CODE) %>%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbusstop <- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %>%\n  st_transform(crs = 3414)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `BusStop' from data source \n  `/Users/jacksontan/Documents/Sashimii0219/IS415-GAA/Hands-on_Ex/Hands-on_Ex11/data/geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5159 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n```\n:::\n:::\n\n\n### **2.3.3 Combining Busstop and mpsz**\n\nCode chunk below populates the planning subzone code (i.e. SUBZONE_C) of mpsz sf data frame into busstop sf data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbusstop_mpsz <- st_intersection(busstop, mpsz) %>%\n  select(BUS_STOP_N, SUBZONE_C) %>%\n  st_drop_geometry()\n```\n:::\n\n\nNext, we are going to append the planning subzone code from busstop_mpsz data frame onto odbus6_9 data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data <- left_join(odbus6_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %>%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C,\n         DESTIN_BS = DESTINATION_PT_CODE)\n```\n:::\n\n\nBefore continue, it is a good practice for us to check for duplicating records.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nduplicate <- od_data %>%\n  group_by_all() %>%\n  filter(n()>1) %>%\n  ungroup()\n```\n:::\n\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data <- unique(od_data)\n```\n:::\n\n\nIt will be a good practice to confirm if the duplicating records issue has been addressed fully.\n\nNext, we will update od_data data frame cwith the planning subzone codes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data <- left_join(od_data , busstop_mpsz,\n            by = c(\"DESTIN_BS\" = \"BUS_STOP_N\")) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nduplicate <- od_data %>%\n  group_by_all() %>%\n  filter(n()>1) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data <- unique(od_data)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data <- od_data %>%\n  rename(DESTIN_SZ = SUBZONE_C) %>%\n  drop_na() %>%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %>%\n  summarise(MORNING_PEAK = sum(TRIPS))\n```\n:::\n\n\nIt is time to save the output into an rds file format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|eval: false\nwrite_rds(od_data, \"data/rds/od_data_fii.rds\")\n```\n:::\n\n\n# **3. Computing Distance Matrix**\n\nIn spatial interaction, a distance matrix is a table that shows the distance between pairs of locations. For example, in the table below we can see an Euclidean distance of 3926.0025 between MESZ01 and RVSZ05, of 3939.1079 between MESZ01 and SRSZ01, and so on. By definition, an location's distance from itself, which is shown in the main diagonal of the table, is 0.\n\n![](https://r4gdsa.netlify.app/chap16/img/image16-1.jpg)\n\n## 3.1 **Converting from sf data.table to SpatialPolygonsDataFrame**\n\nThere are at least two ways to compute the required distance matrix. One is based on sf and the other is based on sp. Past experience shown that computing distance matrix by using sf function took relatively longer time that sp method especially the data set is large. In view of this, sp method is used in the code chunks below.\n\nFirst [`as.Spatial()`](https://r-spatial.github.io/sf/reference/coerce-methods.html) will be used to convert *mpsz* from sf tibble data frame to SpatialPolygonsDataFrame of sp object as shown in the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_sp <- as(mpsz, \"Spatial\")\nmpsz_sp\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nclass       : SpatialPolygonsDataFrame \nfeatures    : 323 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 15\nnames       : OBJECTID, SUBZONE_NO, SUBZONE_N, SUBZONE_C, CA_IND, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C,          INC_CRC, FMEL_UPD_D,     X_ADDR,     Y_ADDR,    SHAPE_Leng,    SHAPE_Area \nmin values  :        1,          1, ADMIRALTY,    AMSZ01,      N, ANG MO KIO,         AM, CENTRAL REGION,       CR, 00F5E30B5C9B7AD8,      16932,  5092.8949,  19579.069, 871.554887798, 39437.9352703 \nmax values  :      323,         17,    YUNNAN,    YSSZ09,      Y,     YISHUN,         YS,    WEST REGION,       WR, FFCCF172717C2EAF,      16932, 50424.7923, 49552.7904, 68083.9364708,  69748298.792 \n```\n:::\n:::\n\n\n## 3.2 **Computing the distance matrix**\n\nNext, [`spDists()`](https://www.rdocumentation.org/packages/sp/versions/2.1-1/topics/spDistsN1) of sp package will be used to compute the Euclidean distance between the centroids of the planning subzones.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndist <- spDists(mpsz_sp, \n                longlat = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(dist, n=c(10, 10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]\n [1,]    0.0000 2471.2367  415.0177  933.4461 1147.1018  714.7994 1059.9522\n [2,] 2471.2367    0.0000 2802.3046 3365.3182 3612.7457 3159.7511 1439.7232\n [3,]  415.0177 2802.3046    0.0000  806.1939  914.1363  604.1895 1434.9774\n [4,]  933.4461 3365.3182  806.1939    0.0000  313.4045  220.3061 1927.2560\n [5,] 1147.1018 3612.7457  914.1363  313.4045    0.0000  464.8515 2183.0167\n [6,]  714.7994 3159.7511  604.1895  220.3061  464.8515    0.0000 1724.8827\n [7,] 1059.9522 1439.7232 1434.9774 1927.2560 2183.0167 1724.8827    0.0000\n [8,] 1977.5520 4447.8405 1693.6604 1120.2913  838.7066 1301.8020 3021.1702\n [9,] 1565.5647  943.3775 1929.4628 2433.1644 2691.3659 2232.5220  508.4742\n[10,] 1588.3152 4037.8066 1372.7144  673.5181  458.5956  879.5186 2600.4952\n           [,8]      [,9]     [,10]\n [1,] 1977.5520 1565.5647 1588.3152\n [2,] 4447.8405  943.3775 4037.8066\n [3,] 1693.6604 1929.4628 1372.7144\n [4,] 1120.2913 2433.1644  673.5181\n [5,]  838.7066 2691.3659  458.5956\n [6,] 1301.8020 2232.5220  879.5186\n [7,] 3021.1702  508.4742 2600.4952\n [8,]    0.0000 3529.6089  492.6989\n [9,] 3529.6089    0.0000 3106.6568\n[10,]  492.6989 3106.6568    0.0000\n```\n:::\n:::\n\n\n## **3.3 Labelling column and row heanders of a distance matrix**\n\nFirst, we will create a list sorted according to the the distance matrix by planning sub-zone code.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsz_names <- mpsz$SUBZONE_C\n```\n:::\n\n\nNext we will attach `SUBZONE_C` to row and column for distance matrix matching ahead\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(dist) <- paste0(sz_names)\nrownames(dist) <- paste0(sz_names)\n```\n:::\n\n\n## **3.4 Pivoting distance value by SUBZONE_C**\n\nNext, we will pivot the distance matrix into a long table by using the row and column subzone codes as show in the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair <- melt(dist) %>%\n  rename(dist = value)\nhead(distPair, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Var1   Var2      dist\n1  OTSZ02 OTSZ02    0.0000\n2  BMSZ02 OTSZ02 2471.2367\n3  OTSZ03 OTSZ02  415.0177\n4  DTSZ04 OTSZ02  933.4461\n5  DTSZ05 OTSZ02 1147.1018\n6  OTSZ04 OTSZ02  714.7994\n7  BMSZ10 OTSZ02 1059.9522\n8  DTSZ12 OTSZ02 1977.5520\n9  BMSZ04 OTSZ02 1565.5647\n10 DTSZ06 OTSZ02 1588.3152\n```\n:::\n:::\n\n\nNotice that the within zone distance is 0.\n\n## **3.5 Updating intra-zonal distances**\n\nIn this section, we are going to append a constant value to replace the intra-zonal distance of 0.\n\nFirst, we will select and find out the minimum value of the distance by using `summary()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair %>%\n  filter(dist > 0) %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Var1             Var2             dist        \n OTSZ02 :   322   OTSZ02 :   322   Min.   :  182.5  \n BMSZ02 :   322   BMSZ02 :   322   1st Qu.: 7092.5  \n OTSZ03 :   322   OTSZ03 :   322   Median :11765.1  \n DTSZ04 :   322   DTSZ04 :   322   Mean   :12159.0  \n DTSZ05 :   322   DTSZ05 :   322   3rd Qu.:16309.3  \n OTSZ04 :   322   OTSZ04 :   322   Max.   :49896.9  \n (Other):102074   (Other):102074                    \n```\n:::\n:::\n\n\nNext, a constant distance value of 50m is added into intra-zones distance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair$dist <- ifelse(distPair$dist == 0,\n                        50, distPair$dist)\n```\n:::\n\n\nThe code chunk below will be used to check the result data.frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair %>%\n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Var1             Var2             dist      \n OTSZ02 :   323   OTSZ02 :   323   Min.   :   50  \n BMSZ02 :   323   BMSZ02 :   323   1st Qu.: 7033  \n OTSZ03 :   323   OTSZ03 :   323   Median :11739  \n DTSZ04 :   323   DTSZ04 :   323   Mean   :12121  \n DTSZ05 :   323   DTSZ05 :   323   3rd Qu.:16295  \n OTSZ04 :   323   OTSZ04 :   323   Max.   :49897  \n (Other):102391   (Other):102391                  \n```\n:::\n:::\n\n\nThe code chunk below is used to rename the origin and destination fields.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair <- distPair %>%\n  rename(orig = Var1,\n         dest = Var2)\n```\n:::\n\n\nLastly, the code chunk below is used to save the dataframe for future use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|eval: false\nwrite_rds(distPair, \"data/rds/distPair.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndistPair <- read_rds(\"data/rds/distPair.rds\")\n```\n:::\n\n\n# **4. Preparing flow data**\n\nThe code chunk below is used import *od_data* save in Chapter 15 into R environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nod_data_fii <- read_rds(\"data/rds/od_data_fii.rds\")\n```\n:::\n\n\nNext, we will compute the total passenger trip between and within planning subzones by using the code chunk below. The output is all *flow_data*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data <- od_data_fii %>%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %>% \n  summarize(TRIPS = sum(MORNING_PEAK)) \n```\n:::\n\n\nUse the code chunk below to display flow_data dataframe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(flow_data, 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 3\n# Groups:   ORIGIN_SZ [1]\n   ORIGIN_SZ DESTIN_SZ TRIPS\n   <chr>     <chr>     <dbl>\n 1 AMSZ01    AMSZ01     1998\n 2 AMSZ01    AMSZ02     8289\n 3 AMSZ01    AMSZ03     8971\n 4 AMSZ01    AMSZ04     2252\n 5 AMSZ01    AMSZ05     6136\n 6 AMSZ01    AMSZ06     2148\n 7 AMSZ01    AMSZ07     1620\n 8 AMSZ01    AMSZ08     1925\n 9 AMSZ01    AMSZ09     1773\n10 AMSZ01    AMSZ10       63\n```\n:::\n:::\n\n\n## **4.1 Separating intra-flow from passenger volume df**\n\nCode chunk below is used to add three new fields in `flow_data` dataframe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data$FlowNoIntra <- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0, flow_data$TRIPS)\nflow_data$offset <- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0.000001, 1)\n```\n:::\n\n\n## **4.2 Combining passenger volume data with distance value**\n\nBefore we can join *flow_data* and *distPair*, we need to convert data value type of *ORIGIN_SZ* and *DESTIN_SZ* fields of flow_data dataframe into factor data type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data$ORIGIN_SZ <- as.factor(flow_data$ORIGIN_SZ)\nflow_data$DESTIN_SZ <- as.factor(flow_data$DESTIN_SZ)\n```\n:::\n\n\nNow, `left_join()` of **dplyr** will be used to *flow_data* dataframe and *distPair* dataframe. The output is called *flow_data1*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data1 <- flow_data %>%\n  left_join (distPair,\n             by = c(\"ORIGIN_SZ\" = \"orig\",\n                    \"DESTIN_SZ\" = \"dest\"))\n```\n:::\n\n\n# **5. Preparing Origin and Destination Attributes**\n\n## **5.1 Importing population data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- read_csv(\"data/aspatial/pop.csv\")\n```\n:::\n\n\n### **5.2 Geospatial data wrangling**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(pop %>%\n  left_join(mpsz,\n            by = c(\"PA\" = \"PLN_AREA_N\",\n                   \"SZ\" = \"SUBZONE_N\")) %>%\n  select(1:6,8))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 332\nColumns: 7\n$ PA        <chr> \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG MO KIO\", \"ANG…\n$ SZ        <chr> \"ANG MO KIO TOWN CENTRE\", \"CHENG SAN\", \"CHONG BOON\", \"KEBUN …\n$ AGE7_12   <dbl> 310, 1140, 1010, 1050, 420, 810, 390, 980, 0, 260, 0, 1190, …\n$ AGE13_24  <dbl> 710, 2770, 2650, 2390, 1120, 1920, 1150, 2000, 0, 650, 0, 32…\n$ AGE25_64  <dbl> 2780, 15700, 14240, 12460, 3620, 9650, 4350, 11320, 0, 2500,…\n$ OBJECTID  <int> 213, 212, 204, 214, 225, 205, 251, 202, 249, 248, 294, 234, …\n$ SUBZONE_C <chr> \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ06\", \"AMSZ07\", \"AMSZ05\", …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- pop %>%\n  left_join(mpsz,\n            by = c(\"PA\" = \"PLN_AREA_N\",\n                   \"SZ\" = \"SUBZONE_N\")) %>%\n  select(1:6,8) %>%\n  rename(SZ_NAME = SZ,\n         SZ = SUBZONE_C)\n```\n:::\n\n\n## **5.3 Preparing origin attribute**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data1 <- flow_data1 %>%\n  left_join(pop,\n            by = c(ORIGIN_SZ = \"SZ\")) %>%\n  rename(ORIGIN_AGE7_12 = AGE7_12,\n         ORIGIN_AGE13_24 = AGE13_24,\n         ORIGIN_AGE25_64 = AGE25_64) %>%\n  select(-c(PA, SZ_NAME))\n```\n:::\n\n\n## **5.4 Preparing destination attribute**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nflow_data1 <- flow_data1 %>%\n  left_join(pop,\n            by = c(DESTIN_SZ = \"SZ\")) %>%\n  rename(DESTIN_AGE7_12 = AGE7_12,\n         DESTIN_AGE13_24 = AGE13_24,\n         DESTIN_AGE25_64 = AGE25_64) %>%\n  select(-c(PA, SZ_NAME))\n```\n:::\n\n\nWe will called the output data file *SIM_data*. it is in rds data file format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#|eval: false\nwrite_rds(flow_data1, \"data/rds/SIM_data.rds\")\n```\n:::\n\n\n# **6. Calibrating Spatial Interaction Models**\n\nIn this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.\n\n## **6.1 Importing the modelling data**\n\nFirstly, let us import the modelling data by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- read_rds(\"data/rds/SIM_data.rds\")\n```\n:::\n\n\n## **6.2 Visualising the dependent variable**\n\nFirstly, let us plot the distribution of the dependent variable (i.e. TRIPS) by using histogram method by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = TRIPS)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex11_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\nNotice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.\n\nNext, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = dist,\n           y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex11_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nNotice that their relationship hardly resemble linear relationship.\n\nOn the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = SIM_data,\n       aes(x = log(dist),\n           y = log(TRIPS))) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex11_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n## **6.3 Checking for variables with zero values**\n\nSince Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.\n\nIn the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in *SIM_data* data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SIM_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra      \n Length:14621       Length:14621       Min.   :     1   Min.   :     0.0  \n Class :character   Class :character   1st Qu.:    14   1st Qu.:    13.0  \n Mode  :character   Mode  :character   Median :    77   Median :    70.0  \n                                       Mean   :  1029   Mean   :   846.2  \n                                       3rd Qu.:   431   3rd Qu.:   384.0  \n                                       Max.   :232187   Max.   :148274.0  \n                                                                          \n     offset              dist       ORIGIN_AGE7_12 ORIGIN_AGE13_24\n Min.   :0.000001   Min.   :   50   Min.   :   0   Min.   :    0  \n 1st Qu.:1.000000   1st Qu.: 3361   1st Qu.: 260   1st Qu.:  550  \n Median :1.000000   Median : 6084   Median : 710   Median : 1420  \n Mean   :0.982217   Mean   : 6894   Mean   :1044   Mean   : 2295  \n 3rd Qu.:1.000000   3rd Qu.: 9737   3rd Qu.:1500   3rd Qu.: 3290  \n Max.   :1.000000   Max.   :26122   Max.   :6340   Max.   :16380  \n                                    NA's   :109    NA's   :109    \n ORIGIN_AGE25_64   OBJECTID.x    DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64\n Min.   :    0   Min.   :  2.0   Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.: 2320   1st Qu.:100.0   1st Qu.: 260   1st Qu.:  550   1st Qu.: 2280  \n Median : 7030   Median :165.0   Median : 720   Median : 1430   Median : 7120  \n Mean   :10614   Mean   :160.6   Mean   :1042   Mean   : 2310   Mean   :10668  \n 3rd Qu.:15830   3rd Qu.:222.0   3rd Qu.:1500   3rd Qu.: 3290   3rd Qu.:15830  \n Max.   :74610   Max.   :323.0   Max.   :6340   Max.   :16380   Max.   :74610  \n NA's   :109     NA's   :109     NA's   :77     NA's   :77      NA's   :77     \n   OBJECTID.y   \n Min.   :  2.0  \n 1st Qu.:104.0  \n Median :165.0  \n Mean   :161.4  \n 3rd Qu.:224.0  \n Max.   :323.0  \n NA's   :77     \n```\n:::\n:::\n\n\nThe print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.\n\nIn view of this, code chunk below will be used to replace zero values to 0.99.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data$DESTIN_AGE7_12 <- ifelse(\n  SIM_data$DESTIN_AGE7_12 == 0,\n  0.99, SIM_data$DESTIN_AGE7_12)\nSIM_data$DESTIN_AGE13_24 <- ifelse(\n  SIM_data$DESTIN_AGE13_24 == 0,\n  0.99, SIM_data$DESTIN_AGE13_24)\nSIM_data$DESTIN_AGE25_64 <- ifelse(\n  SIM_data$DESTIN_AGE25_64 == 0,\n  0.99, SIM_data$DESTIN_AGE25_64)\nSIM_data$ORIGIN_AGE7_12 <- ifelse(\n  SIM_data$ORIGIN_AGE7_12 == 0,\n  0.99, SIM_data$ORIGIN_AGE7_12)\nSIM_data$ORIGIN_AGE13_24 <- ifelse(\n  SIM_data$ORIGIN_AGE13_24 == 0,\n  0.99, SIM_data$ORIGIN_AGE13_24)\nSIM_data$ORIGIN_AGE25_64 <- ifelse(\n  SIM_data$ORIGIN_AGE25_64 == 0,\n  0.99, SIM_data$ORIGIN_AGE25_64)\n\nSIM_data <- SIM_data %>% drop_na()  \n```\n:::\n\n\nWe can run the summary() again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SIM_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  ORIGIN_SZ          DESTIN_SZ             TRIPS         FlowNoIntra    \n Length:14440       Length:14440       Min.   :     1   Min.   :     0  \n Class :character   Class :character   1st Qu.:    14   1st Qu.:    13  \n Mode  :character   Mode  :character   Median :    77   Median :    70  \n                                       Mean   :  1030   Mean   :   845  \n                                       3rd Qu.:   431   3rd Qu.:   384  \n                                       Max.   :232187   Max.   :148274  \n     offset              dist       ORIGIN_AGE7_12    ORIGIN_AGE13_24   \n Min.   :0.000001   Min.   :   50   Min.   :   0.99   Min.   :    0.99  \n 1st Qu.:1.000000   1st Qu.: 3374   1st Qu.: 260.00   1st Qu.:  550.00  \n Median :1.000000   Median : 6094   Median : 710.00   Median : 1420.00  \n Mean   :0.982202   Mean   : 6897   Mean   :1043.75   Mean   : 2293.60  \n 3rd Qu.:1.000000   3rd Qu.: 9743   3rd Qu.:1500.00   3rd Qu.: 3290.00  \n Max.   :1.000000   Max.   :26122   Max.   :6340.00   Max.   :16380.00  \n ORIGIN_AGE25_64      OBJECTID.x    DESTIN_AGE7_12    DESTIN_AGE13_24   \n Min.   :    0.99   Min.   :  2.0   Min.   :   0.99   Min.   :    0.99  \n 1st Qu.: 2320.00   1st Qu.:100.0   1st Qu.: 260.00   1st Qu.:  550.00  \n Median : 7030.00   Median :165.0   Median : 720.00   Median : 1430.00  \n Mean   :10610.77   Mean   :160.7   Mean   :1042.18   Mean   : 2308.45  \n 3rd Qu.:15830.00   3rd Qu.:222.0   3rd Qu.:1500.00   3rd Qu.: 3290.00  \n Max.   :74610.00   Max.   :323.0   Max.   :6340.00   Max.   :16380.00  \n DESTIN_AGE25_64      OBJECTID.y   \n Min.   :    0.99   Min.   :  2.0  \n 1st Qu.: 2280.00   1st Qu.:104.0  \n Median : 7120.00   Median :165.0  \n Mean   :10667.00   Mean   :161.2  \n 3rd Qu.:15830.00   3rd Qu.:223.0  \n Max.   :74610.00   Max.   :323.0  \n```\n:::\n:::\n\n\nNotice that all the 0 values have been replaced by 0.99.\n\n## **6.4 Unconstrained Spatial Interaction Model**\n\nIn this section, we will learn how to calibrate an unconstrained spatial interaction model by using `glm()` of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e. *ORIGIN_AGE25_64*) and distance between origin and destination in km (i.e. *dist*).\n\nThe general formula of Unconstrained Spatial Interaction Model\n\n![](https://r4gdsa.netlify.app/chap15/img/image1.jpg)\n\nThe code chunk used to calibrate to model is shown below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuncSIM <- glm(formula = TRIPS ~ \n                log(ORIGIN_AGE25_64) + \n                log(DESTIN_AGE25_64) +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.omit)\nuncSIM\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + \n    log(dist), family = poisson(link = \"log\"), data = SIM_data, \n    na.action = na.omit)\n\nCoefficients:\n         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  \n           10.485540              0.241483              0.006128  \n           log(dist)  \n           -0.708973  \n\nDegrees of Freedom: 14439 Total (i.e. Null);  14436 Residual\nNull Deviance:\t    59970000 \nResidual Deviance: 35860000 \tAIC: 35950000\n```\n:::\n:::\n\n\n## **6.5 R-squared function**\n\nIn order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared <- function(observed,estimated){\n  r <- cor(observed,estimated)\n  R2 <- r^2\n  R2\n}\n```\n:::\n\n\nNext, we will compute the R-squared of the unconstrained SIM by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(uncSIM$data$TRIPS, uncSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1884445\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nr2_mcfadden(uncSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# R2 for Generalized Linear Regression\n       R2: 0.401\n  adj. R2: 0.401\n```\n:::\n:::\n\n\n## **6.6 Origin (Production) constrained SIM**\n\nIn this section, we will fit an origin constrained SIM by using the code3 chunk below.\n\nThe general formula of Origin Constrained Spatial Interaction Model\n\n![](https://r4gdsa.netlify.app/chap15/img/image2.jpg)\n\n\n::: {.cell}\n\n```{.r .cell-code}\norcSIM <- glm(formula = TRIPS ~ \n                 ORIGIN_SZ +\n                 log(DESTIN_AGE25_64) +\n                 log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(orcSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)           1.217e+01  3.788e-03  3214.227  < 2e-16 ***\nORIGIN_SZAMSZ02       1.010e+00  4.450e-03   227.002  < 2e-16 ***\nORIGIN_SZAMSZ03       5.497e-01  4.563e-03   120.473  < 2e-16 ***\nORIGIN_SZAMSZ04      -7.837e-02  5.187e-03   -15.108  < 2e-16 ***\nORIGIN_SZAMSZ05      -1.927e-01  5.790e-03   -33.283  < 2e-16 ***\nORIGIN_SZAMSZ06       4.192e-01  5.130e-03    81.705  < 2e-16 ***\nORIGIN_SZAMSZ07      -1.374e+00  9.683e-03  -141.918  < 2e-16 ***\nORIGIN_SZAMSZ08      -1.025e+00  8.956e-03  -114.430  < 2e-16 ***\nORIGIN_SZAMSZ09       2.238e-01  5.408e-03    41.385  < 2e-16 ***\nORIGIN_SZAMSZ10       4.965e-01  4.717e-03   105.266  < 2e-16 ***\nORIGIN_SZAMSZ11      -1.871e+00  1.285e-02  -145.585  < 2e-16 ***\nORIGIN_SZAMSZ12      -1.580e+00  1.076e-02  -146.895  < 2e-16 ***\nORIGIN_SZBDSZ01       1.080e+00  4.345e-03   248.486  < 2e-16 ***\nORIGIN_SZBDSZ02       5.220e-01  5.079e-03   102.778  < 2e-16 ***\nORIGIN_SZBDSZ03       9.923e-01  4.490e-03   221.025  < 2e-16 ***\nORIGIN_SZBDSZ04       1.775e+00  3.895e-03   455.784  < 2e-16 ***\nORIGIN_SZBDSZ05       6.428e-01  4.546e-03   141.403  < 2e-16 ***\nORIGIN_SZBDSZ06       9.406e-01  4.543e-03   207.038  < 2e-16 ***\nORIGIN_SZBDSZ07      -1.281e+00  9.558e-03  -133.973  < 2e-16 ***\nORIGIN_SZBDSZ08      -1.165e+00  9.032e-03  -128.981  < 2e-16 ***\nORIGIN_SZBKSZ01      -4.615e-01  6.634e-03   -69.559  < 2e-16 ***\nORIGIN_SZBKSZ02       3.935e-01  5.154e-03    76.335  < 2e-16 ***\nORIGIN_SZBKSZ03       5.458e-01  5.039e-03   108.325  < 2e-16 ***\nORIGIN_SZBKSZ04      -1.165e-01  5.914e-03   -19.708  < 2e-16 ***\nORIGIN_SZBKSZ05      -2.147e-01  5.832e-03   -36.813  < 2e-16 ***\nORIGIN_SZBKSZ06       3.150e-02  5.902e-03     5.336 9.49e-08 ***\nORIGIN_SZBKSZ07       7.590e-01  4.427e-03   171.456  < 2e-16 ***\nORIGIN_SZBKSZ08      -2.132e-02  5.348e-03    -3.987 6.69e-05 ***\nORIGIN_SZBKSZ09      -9.643e-02  5.721e-03   -16.857  < 2e-16 ***\nORIGIN_SZBLSZ01      -1.725e+00  1.482e-02  -116.412  < 2e-16 ***\nORIGIN_SZBLSZ02      -2.193e+00  1.924e-02  -113.963  < 2e-16 ***\nORIGIN_SZBLSZ03      -3.298e+00  3.930e-02   -83.922  < 2e-16 ***\nORIGIN_SZBLSZ04      -2.253e+00  2.306e-02   -97.705  < 2e-16 ***\nORIGIN_SZBMSZ01      -1.265e-01  5.224e-03   -24.210  < 2e-16 ***\nORIGIN_SZBMSZ02      -1.072e+00  6.747e-03  -158.945  < 2e-16 ***\nORIGIN_SZBMSZ03      -4.407e-01  5.794e-03   -76.064  < 2e-16 ***\nORIGIN_SZBMSZ04      -6.575e-02  5.157e-03   -12.750  < 2e-16 ***\nORIGIN_SZBMSZ05      -2.264e+00  1.247e-02  -181.592  < 2e-16 ***\nORIGIN_SZBMSZ06      -2.381e+00  1.618e-02  -147.201  < 2e-16 ***\nORIGIN_SZBMSZ07      -4.734e-01  5.659e-03   -83.665  < 2e-16 ***\nORIGIN_SZBMSZ08      -5.667e-01  5.811e-03   -97.514  < 2e-16 ***\nORIGIN_SZBMSZ09      -1.231e+00  8.688e-03  -141.739  < 2e-16 ***\nORIGIN_SZBMSZ10      -1.474e+00  9.130e-03  -161.473  < 2e-16 ***\nORIGIN_SZBMSZ11      -7.887e-01  6.602e-03  -119.465  < 2e-16 ***\nORIGIN_SZBMSZ12      -1.076e+00  9.149e-03  -117.586  < 2e-16 ***\nORIGIN_SZBMSZ13      -1.227e-01  5.691e-03   -21.554  < 2e-16 ***\nORIGIN_SZBMSZ14      -5.360e-01  6.633e-03   -80.808  < 2e-16 ***\nORIGIN_SZBMSZ15      -3.271e-01  6.054e-03   -54.029  < 2e-16 ***\nORIGIN_SZBMSZ16      -1.548e+00  9.147e-03  -169.231  < 2e-16 ***\nORIGIN_SZBMSZ17      -2.187e+00  1.576e-02  -138.756  < 2e-16 ***\nORIGIN_SZBPSZ01       1.402e-01  5.553e-03    25.244  < 2e-16 ***\nORIGIN_SZBPSZ02      -2.943e-02  6.462e-03    -4.554 5.26e-06 ***\nORIGIN_SZBPSZ03       1.525e-01  6.150e-03    24.792  < 2e-16 ***\nORIGIN_SZBPSZ04       3.564e-01  5.084e-03    70.101  < 2e-16 ***\nORIGIN_SZBPSZ05       5.165e-01  4.601e-03   112.266  < 2e-16 ***\nORIGIN_SZBPSZ06      -1.405e+00  9.311e-03  -150.880  < 2e-16 ***\nORIGIN_SZBPSZ07      -1.006e+00  8.575e-03  -117.332  < 2e-16 ***\nORIGIN_SZBSSZ01      -1.478e-02  5.276e-03    -2.801  0.00509 ** \nORIGIN_SZBSSZ02       3.117e-01  4.788e-03    65.112  < 2e-16 ***\nORIGIN_SZBSSZ03       2.581e-01  4.689e-03    55.036  < 2e-16 ***\nORIGIN_SZBTSZ01      -6.322e-02  5.385e-03   -11.739  < 2e-16 ***\nORIGIN_SZBTSZ02      -1.077e+00  7.797e-03  -138.090  < 2e-16 ***\nORIGIN_SZBTSZ03      -2.281e-01  5.727e-03   -39.825  < 2e-16 ***\nORIGIN_SZBTSZ04      -1.056e+00  1.019e-02  -103.678  < 2e-16 ***\nORIGIN_SZBTSZ05      -1.645e+00  1.100e-02  -149.529  < 2e-16 ***\nORIGIN_SZBTSZ06      -7.804e-01  7.181e-03  -108.685  < 2e-16 ***\nORIGIN_SZBTSZ07      -1.872e+00  1.075e-02  -174.104  < 2e-16 ***\nORIGIN_SZBTSZ08      -1.282e+00  9.394e-03  -136.455  < 2e-16 ***\nORIGIN_SZCCSZ01      -1.774e+00  1.331e-02  -133.243  < 2e-16 ***\nORIGIN_SZCHSZ01      -1.243e+00  1.178e-02  -105.523  < 2e-16 ***\nORIGIN_SZCHSZ02      -5.438e-01  7.940e-03   -68.490  < 2e-16 ***\nORIGIN_SZCHSZ03       4.424e-01  5.829e-03    75.890  < 2e-16 ***\nORIGIN_SZCKSZ01       2.030e-01  5.140e-03    39.499  < 2e-16 ***\nORIGIN_SZCKSZ02       7.258e-01  5.100e-03   142.306  < 2e-16 ***\nORIGIN_SZCKSZ03       7.115e-01  4.634e-03   153.537  < 2e-16 ***\nORIGIN_SZCKSZ04       1.356e+00  4.582e-03   295.987  < 2e-16 ***\nORIGIN_SZCKSZ05       1.013e+00  5.305e-03   190.987  < 2e-16 ***\nORIGIN_SZCKSZ06       1.264e+00  5.042e-03   250.731  < 2e-16 ***\nORIGIN_SZCLSZ01      -6.938e-01  7.661e-03   -90.567  < 2e-16 ***\nORIGIN_SZCLSZ02      -1.838e+00  1.364e-02  -134.718  < 2e-16 ***\nORIGIN_SZCLSZ03      -1.003e+00  7.949e-03  -126.166  < 2e-16 ***\nORIGIN_SZCLSZ04       6.984e-01  4.460e-03   156.605  < 2e-16 ***\nORIGIN_SZCLSZ05      -2.033e+00  1.546e-02  -131.526  < 2e-16 ***\nORIGIN_SZCLSZ06       8.690e-01  4.205e-03   206.665  < 2e-16 ***\nORIGIN_SZCLSZ07      -2.893e-01  5.582e-03   -51.827  < 2e-16 ***\nORIGIN_SZCLSZ08       3.305e-01  5.812e-03    56.866  < 2e-16 ***\nORIGIN_SZCLSZ09      -1.776e+00  1.615e-02  -109.949  < 2e-16 ***\nORIGIN_SZDTSZ02      -4.060e+00  8.341e-02   -48.674  < 2e-16 ***\nORIGIN_SZDTSZ03      -4.031e+00  7.381e-02   -54.617  < 2e-16 ***\nORIGIN_SZGLSZ01      -1.414e+00  9.192e-03  -153.826  < 2e-16 ***\nORIGIN_SZGLSZ02       2.562e-01  4.889e-03    52.412  < 2e-16 ***\nORIGIN_SZGLSZ03       2.410e-01  4.855e-03    49.634  < 2e-16 ***\nORIGIN_SZGLSZ04       8.370e-01  4.200e-03   199.298  < 2e-16 ***\nORIGIN_SZGLSZ05       6.247e-01  4.375e-03   142.765  < 2e-16 ***\nORIGIN_SZHGSZ01       2.784e-01  4.746e-03    58.670  < 2e-16 ***\nORIGIN_SZHGSZ02       4.940e-01  4.712e-03   104.831  < 2e-16 ***\nORIGIN_SZHGSZ03       2.479e-01  5.113e-03    48.476  < 2e-16 ***\nORIGIN_SZHGSZ04       9.074e-01  4.303e-03   210.858  < 2e-16 ***\nORIGIN_SZHGSZ05       1.173e+00  4.253e-03   275.762  < 2e-16 ***\nORIGIN_SZHGSZ06      -9.803e-02  5.413e-03   -18.110  < 2e-16 ***\nORIGIN_SZHGSZ07       6.999e-01  4.455e-03   157.088  < 2e-16 ***\nORIGIN_SZHGSZ08       1.005e-01  5.354e-03    18.766  < 2e-16 ***\nORIGIN_SZHGSZ09      -5.521e-01  6.963e-03   -79.296  < 2e-16 ***\nORIGIN_SZHGSZ10      -3.551e+00  4.211e-02   -84.322  < 2e-16 ***\nORIGIN_SZJESZ01       4.233e-01  4.912e-03    86.170  < 2e-16 ***\nORIGIN_SZJESZ02       2.107e-01  5.015e-03    42.017  < 2e-16 ***\nORIGIN_SZJESZ03       1.816e-01  5.286e-03    34.358  < 2e-16 ***\nORIGIN_SZJESZ05       2.844e-01  4.867e-03    58.427  < 2e-16 ***\nORIGIN_SZJESZ06      -1.901e+00  1.183e-02  -160.665  < 2e-16 ***\nORIGIN_SZJESZ07      -1.056e+00  1.176e-02   -89.775  < 2e-16 ***\nORIGIN_SZJESZ08       4.952e-01  5.034e-03    98.375  < 2e-16 ***\nORIGIN_SZJESZ09      -1.867e+00  1.800e-02  -103.724  < 2e-16 ***\nORIGIN_SZJESZ10      -2.065e+00  1.966e-02  -105.011  < 2e-16 ***\nORIGIN_SZJWSZ01       2.112e-01  6.405e-03    32.980  < 2e-16 ***\nORIGIN_SZJWSZ02       9.365e-01  4.539e-03   206.339  < 2e-16 ***\nORIGIN_SZJWSZ03       1.337e+00  4.196e-03   318.716  < 2e-16 ***\nORIGIN_SZJWSZ04       1.350e+00  4.286e-03   314.883  < 2e-16 ***\nORIGIN_SZJWSZ05      -1.396e+00  1.252e-02  -111.543  < 2e-16 ***\nORIGIN_SZJWSZ06      -1.048e+00  1.067e-02   -98.181  < 2e-16 ***\nORIGIN_SZJWSZ07      -2.726e+00  2.751e-02   -99.095  < 2e-16 ***\nORIGIN_SZJWSZ08       1.968e+00  4.136e-03   475.878  < 2e-16 ***\nORIGIN_SZJWSZ09       1.759e+00  3.954e-03   444.846  < 2e-16 ***\nORIGIN_SZKLSZ01       1.670e-01  4.902e-03    34.071  < 2e-16 ***\nORIGIN_SZKLSZ02      -5.154e-01  6.321e-03   -81.534  < 2e-16 ***\nORIGIN_SZKLSZ03      -4.123e-01  5.949e-03   -69.296  < 2e-16 ***\nORIGIN_SZKLSZ04      -2.283e+00  1.188e-02  -192.202  < 2e-16 ***\nORIGIN_SZKLSZ05      -8.643e-01  8.271e-03  -104.489  < 2e-16 ***\nORIGIN_SZKLSZ06      -4.739e+00  1.857e-01   -25.513  < 2e-16 ***\nORIGIN_SZKLSZ07      -1.124e+00  8.408e-03  -133.651  < 2e-16 ***\nORIGIN_SZKLSZ08      -1.483e+00  9.152e-03  -162.074  < 2e-16 ***\nORIGIN_SZKLSZ09      -3.001e+00  3.129e-02   -95.919  < 2e-16 ***\nORIGIN_SZLKSZ01      -3.407e+00  4.112e-02   -82.854  < 2e-16 ***\nORIGIN_SZMDSZ01      -2.656e+00  2.802e-02   -94.772  < 2e-16 ***\nORIGIN_SZMDSZ02      -9.216e-01  1.036e-02   -88.993  < 2e-16 ***\nORIGIN_SZMDSZ03      -2.005e+00  1.703e-02  -117.719  < 2e-16 ***\nORIGIN_SZMPSZ01      -1.090e+00  8.368e-03  -130.210  < 2e-16 ***\nORIGIN_SZMPSZ02      -5.966e-01  6.898e-03   -86.477  < 2e-16 ***\nORIGIN_SZMPSZ03      -7.337e-03  5.319e-03    -1.379  0.16779    \nORIGIN_SZMUSZ02      -3.914e+00  1.038e-01   -37.724  < 2e-16 ***\nORIGIN_SZNTSZ01      -2.824e+00  3.529e-02   -80.022  < 2e-16 ***\nORIGIN_SZNTSZ02      -3.261e+00  2.323e-02  -140.392  < 2e-16 ***\nORIGIN_SZNTSZ03      -9.932e-01  7.777e-03  -127.711  < 2e-16 ***\nORIGIN_SZNTSZ05      -3.355e+00  4.964e-02   -67.596  < 2e-16 ***\nORIGIN_SZNTSZ06      -3.822e+00  5.576e-02   -68.554  < 2e-16 ***\nORIGIN_SZNVSZ01       4.493e-01  4.482e-03   100.244  < 2e-16 ***\nORIGIN_SZNVSZ02      -6.281e-01  6.470e-03   -97.079  < 2e-16 ***\nORIGIN_SZNVSZ03      -1.212e+00  7.788e-03  -155.631  < 2e-16 ***\nORIGIN_SZNVSZ04      -1.454e+00  9.091e-03  -159.939  < 2e-16 ***\nORIGIN_SZNVSZ05      -2.618e+00  1.579e-02  -165.843  < 2e-16 ***\nORIGIN_SZPGSZ01      -9.554e-01  1.223e-02   -78.143  < 2e-16 ***\nORIGIN_SZPGSZ02      -5.298e-01  7.233e-03   -73.255  < 2e-16 ***\nORIGIN_SZPGSZ03       9.636e-01  4.437e-03   217.164  < 2e-16 ***\nORIGIN_SZPGSZ04       1.115e+00  4.417e-03   252.455  < 2e-16 ***\nORIGIN_SZPGSZ05       2.723e-01  5.758e-03    47.301  < 2e-16 ***\nORIGIN_SZPLSZ01      -8.414e-01  1.044e-02   -80.616  < 2e-16 ***\nORIGIN_SZPLSZ02      -1.704e+00  1.478e-02  -115.290  < 2e-16 ***\nORIGIN_SZPLSZ03      -3.011e+00  3.672e-02   -81.995  < 2e-16 ***\nORIGIN_SZPLSZ04      -3.313e+00  3.684e-02   -89.923  < 2e-16 ***\nORIGIN_SZPLSZ05      -2.494e+00  2.245e-02  -111.086  < 2e-16 ***\nORIGIN_SZPNSZ01       1.390e+00  4.587e-03   303.067  < 2e-16 ***\nORIGIN_SZPNSZ02      -5.588e-01  1.108e-02   -50.420  < 2e-16 ***\nORIGIN_SZPNSZ03      -1.927e+00  1.940e-02   -99.323  < 2e-16 ***\nORIGIN_SZPNSZ04      -2.812e+00  3.112e-02   -90.351  < 2e-16 ***\nORIGIN_SZPNSZ05      -2.325e+00  2.628e-02   -88.494  < 2e-16 ***\nORIGIN_SZPRSZ01      -8.278e-01  1.142e-02   -72.506  < 2e-16 ***\nORIGIN_SZPRSZ02       9.441e-01  4.615e-03   204.580  < 2e-16 ***\nORIGIN_SZPRSZ03       7.722e-01  4.626e-03   166.924  < 2e-16 ***\nORIGIN_SZPRSZ04      -3.771e-01  7.516e-03   -50.170  < 2e-16 ***\nORIGIN_SZPRSZ05       1.332e+00  4.326e-03   307.840  < 2e-16 ***\nORIGIN_SZPRSZ06      -4.352e-01  8.652e-03   -50.302  < 2e-16 ***\nORIGIN_SZPRSZ07      -2.153e+00  1.610e-02  -133.686  < 2e-16 ***\nORIGIN_SZPRSZ08       2.034e-03  6.383e-03     0.319  0.74997    \nORIGIN_SZQTSZ01      -4.154e-01  6.846e-03   -60.687  < 2e-16 ***\nORIGIN_SZQTSZ02      -8.964e-01  6.554e-03  -136.764  < 2e-16 ***\nORIGIN_SZQTSZ03      -2.433e-01  5.681e-03   -42.827  < 2e-16 ***\nORIGIN_SZQTSZ04      -1.014e+00  7.147e-03  -141.878  < 2e-16 ***\nORIGIN_SZQTSZ05      -3.924e-01  5.994e-03   -65.469  < 2e-16 ***\nORIGIN_SZQTSZ06      -5.652e-01  6.481e-03   -87.212  < 2e-16 ***\nORIGIN_SZQTSZ07      -1.557e+00  9.661e-03  -161.147  < 2e-16 ***\nORIGIN_SZQTSZ08      -1.742e-01  5.711e-03   -30.508  < 2e-16 ***\nORIGIN_SZQTSZ09      -6.298e-01  6.633e-03   -94.939  < 2e-16 ***\nORIGIN_SZQTSZ10      -4.540e-01  6.512e-03   -69.717  < 2e-16 ***\nORIGIN_SZQTSZ11      -1.474e+00  9.854e-03  -149.591  < 2e-16 ***\nORIGIN_SZQTSZ12      -1.507e+00  1.048e-02  -143.798  < 2e-16 ***\nORIGIN_SZQTSZ13      -3.515e-01  6.415e-03   -54.787  < 2e-16 ***\nORIGIN_SZQTSZ14      -1.601e+00  9.848e-03  -162.557  < 2e-16 ***\nORIGIN_SZQTSZ15      -9.283e-01  1.037e-02   -89.550  < 2e-16 ***\nORIGIN_SZRCSZ01      -1.375e+00  1.265e-02  -108.643  < 2e-16 ***\nORIGIN_SZRCSZ06      -6.220e-01  8.475e-03   -73.399  < 2e-16 ***\nORIGIN_SZRVSZ01      -3.528e+00  3.237e-02  -108.977  < 2e-16 ***\nORIGIN_SZRVSZ02      -2.914e+00  2.776e-02  -104.969  < 2e-16 ***\nORIGIN_SZRVSZ03      -3.151e+00  2.379e-02  -132.454  < 2e-16 ***\nORIGIN_SZRVSZ04      -3.360e+00  5.567e-02   -60.356  < 2e-16 ***\nORIGIN_SZRVSZ05      -2.441e+00  1.644e-02  -148.448  < 2e-16 ***\nORIGIN_SZSBSZ01       5.918e-01  5.529e-03   107.026  < 2e-16 ***\nORIGIN_SZSBSZ02      -7.116e-01  8.213e-03   -86.651  < 2e-16 ***\nORIGIN_SZSBSZ03       9.629e-01  4.611e-03   208.849  < 2e-16 ***\nORIGIN_SZSBSZ04       7.689e-01  5.289e-03   145.378  < 2e-16 ***\nORIGIN_SZSBSZ05      -9.923e-02  6.543e-03   -15.165  < 2e-16 ***\nORIGIN_SZSBSZ06      -1.785e+00  1.719e-02  -103.815  < 2e-16 ***\nORIGIN_SZSBSZ07      -1.188e+00  1.256e-02   -94.633  < 2e-16 ***\nORIGIN_SZSBSZ08      -1.245e+00  1.222e-02  -101.924  < 2e-16 ***\nORIGIN_SZSBSZ09      -6.004e-01  8.580e-03   -69.982  < 2e-16 ***\nORIGIN_SZSESZ02       1.006e+00  4.409e-03   228.108  < 2e-16 ***\nORIGIN_SZSESZ03       1.219e+00  4.164e-03   292.883  < 2e-16 ***\nORIGIN_SZSESZ04       8.171e-01  4.868e-03   167.840  < 2e-16 ***\nORIGIN_SZSESZ05      -2.153e-01  5.915e-03   -36.395  < 2e-16 ***\nORIGIN_SZSESZ06       7.333e-01  4.689e-03   156.388  < 2e-16 ***\nORIGIN_SZSESZ07      -2.561e+00  1.961e-02  -130.595  < 2e-16 ***\nORIGIN_SZSGSZ01      -1.015e+00  8.550e-03  -118.682  < 2e-16 ***\nORIGIN_SZSGSZ02      -1.133e+00  9.590e-03  -118.117  < 2e-16 ***\nORIGIN_SZSGSZ03       2.195e-01  5.167e-03    42.469  < 2e-16 ***\nORIGIN_SZSGSZ04       2.709e-01  4.792e-03    56.540  < 2e-16 ***\nORIGIN_SZSGSZ05      -1.783e+00  1.060e-02  -168.215  < 2e-16 ***\nORIGIN_SZSGSZ06       4.037e-01  4.541e-03    88.909  < 2e-16 ***\nORIGIN_SZSGSZ07      -6.271e-01  6.235e-03  -100.591  < 2e-16 ***\nORIGIN_SZSKSZ01      -2.229e-01  7.766e-03   -28.702  < 2e-16 ***\nORIGIN_SZSKSZ02       3.738e-01  5.689e-03    65.704  < 2e-16 ***\nORIGIN_SZSKSZ03      -7.007e-01  7.984e-03   -87.762  < 2e-16 ***\nORIGIN_SZSKSZ04      -2.572e+00  2.702e-02   -95.190  < 2e-16 ***\nORIGIN_SZSKSZ05      -1.416e+00  1.552e-02   -91.244  < 2e-16 ***\nORIGIN_SZSLSZ01      -3.240e+00  3.058e-02  -105.930  < 2e-16 ***\nORIGIN_SZSLSZ04      -6.855e-01  7.683e-03   -89.212  < 2e-16 ***\nORIGIN_SZSRSZ01      -2.392e+00  1.583e-02  -151.179  < 2e-16 ***\nORIGIN_SZTMSZ01       4.030e-01  5.814e-03    69.317  < 2e-16 ***\nORIGIN_SZTMSZ02       2.225e+00  3.795e-03   586.433  < 2e-16 ***\nORIGIN_SZTMSZ03       1.415e+00  4.108e-03   344.346  < 2e-16 ***\nORIGIN_SZTMSZ04       9.131e-01  4.742e-03   192.571  < 2e-16 ***\nORIGIN_SZTMSZ05      -3.267e-01  7.534e-03   -43.356  < 2e-16 ***\nORIGIN_SZTNSZ01      -1.807e+00  1.038e-02  -174.116  < 2e-16 ***\nORIGIN_SZTNSZ02      -1.743e+00  9.778e-03  -178.256  < 2e-16 ***\nORIGIN_SZTNSZ03      -2.279e+00  1.338e-02  -170.383  < 2e-16 ***\nORIGIN_SZTNSZ04      -7.728e-01  7.197e-03  -107.380  < 2e-16 ***\nORIGIN_SZTPSZ01      -6.450e-01  6.287e-03  -102.586  < 2e-16 ***\nORIGIN_SZTPSZ02       4.679e-01  4.347e-03   107.628  < 2e-16 ***\nORIGIN_SZTPSZ03      -5.153e-01  6.085e-03   -84.696  < 2e-16 ***\nORIGIN_SZTPSZ04      -2.885e-01  5.779e-03   -49.929  < 2e-16 ***\nORIGIN_SZTPSZ05      -2.171e-01  6.072e-03   -35.747  < 2e-16 ***\nORIGIN_SZTPSZ06       3.343e-01  5.942e-03    56.255  < 2e-16 ***\nORIGIN_SZTPSZ07      -2.529e-01  6.317e-03   -40.027  < 2e-16 ***\nORIGIN_SZTPSZ08      -1.076e+00  9.109e-03  -118.071  < 2e-16 ***\nORIGIN_SZTPSZ09      -3.700e-01  6.189e-03   -59.777  < 2e-16 ***\nORIGIN_SZTPSZ10      -7.008e-01  7.635e-03   -91.794  < 2e-16 ***\nORIGIN_SZTPSZ11       7.676e-02  5.459e-03    14.060  < 2e-16 ***\nORIGIN_SZTPSZ12      -5.960e-01  6.522e-03   -91.388  < 2e-16 ***\nORIGIN_SZTSSZ01      -3.551e+00  4.755e-02   -74.678  < 2e-16 ***\nORIGIN_SZTSSZ02       2.582e-01  7.339e-03    35.182  < 2e-16 ***\nORIGIN_SZTSSZ03       3.057e-01  7.074e-03    43.214  < 2e-16 ***\nORIGIN_SZTSSZ04       2.841e-01  7.479e-03    37.985  < 2e-16 ***\nORIGIN_SZTSSZ05      -1.103e+00  1.389e-02   -79.411  < 2e-16 ***\nORIGIN_SZTSSZ06      -1.362e+00  1.718e-02   -79.311  < 2e-16 ***\nORIGIN_SZWDSZ01       1.359e+00  4.146e-03   327.844  < 2e-16 ***\nORIGIN_SZWDSZ02       1.042e+00  4.747e-03   219.450  < 2e-16 ***\nORIGIN_SZWDSZ03       2.192e+00  4.035e-03   543.223  < 2e-16 ***\nORIGIN_SZWDSZ04       1.146e+00  4.963e-03   230.968  < 2e-16 ***\nORIGIN_SZWDSZ05       5.149e-01  4.998e-03   103.010  < 2e-16 ***\nORIGIN_SZWDSZ06       1.205e+00  4.611e-03   261.314  < 2e-16 ***\nORIGIN_SZWDSZ07      -4.076e-01  8.035e-03   -50.729  < 2e-16 ***\nORIGIN_SZWDSZ08      -5.072e-01  7.878e-03   -64.380  < 2e-16 ***\nORIGIN_SZWDSZ09       1.469e+00  4.402e-03   333.784  < 2e-16 ***\nORIGIN_SZYSSZ01      -1.543e-01  5.643e-03   -27.335  < 2e-16 ***\nORIGIN_SZYSSZ02       8.990e-01  4.973e-03   180.778  < 2e-16 ***\nORIGIN_SZYSSZ03       1.761e+00  4.275e-03   411.879  < 2e-16 ***\nORIGIN_SZYSSZ04       8.478e-01  4.538e-03   186.812  < 2e-16 ***\nORIGIN_SZYSSZ05      -9.798e-02  5.920e-03   -16.551  < 2e-16 ***\nORIGIN_SZYSSZ06      -1.180e+00  1.079e-02  -109.309  < 2e-16 ***\nORIGIN_SZYSSZ07      -1.212e+00  1.127e-02  -107.523  < 2e-16 ***\nORIGIN_SZYSSZ08       1.173e-02  6.104e-03     1.921  0.05474 .  \nORIGIN_SZYSSZ09       1.386e+00  4.239e-03   326.910  < 2e-16 ***\nlog(DESTIN_AGE25_64)  1.725e-02  8.976e-05   192.206  < 2e-16 ***\nlog(dist)            -6.974e-01  1.299e-04 -5369.356  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 59965744  on 14439  degrees of freedom\nResidual deviance: 26225309  on 14169  degrees of freedom\nAIC: 26315774\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\n\nWe can examine how the constraints hold for destinations this time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(orcSIM$data$TRIPS, orcSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4176108\n```\n:::\n:::\n\n\n## **6.7 Destination constrained**\n\nIn this section, we will fit a destination constrained SIM by using the code chunk below.\n\nThe general formula of Destination Constrained Spatial Interaction Model\n\n![](https://r4gdsa.netlify.app/chap15/img/image3.jpg)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndecSIM <- glm(formula = TRIPS ~ \n                DESTIN_SZ + \n                log(ORIGIN_AGE25_64) + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(decSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)          10.9048570  0.0033523  3252.910  < 2e-16 ***\nDESTIN_SZAMSZ02       0.1794342  0.0041531    43.205  < 2e-16 ***\nDESTIN_SZAMSZ03       0.2090428  0.0040888    51.125  < 2e-16 ***\nDESTIN_SZAMSZ04      -0.9401652  0.0060637  -155.047  < 2e-16 ***\nDESTIN_SZAMSZ05      -1.1572689  0.0061804  -187.249  < 2e-16 ***\nDESTIN_SZAMSZ06      -0.8873938  0.0059241  -149.794  < 2e-16 ***\nDESTIN_SZAMSZ07      -1.7747577  0.0096070  -184.735  < 2e-16 ***\nDESTIN_SZAMSZ08      -1.0725433  0.0067763  -158.278  < 2e-16 ***\nDESTIN_SZAMSZ09      -0.9677570  0.0060435  -160.132  < 2e-16 ***\nDESTIN_SZAMSZ10       0.2626640  0.0043738    60.054  < 2e-16 ***\nDESTIN_SZAMSZ11      -0.3817442  0.0086203   -44.284  < 2e-16 ***\nDESTIN_SZAMSZ12       0.0227389  0.0049853     4.561 5.09e-06 ***\nDESTIN_SZBDSZ01       0.5188375  0.0037828   137.158  < 2e-16 ***\nDESTIN_SZBDSZ02      -0.2810011  0.0049518   -56.748  < 2e-16 ***\nDESTIN_SZBDSZ03      -0.0094520  0.0042692    -2.214   0.0268 *  \nDESTIN_SZBDSZ04       1.0072820  0.0034465   292.261  < 2e-16 ***\nDESTIN_SZBDSZ05       0.3727823  0.0038992    95.604  < 2e-16 ***\nDESTIN_SZBDSZ06       0.2034898  0.0042183    48.240  < 2e-16 ***\nDESTIN_SZBDSZ07      -1.0700301  0.0092942  -115.128  < 2e-16 ***\nDESTIN_SZBDSZ08      -1.7761373  0.0105722  -168.001  < 2e-16 ***\nDESTIN_SZBKSZ01      -1.1851806  0.0065623  -180.605  < 2e-16 ***\nDESTIN_SZBKSZ02      -0.2605523  0.0052044   -50.064  < 2e-16 ***\nDESTIN_SZBKSZ03      -0.5859135  0.0055889  -104.836  < 2e-16 ***\nDESTIN_SZBKSZ04      -0.0396635  0.0048300    -8.212  < 2e-16 ***\nDESTIN_SZBKSZ05      -0.8199651  0.0057162  -143.446  < 2e-16 ***\nDESTIN_SZBKSZ06      -0.8595238  0.0061131  -140.602  < 2e-16 ***\nDESTIN_SZBKSZ07       0.2328526  0.0040343    57.718  < 2e-16 ***\nDESTIN_SZBKSZ08      -1.1213047  0.0068909  -162.723  < 2e-16 ***\nDESTIN_SZBKSZ09      -0.2885351  0.0049057   -58.817  < 2e-16 ***\nDESTIN_SZBLSZ01      -0.4314048  0.0070373   -61.302  < 2e-16 ***\nDESTIN_SZBLSZ02       0.6225445  0.0065214    95.461  < 2e-16 ***\nDESTIN_SZBLSZ03       1.2994918  0.0074176   175.191  < 2e-16 ***\nDESTIN_SZBLSZ04      -0.0867525  0.0131590    -6.593 4.32e-11 ***\nDESTIN_SZBMSZ01      -0.3519222  0.0046932   -74.986  < 2e-16 ***\nDESTIN_SZBMSZ02      -0.6047253  0.0048827  -123.849  < 2e-16 ***\nDESTIN_SZBMSZ03      -0.8764932  0.0056851  -154.173  < 2e-16 ***\nDESTIN_SZBMSZ04      -0.5386213  0.0048888  -110.175  < 2e-16 ***\nDESTIN_SZBMSZ05      -0.5045702  0.0065972   -76.483  < 2e-16 ***\nDESTIN_SZBMSZ06      -2.0715224  0.0123050  -168.348  < 2e-16 ***\nDESTIN_SZBMSZ07      -0.3146773  0.0045283   -69.491  < 2e-16 ***\nDESTIN_SZBMSZ08      -1.2783009  0.0062622  -204.130  < 2e-16 ***\nDESTIN_SZBMSZ09      -2.8159501  0.0143531  -196.190  < 2e-16 ***\nDESTIN_SZBMSZ10      -1.9257815  0.0089273  -215.718  < 2e-16 ***\nDESTIN_SZBMSZ11      -1.7330104  0.0079280  -218.592  < 2e-16 ***\nDESTIN_SZBMSZ12      -1.1563618  0.0077721  -148.784  < 2e-16 ***\nDESTIN_SZBMSZ13      -0.5415215  0.0050827  -106.543  < 2e-16 ***\nDESTIN_SZBMSZ14      -1.1498161  0.0076325  -150.647  < 2e-16 ***\nDESTIN_SZBMSZ15      -1.2258914  0.0068685  -178.481  < 2e-16 ***\nDESTIN_SZBMSZ16      -2.4130400  0.0107906  -223.625  < 2e-16 ***\nDESTIN_SZBMSZ17      -2.6995857  0.0164771  -163.839  < 2e-16 ***\nDESTIN_SZBPSZ01      -0.6609664  0.0055422  -119.262  < 2e-16 ***\nDESTIN_SZBPSZ02      -1.4575221  0.0083272  -175.032  < 2e-16 ***\nDESTIN_SZBPSZ03      -1.0776369  0.0075110  -143.475  < 2e-16 ***\nDESTIN_SZBPSZ04      -0.6644971  0.0058070  -114.430  < 2e-16 ***\nDESTIN_SZBPSZ05       0.3370210  0.0039665    84.968  < 2e-16 ***\nDESTIN_SZBPSZ06      -0.9405736  0.0077394  -121.531  < 2e-16 ***\nDESTIN_SZBPSZ07      -0.6923515  0.0077761   -89.035  < 2e-16 ***\nDESTIN_SZBSSZ01      -0.3132696  0.0045803   -68.395  < 2e-16 ***\nDESTIN_SZBSSZ02      -0.7502434  0.0051075  -146.890  < 2e-16 ***\nDESTIN_SZBSSZ03       0.1994211  0.0038256    52.129  < 2e-16 ***\nDESTIN_SZBTSZ01       0.0756101  0.0041655    18.152  < 2e-16 ***\nDESTIN_SZBTSZ02      -0.8223330  0.0065871  -124.840  < 2e-16 ***\nDESTIN_SZBTSZ03      -0.1686173  0.0047942   -35.171  < 2e-16 ***\nDESTIN_SZBTSZ04      -1.7768580  0.0103706  -171.336  < 2e-16 ***\nDESTIN_SZBTSZ05      -0.8248176  0.0067753  -121.739  < 2e-16 ***\nDESTIN_SZBTSZ06      -0.8184079  0.0059754  -136.964  < 2e-16 ***\nDESTIN_SZBTSZ07      -2.0091001  0.0098567  -203.831  < 2e-16 ***\nDESTIN_SZBTSZ08      -1.3637279  0.0086828  -157.061  < 2e-16 ***\nDESTIN_SZCCSZ01      -1.0100002  0.0080160  -125.998  < 2e-16 ***\nDESTIN_SZCHSZ01      -1.1944563  0.0095262  -125.387  < 2e-16 ***\nDESTIN_SZCHSZ02       0.0873727  0.0052277    16.713  < 2e-16 ***\nDESTIN_SZCHSZ03       1.4948319  0.0039093   382.380  < 2e-16 ***\nDESTIN_SZCKSZ01      -0.1634909  0.0047877   -34.148  < 2e-16 ***\nDESTIN_SZCKSZ02      -0.4336030  0.0051906   -83.537  < 2e-16 ***\nDESTIN_SZCKSZ03       0.6144175  0.0038938   157.794  < 2e-16 ***\nDESTIN_SZCKSZ04      -0.6374068  0.0060213  -105.858  < 2e-16 ***\nDESTIN_SZCKSZ05      -0.4158835  0.0065477   -63.516  < 2e-16 ***\nDESTIN_SZCKSZ06       0.7039272  0.0045205   155.720  < 2e-16 ***\nDESTIN_SZCLSZ01       0.3720426  0.0047401    78.489  < 2e-16 ***\nDESTIN_SZCLSZ02      -2.2890079  0.0133640  -171.282  < 2e-16 ***\nDESTIN_SZCLSZ03      -1.0640354  0.0077341  -137.576  < 2e-16 ***\nDESTIN_SZCLSZ04      -0.1350210  0.0045276   -29.822  < 2e-16 ***\nDESTIN_SZCLSZ05      -1.3066824  0.0084133  -155.311  < 2e-16 ***\nDESTIN_SZCLSZ06       0.1706115  0.0040204    42.437  < 2e-16 ***\nDESTIN_SZCLSZ07      -0.6384155  0.0052626  -121.311  < 2e-16 ***\nDESTIN_SZCLSZ08      -0.4303467  0.0057208   -75.225  < 2e-16 ***\nDESTIN_SZCLSZ09       0.3781519  0.0063762    59.306  < 2e-16 ***\nDESTIN_SZDTSZ02      -3.0113027  0.0348374   -86.439  < 2e-16 ***\nDESTIN_SZDTSZ03      -1.4638228  0.0144110  -101.577  < 2e-16 ***\nDESTIN_SZGLSZ01       0.0008007  0.0051224     0.156   0.8758    \nDESTIN_SZGLSZ02      -0.3400452  0.0046225   -73.564  < 2e-16 ***\nDESTIN_SZGLSZ03       0.3707011  0.0038385    96.576  < 2e-16 ***\nDESTIN_SZGLSZ04       0.2962045  0.0038027    77.894  < 2e-16 ***\nDESTIN_SZGLSZ05       0.1799813  0.0038854    46.322  < 2e-16 ***\nDESTIN_SZHGSZ01       0.2999418  0.0038825    77.255  < 2e-16 ***\nDESTIN_SZHGSZ02      -0.5667530  0.0051182  -110.733  < 2e-16 ***\nDESTIN_SZHGSZ03      -1.0354679  0.0061020  -169.693  < 2e-16 ***\nDESTIN_SZHGSZ04      -0.2229674  0.0043617   -51.119  < 2e-16 ***\nDESTIN_SZHGSZ05      -0.2243046  0.0044852   -50.010  < 2e-16 ***\nDESTIN_SZHGSZ06      -0.7873601  0.0054082  -145.588  < 2e-16 ***\nDESTIN_SZHGSZ07       0.2301402  0.0040336    57.055  < 2e-16 ***\nDESTIN_SZHGSZ08      -0.4244403  0.0048967   -86.678  < 2e-16 ***\nDESTIN_SZHGSZ09       0.1040754  0.0051341    20.271  < 2e-16 ***\nDESTIN_SZHGSZ10      -2.8620769  0.0262064  -109.213  < 2e-16 ***\nDESTIN_SZJESZ01      -0.0833734  0.0048513   -17.186  < 2e-16 ***\nDESTIN_SZJESZ02      -0.5229790  0.0051627  -101.299  < 2e-16 ***\nDESTIN_SZJESZ03      -0.6268850  0.0056619  -110.719  < 2e-16 ***\nDESTIN_SZJESZ05       0.3672967  0.0040723    90.194  < 2e-16 ***\nDESTIN_SZJESZ06      -1.1830729  0.0083207  -142.184  < 2e-16 ***\nDESTIN_SZJESZ07      -0.5998690  0.0078072   -76.835  < 2e-16 ***\nDESTIN_SZJESZ08      -0.3569870  0.0054074   -66.019  < 2e-16 ***\nDESTIN_SZJESZ09       0.7544414  0.0069536   108.497  < 2e-16 ***\nDESTIN_SZJESZ10       0.9279204  0.0065841   140.934  < 2e-16 ***\nDESTIN_SZJWSZ01      -0.4429734  0.0064901   -68.253  < 2e-16 ***\nDESTIN_SZJWSZ02      -0.2696030  0.0051841   -52.006  < 2e-16 ***\nDESTIN_SZJWSZ03       0.6692064  0.0039405   169.829  < 2e-16 ***\nDESTIN_SZJWSZ04       0.9668460  0.0037235   259.663  < 2e-16 ***\nDESTIN_SZJWSZ05      -0.1811230  0.0061053   -29.667  < 2e-16 ***\nDESTIN_SZJWSZ06       0.3956140  0.0054555    72.517  < 2e-16 ***\nDESTIN_SZJWSZ07      -1.2441505  0.0280511   -44.353  < 2e-16 ***\nDESTIN_SZJWSZ08       0.5105167  0.0044598   114.471  < 2e-16 ***\nDESTIN_SZJWSZ09       1.4261488  0.0033999   419.472  < 2e-16 ***\nDESTIN_SZKLSZ01      -0.6889038  0.0051541  -133.662  < 2e-16 ***\nDESTIN_SZKLSZ02      -0.8142969  0.0057129  -142.536  < 2e-16 ***\nDESTIN_SZKLSZ03      -1.3947234  0.0065167  -214.024  < 2e-16 ***\nDESTIN_SZKLSZ04      -1.9197258  0.0087370  -219.724  < 2e-16 ***\nDESTIN_SZKLSZ05      -0.9261163  0.0071089  -130.275  < 2e-16 ***\nDESTIN_SZKLSZ06      -2.5352994  0.0362062   -70.024  < 2e-16 ***\nDESTIN_SZKLSZ07      -1.2046443  0.0065751  -183.214  < 2e-16 ***\nDESTIN_SZKLSZ08      -0.6069437  0.0050916  -119.205  < 2e-16 ***\nDESTIN_SZKLSZ09      -2.2332579  0.0161428  -138.344  < 2e-16 ***\nDESTIN_SZLKSZ01      -1.7173865  0.0227798   -75.391  < 2e-16 ***\nDESTIN_SZMDSZ01      -1.4826104  0.0198353   -74.746  < 2e-16 ***\nDESTIN_SZMDSZ02      -1.1635489  0.0111347  -104.497  < 2e-16 ***\nDESTIN_SZMDSZ03      -3.0041676  0.0250839  -119.765  < 2e-16 ***\nDESTIN_SZMPSZ01      -1.1815844  0.0077128  -153.198  < 2e-16 ***\nDESTIN_SZMPSZ02      -0.9424158  0.0060321  -156.233  < 2e-16 ***\nDESTIN_SZMPSZ03      -0.1783623  0.0046389   -38.449  < 2e-16 ***\nDESTIN_SZMUSZ02      -2.4549101  0.0199631  -122.973  < 2e-16 ***\nDESTIN_SZNTSZ01      -3.6621849  0.0447752   -81.790  < 2e-16 ***\nDESTIN_SZNTSZ02      -2.0133234  0.0108737  -185.156  < 2e-16 ***\nDESTIN_SZNTSZ03      -1.2431428  0.0076142  -163.267  < 2e-16 ***\nDESTIN_SZNTSZ05      -1.8045038  0.0249540   -72.313  < 2e-16 ***\nDESTIN_SZNTSZ06      -2.9433484  0.0428601   -68.673  < 2e-16 ***\nDESTIN_SZNVSZ01      -0.4079260  0.0044288   -92.107  < 2e-16 ***\nDESTIN_SZNVSZ02      -0.6882643  0.0052770  -130.428  < 2e-16 ***\nDESTIN_SZNVSZ03      -0.7347477  0.0054243  -135.454  < 2e-16 ***\nDESTIN_SZNVSZ04      -2.2122891  0.0107185  -206.399  < 2e-16 ***\nDESTIN_SZNVSZ05      -1.8739867  0.0089167  -210.166  < 2e-16 ***\nDESTIN_SZPGSZ01      -1.8848423  0.0153008  -123.186  < 2e-16 ***\nDESTIN_SZPGSZ02      -0.9406940  0.0067225  -139.933  < 2e-16 ***\nDESTIN_SZPGSZ03       0.3510796  0.0040153    87.435  < 2e-16 ***\nDESTIN_SZPGSZ04      -0.0213665  0.0044806    -4.769 1.85e-06 ***\nDESTIN_SZPGSZ05      -0.8888067  0.0070731  -125.660  < 2e-16 ***\nDESTIN_SZPLSZ01      -0.2161571  0.0068270   -31.662  < 2e-16 ***\nDESTIN_SZPLSZ02      -1.3661949  0.0131155  -104.166  < 2e-16 ***\nDESTIN_SZPLSZ03      -0.1023407  0.0095847   -10.678  < 2e-16 ***\nDESTIN_SZPLSZ04      -0.2719250  0.0093344   -29.131  < 2e-16 ***\nDESTIN_SZPLSZ05      -0.7320516  0.0116840   -62.654  < 2e-16 ***\nDESTIN_SZPNSZ01       1.1346701  0.0050030   226.800  < 2e-16 ***\nDESTIN_SZPNSZ02       1.5968935  0.0064539   247.431  < 2e-16 ***\nDESTIN_SZPNSZ03       0.8152494  0.0077064   105.789  < 2e-16 ***\nDESTIN_SZPNSZ04       1.6117326  0.0075820   212.573  < 2e-16 ***\nDESTIN_SZPNSZ05       0.6627057  0.0115960    57.149  < 2e-16 ***\nDESTIN_SZPRSZ01      -1.0227494  0.0084651  -120.819  < 2e-16 ***\nDESTIN_SZPRSZ02      -0.1997262  0.0049840   -40.074  < 2e-16 ***\nDESTIN_SZPRSZ03       0.5602753  0.0038497   145.538  < 2e-16 ***\nDESTIN_SZPRSZ04      -0.6872884  0.0079048   -86.946  < 2e-16 ***\nDESTIN_SZPRSZ05       0.0360643  0.0044947     8.024 1.03e-15 ***\nDESTIN_SZPRSZ06       0.3731070  0.0052006    71.744  < 2e-16 ***\nDESTIN_SZPRSZ07      -1.4843250  0.0117304  -126.536  < 2e-16 ***\nDESTIN_SZPRSZ08      -0.7859293  0.0064863  -121.168  < 2e-16 ***\nDESTIN_SZQTSZ01      -1.2844606  0.0085392  -150.419  < 2e-16 ***\nDESTIN_SZQTSZ02      -1.5532989  0.0075748  -205.062  < 2e-16 ***\nDESTIN_SZQTSZ03      -0.9417558  0.0064036  -147.068  < 2e-16 ***\nDESTIN_SZQTSZ04      -1.0568943  0.0065335  -161.766  < 2e-16 ***\nDESTIN_SZQTSZ05      -0.9791783  0.0058471  -167.464  < 2e-16 ***\nDESTIN_SZQTSZ06      -1.2229471  0.0063559  -192.410  < 2e-16 ***\nDESTIN_SZQTSZ07      -1.6880979  0.0108728  -155.258  < 2e-16 ***\nDESTIN_SZQTSZ08      -0.1267999  0.0047981   -26.427  < 2e-16 ***\nDESTIN_SZQTSZ09      -0.5271811  0.0057372   -91.888  < 2e-16 ***\nDESTIN_SZQTSZ10      -0.6033522  0.0054192  -111.335  < 2e-16 ***\nDESTIN_SZQTSZ11      -0.1065174  0.0053446   -19.930  < 2e-16 ***\nDESTIN_SZQTSZ12      -0.6207776  0.0070682   -87.827  < 2e-16 ***\nDESTIN_SZQTSZ13      -0.1713212  0.0051327   -33.379  < 2e-16 ***\nDESTIN_SZQTSZ14      -0.5412722  0.0062295   -86.888  < 2e-16 ***\nDESTIN_SZQTSZ15      -0.2018865  0.0073133   -27.605  < 2e-16 ***\nDESTIN_SZRCSZ01      -0.5887462  0.0071799   -82.000  < 2e-16 ***\nDESTIN_SZRCSZ06      -2.0792352  0.0188789  -110.135  < 2e-16 ***\nDESTIN_SZRVSZ01      -2.6275247  0.0162319  -161.874  < 2e-16 ***\nDESTIN_SZRVSZ02      -3.2048147  0.0326141   -98.265  < 2e-16 ***\nDESTIN_SZRVSZ03      -2.6101244  0.0135074  -193.236  < 2e-16 ***\nDESTIN_SZRVSZ04      -1.9761848  0.0154961  -127.528  < 2e-16 ***\nDESTIN_SZRVSZ05      -3.1658254  0.0256310  -123.516  < 2e-16 ***\nDESTIN_SZSBSZ01      -0.3141815  0.0060601   -51.845  < 2e-16 ***\nDESTIN_SZSBSZ02      -1.1269245  0.0076338  -147.623  < 2e-16 ***\nDESTIN_SZSBSZ03       0.6278879  0.0041400   151.665  < 2e-16 ***\nDESTIN_SZSBSZ04       0.1390338  0.0051357    27.072  < 2e-16 ***\nDESTIN_SZSBSZ05      -0.9300945  0.0071963  -129.246  < 2e-16 ***\nDESTIN_SZSBSZ06      -2.3688755  0.0221612  -106.893  < 2e-16 ***\nDESTIN_SZSBSZ07      -0.8266276  0.0181719   -45.489  < 2e-16 ***\nDESTIN_SZSBSZ08       1.3086845  0.0051611   253.569  < 2e-16 ***\nDESTIN_SZSBSZ09       0.8367350  0.0048334   173.117  < 2e-16 ***\nDESTIN_SZSESZ02      -0.2330407  0.0046619   -49.989  < 2e-16 ***\nDESTIN_SZSESZ03       0.5496954  0.0036933   148.836  < 2e-16 ***\nDESTIN_SZSESZ04      -0.6672495  0.0054223  -123.057  < 2e-16 ***\nDESTIN_SZSESZ05      -0.3560664  0.0047508   -74.949  < 2e-16 ***\nDESTIN_SZSESZ06      -0.6054775  0.0057017  -106.192  < 2e-16 ***\nDESTIN_SZSESZ07      -2.9485846  0.0226797  -130.010  < 2e-16 ***\nDESTIN_SZSGSZ01      -0.5148041  0.0058281   -88.332  < 2e-16 ***\nDESTIN_SZSGSZ02      -0.0421213  0.0051633    -8.158 3.41e-16 ***\nDESTIN_SZSGSZ03      -0.3703320  0.0047152   -78.539  < 2e-16 ***\nDESTIN_SZSGSZ04      -0.3030801  0.0046866   -64.670  < 2e-16 ***\nDESTIN_SZSGSZ05      -2.2243063  0.0097908  -227.183  < 2e-16 ***\nDESTIN_SZSGSZ06       0.2963958  0.0037948    78.106  < 2e-16 ***\nDESTIN_SZSGSZ07      -0.5960150  0.0051371  -116.022  < 2e-16 ***\nDESTIN_SZSISZ01      -1.4550850  0.0257791   -56.444  < 2e-16 ***\nDESTIN_SZSKSZ01      -0.0265314  0.0066937    -3.964 7.38e-05 ***\nDESTIN_SZSKSZ02       0.7256080  0.0050282   144.306  < 2e-16 ***\nDESTIN_SZSKSZ03      -0.0530996  0.0059298    -8.955  < 2e-16 ***\nDESTIN_SZSKSZ04      -0.5929247  0.0139688   -42.446  < 2e-16 ***\nDESTIN_SZSKSZ05       0.1156798  0.0104889    11.029  < 2e-16 ***\nDESTIN_SZSLSZ01      -0.5835210  0.0083356   -70.003  < 2e-16 ***\nDESTIN_SZSLSZ04      -0.8160693  0.0070329  -116.037  < 2e-16 ***\nDESTIN_SZSRSZ01      -2.3393753  0.0127215  -183.891  < 2e-16 ***\nDESTIN_SZTMSZ01      -0.1231510  0.0055152   -22.329  < 2e-16 ***\nDESTIN_SZTMSZ02       1.6030248  0.0032600   491.725  < 2e-16 ***\nDESTIN_SZTMSZ03       0.7037004  0.0037139   189.479  < 2e-16 ***\nDESTIN_SZTMSZ04       0.8612441  0.0037593   229.098  < 2e-16 ***\nDESTIN_SZTMSZ05       0.3752259  0.0051282    73.170  < 2e-16 ***\nDESTIN_SZTNSZ01      -1.2636218  0.0066979  -188.659  < 2e-16 ***\nDESTIN_SZTNSZ02      -2.0845757  0.0096538  -215.934  < 2e-16 ***\nDESTIN_SZTNSZ03      -2.1182988  0.0115717  -183.058  < 2e-16 ***\nDESTIN_SZTNSZ04      -1.2431885  0.0068503  -181.479  < 2e-16 ***\nDESTIN_SZTPSZ01      -0.7102436  0.0055768  -127.356  < 2e-16 ***\nDESTIN_SZTPSZ02       0.1529801  0.0037262    41.056  < 2e-16 ***\nDESTIN_SZTPSZ03      -0.5006066  0.0054878   -91.222  < 2e-16 ***\nDESTIN_SZTPSZ04      -1.5151733  0.0071592  -211.640  < 2e-16 ***\nDESTIN_SZTPSZ05      -0.9189658  0.0056750  -161.932  < 2e-16 ***\nDESTIN_SZTPSZ06      -0.2784194  0.0062637   -44.450  < 2e-16 ***\nDESTIN_SZTPSZ07      -2.0207635  0.0116674  -173.198  < 2e-16 ***\nDESTIN_SZTPSZ08      -1.4907652  0.0085532  -174.294  < 2e-16 ***\nDESTIN_SZTPSZ09      -0.5879097  0.0059429   -98.927  < 2e-16 ***\nDESTIN_SZTPSZ10      -1.1216467  0.0084488  -132.758  < 2e-16 ***\nDESTIN_SZTPSZ11      -0.4823156  0.0050940   -94.684  < 2e-16 ***\nDESTIN_SZTPSZ12      -0.8718941  0.0061326  -142.173  < 2e-16 ***\nDESTIN_SZTSSZ01      -0.6337757  0.0208548   -30.390  < 2e-16 ***\nDESTIN_SZTSSZ02       0.7617504  0.0093787    81.222  < 2e-16 ***\nDESTIN_SZTSSZ03       1.6285172  0.0064448   252.688  < 2e-16 ***\nDESTIN_SZTSSZ04       1.2272135  0.0074573   164.566  < 2e-16 ***\nDESTIN_SZTSSZ05       1.8512518  0.0067488   274.309  < 2e-16 ***\nDESTIN_SZTSSZ06       0.3803253  0.0137938    27.572  < 2e-16 ***\nDESTIN_SZWDSZ01       1.5206993  0.0034774   437.313  < 2e-16 ***\nDESTIN_SZWDSZ02      -0.3006326  0.0055149   -54.512  < 2e-16 ***\nDESTIN_SZWDSZ03       1.2549921  0.0036112   347.527  < 2e-16 ***\nDESTIN_SZWDSZ04      -0.1698327  0.0058296   -29.133  < 2e-16 ***\nDESTIN_SZWDSZ05       0.0007569  0.0053912     0.140   0.8883    \nDESTIN_SZWDSZ06       0.5251769  0.0040323   130.243  < 2e-16 ***\nDESTIN_SZWDSZ07       0.5858817  0.0061753    94.875  < 2e-16 ***\nDESTIN_SZWDSZ08       0.6530283  0.0060875   107.274  < 2e-16 ***\nDESTIN_SZWDSZ09       0.6234289  0.0044864   138.961  < 2e-16 ***\nDESTIN_SZYSSZ01       1.0442691  0.0038255   272.973  < 2e-16 ***\nDESTIN_SZYSSZ02       0.2332146  0.0048213    48.372  < 2e-16 ***\nDESTIN_SZYSSZ03      -0.0899327  0.0051336   -17.519  < 2e-16 ***\nDESTIN_SZYSSZ04      -0.0080433  0.0048684    -1.652   0.0985 .  \nDESTIN_SZYSSZ05      -1.5781767  0.0100298  -157.349  < 2e-16 ***\nDESTIN_SZYSSZ06      -1.8140862  0.0098617  -183.953  < 2e-16 ***\nDESTIN_SZYSSZ07      -1.1854731  0.0111526  -106.296  < 2e-16 ***\nDESTIN_SZYSSZ08       0.5263279  0.0039556   133.060  < 2e-16 ***\nDESTIN_SZYSSZ09       0.4386227  0.0038890   112.786  < 2e-16 ***\nlog(ORIGIN_AGE25_64)  0.2173081  0.0001419  1531.715  < 2e-16 ***\nlog(dist)            -0.7025308  0.0001291 -5441.812  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 59965744  on 14439  degrees of freedom\nResidual deviance: 25825494  on 14168  degrees of freedom\nAIC: 25915960\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(decSIM$data$TRIPS, decSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5019401\n```\n:::\n:::\n\n\n## **6.8 Doubly constrained**\n\nIn this section, we will fit a doubly constrained SIM by using the code chunk below.\n\nThe general formula of Doubly Constrained Spatial Interaction Model\n\n![](https://r4gdsa.netlify.app/chap15/img/image4.jpg)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbcSIM <- glm(formula = TRIPS ~ \n                ORIGIN_SZ + \n                DESTIN_SZ + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(dbcSIM)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(>|z|)    \n(Intercept)     12.4351573  0.0043926  2830.937  < 2e-16 ***\nORIGIN_SZAMSZ02  0.9481862  0.0045758   207.218  < 2e-16 ***\nORIGIN_SZAMSZ03  0.5512068  0.0046690   118.057  < 2e-16 ***\nORIGIN_SZAMSZ04  0.1020551  0.0052479    19.447  < 2e-16 ***\nORIGIN_SZAMSZ05  0.0866741  0.0058678    14.771  < 2e-16 ***\nORIGIN_SZAMSZ06  0.6620333  0.0052597   125.870  < 2e-16 ***\nORIGIN_SZAMSZ07 -0.9494010  0.0097696   -97.180  < 2e-16 ***\nORIGIN_SZAMSZ08 -0.7267160  0.0090969   -79.886  < 2e-16 ***\nORIGIN_SZAMSZ09  0.4898190  0.0055220    88.702  < 2e-16 ***\nORIGIN_SZAMSZ10  0.4817015  0.0048193    99.952  < 2e-16 ***\nORIGIN_SZAMSZ11 -1.7720704  0.0130731  -135.550  < 2e-16 ***\nORIGIN_SZAMSZ12 -1.7703564  0.0108797  -162.721  < 2e-16 ***\nORIGIN_SZBDSZ01  0.8311685  0.0045214   183.829  < 2e-16 ***\nORIGIN_SZBDSZ02  0.4304377  0.0052562    81.892  < 2e-16 ***\nORIGIN_SZBDSZ03  0.8000192  0.0046407   172.390  < 2e-16 ***\nORIGIN_SZBDSZ04  1.4549610  0.0040480   359.428  < 2e-16 ***\nORIGIN_SZBDSZ05  0.4494551  0.0046985    95.658  < 2e-16 ***\nORIGIN_SZBDSZ06  0.7737918  0.0047455   163.057  < 2e-16 ***\nORIGIN_SZBDSZ07 -1.1787122  0.0098150  -120.093  < 2e-16 ***\nORIGIN_SZBDSZ08 -0.9813682  0.0091150  -107.665  < 2e-16 ***\nORIGIN_SZBKSZ01 -0.2761892  0.0068055   -40.583  < 2e-16 ***\nORIGIN_SZBKSZ02  0.4738148  0.0054643    86.712  < 2e-16 ***\nORIGIN_SZBKSZ03  0.7255878  0.0053084   136.686  < 2e-16 ***\nORIGIN_SZBKSZ04 -0.1267202  0.0061778   -20.512  < 2e-16 ***\nORIGIN_SZBKSZ05 -0.0206871  0.0060233    -3.435 0.000594 ***\nORIGIN_SZBKSZ06  0.2199823  0.0061571    35.728  < 2e-16 ***\nORIGIN_SZBKSZ07  0.7489618  0.0046639   160.588  < 2e-16 ***\nORIGIN_SZBKSZ08  0.1674888  0.0055251    30.314  < 2e-16 ***\nORIGIN_SZBKSZ09 -0.0855886  0.0059575   -14.367  < 2e-16 ***\nORIGIN_SZBLSZ01 -2.1263634  0.0150444  -141.339  < 2e-16 ***\nORIGIN_SZBLSZ02 -2.9919512  0.0195865  -152.756  < 2e-16 ***\nORIGIN_SZBLSZ03 -5.0577490  0.0398706  -126.854  < 2e-16 ***\nORIGIN_SZBLSZ04 -2.8068667  0.0239713  -117.093  < 2e-16 ***\nORIGIN_SZBMSZ01 -0.0254725  0.0053689    -4.744 2.09e-06 ***\nORIGIN_SZBMSZ02 -0.8615244  0.0068584  -125.616  < 2e-16 ***\nORIGIN_SZBMSZ03 -0.1728894  0.0059636   -28.991  < 2e-16 ***\nORIGIN_SZBMSZ04  0.2159782  0.0053604    40.292  < 2e-16 ***\nORIGIN_SZBMSZ05 -2.0248124  0.0126131  -160.533  < 2e-16 ***\nORIGIN_SZBMSZ06 -1.7659748  0.0163959  -107.708  < 2e-16 ***\nORIGIN_SZBMSZ07 -0.3243677  0.0058222   -55.713  < 2e-16 ***\nORIGIN_SZBMSZ08 -0.2530534  0.0059352   -42.636  < 2e-16 ***\nORIGIN_SZBMSZ09 -0.7697075  0.0087953   -87.513  < 2e-16 ***\nORIGIN_SZBMSZ10 -1.0097880  0.0092535  -109.125  < 2e-16 ***\nORIGIN_SZBMSZ11 -0.3806507  0.0067391   -56.484  < 2e-16 ***\nORIGIN_SZBMSZ12 -0.6694871  0.0095721   -69.941  < 2e-16 ***\nORIGIN_SZBMSZ13 -0.0101471  0.0059077    -1.718 0.085868 .  \nORIGIN_SZBMSZ14 -0.1664721  0.0069473   -23.962  < 2e-16 ***\nORIGIN_SZBMSZ15  0.0901559  0.0062848    14.345  < 2e-16 ***\nORIGIN_SZBMSZ16 -1.1763158  0.0092298  -127.447  < 2e-16 ***\nORIGIN_SZBMSZ17 -1.7146793  0.0158424  -108.233  < 2e-16 ***\nORIGIN_SZBPSZ01  0.4501196  0.0058050    77.539  < 2e-16 ***\nORIGIN_SZBPSZ02  0.5215500  0.0068249    76.418  < 2e-16 ***\nORIGIN_SZBPSZ03  0.6824757  0.0066233   103.042  < 2e-16 ***\nORIGIN_SZBPSZ04  0.5291294  0.0053263    99.343  < 2e-16 ***\nORIGIN_SZBPSZ05  0.5321073  0.0048397   109.945  < 2e-16 ***\nORIGIN_SZBPSZ06 -1.2280468  0.0094982  -129.293  < 2e-16 ***\nORIGIN_SZBPSZ07 -0.9022406  0.0088783  -101.623  < 2e-16 ***\nORIGIN_SZBSSZ01  0.1211237  0.0054011    22.426  < 2e-16 ***\nORIGIN_SZBSSZ02  0.4627529  0.0048656    95.108  < 2e-16 ***\nORIGIN_SZBSSZ03  0.2149054  0.0047853    44.909  < 2e-16 ***\nORIGIN_SZBTSZ01 -0.1078033  0.0055635   -19.377  < 2e-16 ***\nORIGIN_SZBTSZ02 -0.8886056  0.0079246  -112.132  < 2e-16 ***\nORIGIN_SZBTSZ03 -0.2171668  0.0059358   -36.586  < 2e-16 ***\nORIGIN_SZBTSZ04 -0.6380972  0.0105509   -60.478  < 2e-16 ***\nORIGIN_SZBTSZ05 -1.4667250  0.0111833  -131.153  < 2e-16 ***\nORIGIN_SZBTSZ06 -0.6081745  0.0073483   -82.764  < 2e-16 ***\nORIGIN_SZBTSZ07 -1.4898983  0.0108321  -137.544  < 2e-16 ***\nORIGIN_SZBTSZ08 -1.0613236  0.0096004  -110.550  < 2e-16 ***\nORIGIN_SZCCSZ01 -1.5303734  0.0134653  -113.653  < 2e-16 ***\nORIGIN_SZCHSZ01 -1.2039205  0.0119502  -100.745  < 2e-16 ***\nORIGIN_SZCHSZ02 -0.8329820  0.0082028  -101.549  < 2e-16 ***\nORIGIN_SZCHSZ03 -0.5141842  0.0061868   -83.110  < 2e-16 ***\nORIGIN_SZCKSZ01  0.2838684  0.0053889    52.676  < 2e-16 ***\nORIGIN_SZCKSZ02  1.0135749  0.0054735   185.178  < 2e-16 ***\nORIGIN_SZCKSZ03  0.6605218  0.0049537   133.339  < 2e-16 ***\nORIGIN_SZCKSZ04  1.8337941  0.0050485   363.238  < 2e-16 ***\nORIGIN_SZCKSZ05  1.4366501  0.0062443   230.075  < 2e-16 ***\nORIGIN_SZCKSZ06  1.1116811  0.0066231   167.850  < 2e-16 ***\nORIGIN_SZCLSZ01 -0.8537671  0.0079266  -107.709  < 2e-16 ***\nORIGIN_SZCLSZ02 -1.3781271  0.0137466  -100.252  < 2e-16 ***\nORIGIN_SZCLSZ03 -0.8497367  0.0081217  -104.625  < 2e-16 ***\nORIGIN_SZCLSZ04  0.7939673  0.0046441   170.964  < 2e-16 ***\nORIGIN_SZCLSZ05 -1.8810308  0.0156209  -120.418  < 2e-16 ***\nORIGIN_SZCLSZ06  0.8397547  0.0043958   191.035  < 2e-16 ***\nORIGIN_SZCLSZ07 -0.2246146  0.0057541   -39.035  < 2e-16 ***\nORIGIN_SZCLSZ08  0.2689832  0.0062807    42.827  < 2e-16 ***\nORIGIN_SZCLSZ09 -2.3024961  0.0166876  -137.977  < 2e-16 ***\nORIGIN_SZDTSZ02 -4.0674351  0.0834193   -48.759  < 2e-16 ***\nORIGIN_SZDTSZ03 -3.4522457  0.0738296   -46.760  < 2e-16 ***\nORIGIN_SZGLSZ01 -1.4696686  0.0093157  -157.762  < 2e-16 ***\nORIGIN_SZGLSZ02  0.2741891  0.0050071    54.760  < 2e-16 ***\nORIGIN_SZGLSZ03  0.0758920  0.0049770    15.249  < 2e-16 ***\nORIGIN_SZGLSZ04  0.8158791  0.0043281   188.506  < 2e-16 ***\nORIGIN_SZGLSZ05  0.5285343  0.0044899   117.715  < 2e-16 ***\nORIGIN_SZHGSZ01  0.2323559  0.0048572    47.837  < 2e-16 ***\nORIGIN_SZHGSZ02  0.5716591  0.0048273   118.422  < 2e-16 ***\nORIGIN_SZHGSZ03  0.4243062  0.0052165    81.339  < 2e-16 ***\nORIGIN_SZHGSZ04  0.9349895  0.0044145   211.799  < 2e-16 ***\nORIGIN_SZHGSZ05  1.2202652  0.0043808   278.547  < 2e-16 ***\nORIGIN_SZHGSZ06  0.0496899  0.0054976     9.039  < 2e-16 ***\nORIGIN_SZHGSZ07  0.6329714  0.0045754   138.342  < 2e-16 ***\nORIGIN_SZHGSZ08  0.0306742  0.0054702     5.608 2.05e-08 ***\nORIGIN_SZHGSZ09 -0.6979586  0.0071798   -97.212  < 2e-16 ***\nORIGIN_SZHGSZ10 -2.9931688  0.0422315   -70.875  < 2e-16 ***\nORIGIN_SZJESZ01  0.4172498  0.0051788    80.569  < 2e-16 ***\nORIGIN_SZJESZ02  0.3047260  0.0052291    58.275  < 2e-16 ***\nORIGIN_SZJESZ03  0.2982254  0.0055141    54.084  < 2e-16 ***\nORIGIN_SZJESZ05  0.1847967  0.0050874    36.325  < 2e-16 ***\nORIGIN_SZJESZ06 -1.8185579  0.0119403  -152.304  < 2e-16 ***\nORIGIN_SZJESZ07 -1.1601494  0.0121003   -95.877  < 2e-16 ***\nORIGIN_SZJESZ08  0.4323918  0.0053682    80.547  < 2e-16 ***\nORIGIN_SZJESZ09 -2.7001311  0.0186968  -144.416  < 2e-16 ***\nORIGIN_SZJESZ10 -3.1218012  0.0203316  -153.544  < 2e-16 ***\nORIGIN_SZJWSZ01  0.4566391  0.0068638    66.528  < 2e-16 ***\nORIGIN_SZJWSZ02  0.9961038  0.0048126   206.978  < 2e-16 ***\nORIGIN_SZJWSZ03  1.1828675  0.0045348   260.844  < 2e-16 ***\nORIGIN_SZJWSZ04  0.9302202  0.0046898   198.349  < 2e-16 ***\nORIGIN_SZJWSZ05 -1.7240666  0.0127581  -135.135  < 2e-16 ***\nORIGIN_SZJWSZ06 -1.3138514  0.0109876  -119.576  < 2e-16 ***\nORIGIN_SZJWSZ07 -2.3021923  0.0281440   -81.800  < 2e-16 ***\nORIGIN_SZJWSZ08  2.0278336  0.0046395   437.076  < 2e-16 ***\nORIGIN_SZJWSZ09  1.2729457  0.0043328   293.795  < 2e-16 ***\nORIGIN_SZKLSZ01  0.2629143  0.0050107    52.471  < 2e-16 ***\nORIGIN_SZKLSZ02 -0.4326316  0.0064296   -67.287  < 2e-16 ***\nORIGIN_SZKLSZ03 -0.2774193  0.0060394   -45.935  < 2e-16 ***\nORIGIN_SZKLSZ04 -1.9399521  0.0119219  -162.721  < 2e-16 ***\nORIGIN_SZKLSZ05 -0.5457247  0.0085596   -63.756  < 2e-16 ***\nORIGIN_SZKLSZ06 -4.2987108  0.1857686   -23.140  < 2e-16 ***\nORIGIN_SZKLSZ07 -0.8592455  0.0085195  -100.856  < 2e-16 ***\nORIGIN_SZKLSZ08 -1.3842047  0.0092337  -149.908  < 2e-16 ***\nORIGIN_SZKLSZ09 -2.8325949  0.0313083   -90.474  < 2e-16 ***\nORIGIN_SZLKSZ01 -2.6119775  0.0417633   -62.542  < 2e-16 ***\nORIGIN_SZMDSZ01 -1.6790256  0.0296857   -56.560  < 2e-16 ***\nORIGIN_SZMDSZ02 -0.8188019  0.0106679   -76.754  < 2e-16 ***\nORIGIN_SZMDSZ03 -1.5066376  0.0172057   -87.566  < 2e-16 ***\nORIGIN_SZMPSZ01 -0.9839202  0.0085086  -115.638  < 2e-16 ***\nORIGIN_SZMPSZ02 -0.5959675  0.0070116   -84.998  < 2e-16 ***\nORIGIN_SZMPSZ03 -0.0493260  0.0054606    -9.033  < 2e-16 ***\nORIGIN_SZMUSZ02 -3.5212400  0.1037750   -33.931  < 2e-16 ***\nORIGIN_SZNTSZ01 -2.6367957  0.0353128   -74.670  < 2e-16 ***\nORIGIN_SZNTSZ02 -2.7669211  0.0232853  -118.827  < 2e-16 ***\nORIGIN_SZNTSZ03 -0.6095155  0.0079108   -77.049  < 2e-16 ***\nORIGIN_SZNTSZ05 -2.9160857  0.0496710   -58.708  < 2e-16 ***\nORIGIN_SZNTSZ06 -3.3158278  0.0557977   -59.426  < 2e-16 ***\nORIGIN_SZNVSZ01  0.6448576  0.0046055   140.019  < 2e-16 ***\nORIGIN_SZNVSZ02 -0.4263007  0.0065909   -64.680  < 2e-16 ***\nORIGIN_SZNVSZ03 -1.0760662  0.0078782  -136.588  < 2e-16 ***\nORIGIN_SZNVSZ04 -1.2191855  0.0091479  -133.274  < 2e-16 ***\nORIGIN_SZNVSZ05 -2.3477319  0.0158229  -148.376  < 2e-16 ***\nORIGIN_SZPGSZ01  0.1521890  0.0154995     9.819  < 2e-16 ***\nORIGIN_SZPGSZ02 -0.4051735  0.0073805   -54.898  < 2e-16 ***\nORIGIN_SZPGSZ03  0.8974565  0.0046147   194.477  < 2e-16 ***\nORIGIN_SZPGSZ04  1.1168395  0.0045874   243.457  < 2e-16 ***\nORIGIN_SZPGSZ05  0.4811711  0.0060247    79.866  < 2e-16 ***\nORIGIN_SZPLSZ01 -0.8346640  0.0107954   -77.317  < 2e-16 ***\nORIGIN_SZPLSZ02 -1.2961415  0.0149883   -86.477  < 2e-16 ***\nORIGIN_SZPLSZ03 -3.2841214  0.0374586   -87.673  < 2e-16 ***\nORIGIN_SZPLSZ04 -3.5535584  0.0372639   -95.362  < 2e-16 ***\nORIGIN_SZPLSZ05 -2.4368263  0.0227865  -106.942  < 2e-16 ***\nORIGIN_SZPNSZ01  0.8737507  0.0057208   152.734  < 2e-16 ***\nORIGIN_SZPNSZ02 -1.7927704  0.0129284  -138.669  < 2e-16 ***\nORIGIN_SZPNSZ03 -2.6053457  0.0200175  -130.153  < 2e-16 ***\nORIGIN_SZPNSZ04 -4.7852810  0.0320335  -149.384  < 2e-16 ***\nORIGIN_SZPNSZ05 -3.5942397  0.0286332  -125.527  < 2e-16 ***\nORIGIN_SZPRSZ01 -0.5658791  0.0117172   -48.295  < 2e-16 ***\nORIGIN_SZPRSZ02  0.9149188  0.0048164   189.959  < 2e-16 ***\nORIGIN_SZPRSZ03  0.4459459  0.0048129    92.656  < 2e-16 ***\nORIGIN_SZPRSZ04 -0.5324343  0.0079070   -67.337  < 2e-16 ***\nORIGIN_SZPRSZ05  1.1460635  0.0045276   253.127  < 2e-16 ***\nORIGIN_SZPRSZ06 -0.7455804  0.0090390   -82.485  < 2e-16 ***\nORIGIN_SZPRSZ07 -2.1664325  0.0162558  -133.271  < 2e-16 ***\nORIGIN_SZPRSZ08 -0.1335351  0.0065739   -20.313  < 2e-16 ***\nORIGIN_SZQTSZ01  0.1083852  0.0071560    15.146  < 2e-16 ***\nORIGIN_SZQTSZ02 -0.5904523  0.0066637   -88.607  < 2e-16 ***\nORIGIN_SZQTSZ03  0.1148816  0.0058850    19.521  < 2e-16 ***\nORIGIN_SZQTSZ04 -0.8068751  0.0072950  -110.606  < 2e-16 ***\nORIGIN_SZQTSZ05 -0.0416544  0.0061944    -6.725 1.76e-11 ***\nORIGIN_SZQTSZ06 -0.2513123  0.0066473   -37.807  < 2e-16 ***\nORIGIN_SZQTSZ07 -1.2317647  0.0097782  -125.971  < 2e-16 ***\nORIGIN_SZQTSZ08 -0.1128259  0.0059531   -18.953  < 2e-16 ***\nORIGIN_SZQTSZ09 -0.5040685  0.0067915   -74.220  < 2e-16 ***\nORIGIN_SZQTSZ10 -0.3847934  0.0067031   -57.406  < 2e-16 ***\nORIGIN_SZQTSZ11 -1.5310869  0.0100340  -152.590  < 2e-16 ***\nORIGIN_SZQTSZ12 -1.3973122  0.0107317  -130.204  < 2e-16 ***\nORIGIN_SZQTSZ13 -0.3766193  0.0066803   -56.377  < 2e-16 ***\nORIGIN_SZQTSZ14 -1.4930778  0.0100170  -149.055  < 2e-16 ***\nORIGIN_SZQTSZ15 -1.0741455  0.0109880   -97.756  < 2e-16 ***\nORIGIN_SZRCSZ01 -1.3137496  0.0126992  -103.452  < 2e-16 ***\nORIGIN_SZRCSZ06 -0.2357988  0.0085520   -27.573  < 2e-16 ***\nORIGIN_SZRVSZ01 -2.9255095  0.0324983   -90.020  < 2e-16 ***\nORIGIN_SZRVSZ02 -2.2982248  0.0278205   -82.609  < 2e-16 ***\nORIGIN_SZRVSZ03 -2.4668577  0.0238686  -103.351  < 2e-16 ***\nORIGIN_SZRVSZ04 -3.1839853  0.0556942   -57.169  < 2e-16 ***\nORIGIN_SZRVSZ05 -1.5691633  0.0166718   -94.121  < 2e-16 ***\nORIGIN_SZSBSZ01  0.7675759  0.0061870   124.063  < 2e-16 ***\nORIGIN_SZSBSZ02 -0.7301842  0.0084130   -86.792  < 2e-16 ***\nORIGIN_SZSBSZ03  0.5905522  0.0050212   117.613  < 2e-16 ***\nORIGIN_SZSBSZ04  0.3666025  0.0058632    62.526  < 2e-16 ***\nORIGIN_SZSBSZ05 -0.0027927  0.0068497    -0.408 0.683488    \nORIGIN_SZSBSZ06 -1.1929280  0.0181677   -65.662  < 2e-16 ***\nORIGIN_SZSBSZ07 -0.4881624  0.0135753   -35.960  < 2e-16 ***\nORIGIN_SZSBSZ08 -2.1296756  0.0127299  -167.297  < 2e-16 ***\nORIGIN_SZSBSZ09 -1.2071163  0.0089657  -134.638  < 2e-16 ***\nORIGIN_SZSESZ02  1.0732486  0.0045356   236.630  < 2e-16 ***\nORIGIN_SZSESZ03  1.0806868  0.0042943   251.655  < 2e-16 ***\nORIGIN_SZSESZ04  1.0143659  0.0050693   200.102  < 2e-16 ***\nORIGIN_SZSESZ05 -0.1677508  0.0060223   -27.855  < 2e-16 ***\nORIGIN_SZSESZ06  0.9177050  0.0048344   189.829  < 2e-16 ***\nORIGIN_SZSESZ07 -2.2480778  0.0196332  -114.504  < 2e-16 ***\nORIGIN_SZSGSZ01 -0.9382577  0.0087311  -107.461  < 2e-16 ***\nORIGIN_SZSGSZ02 -1.1711279  0.0097150  -120.548  < 2e-16 ***\nORIGIN_SZSGSZ03  0.2601806  0.0052726    49.345  < 2e-16 ***\nORIGIN_SZSGSZ04  0.3471408  0.0048914    70.970  < 2e-16 ***\nORIGIN_SZSGSZ05 -1.5917536  0.0106314  -149.723  < 2e-16 ***\nORIGIN_SZSGSZ06  0.3598356  0.0046378    77.587  < 2e-16 ***\nORIGIN_SZSGSZ07 -0.5333213  0.0063133   -84.475  < 2e-16 ***\nORIGIN_SZSKSZ01 -0.2731723  0.0083002   -32.912  < 2e-16 ***\nORIGIN_SZSKSZ02  0.0900779  0.0063560    14.172  < 2e-16 ***\nORIGIN_SZSKSZ03 -0.6885954  0.0082605   -83.360  < 2e-16 ***\nORIGIN_SZSKSZ04 -2.3873135  0.0285077   -83.743  < 2e-16 ***\nORIGIN_SZSKSZ05 -1.5486234  0.0179572   -86.240  < 2e-16 ***\nORIGIN_SZSLSZ01 -2.9461043  0.0307309   -95.868  < 2e-16 ***\nORIGIN_SZSLSZ04 -0.5718659  0.0077870   -73.438  < 2e-16 ***\nORIGIN_SZSRSZ01 -1.6140902  0.0160228  -100.737  < 2e-16 ***\nORIGIN_SZTMSZ01  0.1239212  0.0060961    20.328  < 2e-16 ***\nORIGIN_SZTMSZ02  1.6644603  0.0039861   417.566  < 2e-16 ***\nORIGIN_SZTMSZ03  1.0931061  0.0042936   254.588  < 2e-16 ***\nORIGIN_SZTMSZ04  0.3164017  0.0050386    62.796  < 2e-16 ***\nORIGIN_SZTMSZ05 -0.8202309  0.0079426  -103.270  < 2e-16 ***\nORIGIN_SZTNSZ01 -1.4206354  0.0104655  -135.744  < 2e-16 ***\nORIGIN_SZTNSZ02 -1.2698547  0.0098674  -128.692  < 2e-16 ***\nORIGIN_SZTNSZ03 -1.7945209  0.0134691  -133.232  < 2e-16 ***\nORIGIN_SZTNSZ04 -0.3488649  0.0073586   -47.409  < 2e-16 ***\nORIGIN_SZTPSZ01 -0.3837703  0.0064157   -59.817  < 2e-16 ***\nORIGIN_SZTPSZ02  0.5322150  0.0044515   119.558  < 2e-16 ***\nORIGIN_SZTPSZ03 -0.4669869  0.0062181   -75.102  < 2e-16 ***\nORIGIN_SZTPSZ04 -0.0618768  0.0058844   -10.515  < 2e-16 ***\nORIGIN_SZTPSZ05  0.0710389  0.0062154    11.430  < 2e-16 ***\nORIGIN_SZTPSZ06  0.6768679  0.0069498    97.394  < 2e-16 ***\nORIGIN_SZTPSZ07 -0.0433789  0.0064403    -6.736 1.63e-11 ***\nORIGIN_SZTPSZ08 -0.6985163  0.0092440   -75.564  < 2e-16 ***\nORIGIN_SZTPSZ09 -0.3734306  0.0063586   -58.728  < 2e-16 ***\nORIGIN_SZTPSZ10 -0.4074383  0.0077824   -52.354  < 2e-16 ***\nORIGIN_SZTPSZ11  0.1027811  0.0056140    18.308  < 2e-16 ***\nORIGIN_SZTPSZ12 -0.5107246  0.0066279   -77.057  < 2e-16 ***\nORIGIN_SZTSSZ01 -3.3769221  0.0491306   -68.734  < 2e-16 ***\nORIGIN_SZTSSZ02  0.0505638  0.0098191     5.150 2.61e-07 ***\nORIGIN_SZTSSZ03 -0.3871866  0.0095826   -40.405  < 2e-16 ***\nORIGIN_SZTSSZ04 -0.4378131  0.0100379   -43.616  < 2e-16 ***\nORIGIN_SZTSSZ05 -2.8779256  0.0160283  -179.553  < 2e-16 ***\nORIGIN_SZTSSZ06 -2.5839480  0.0253242  -102.035  < 2e-16 ***\nORIGIN_SZWDSZ01  0.8699118  0.0043756   198.811  < 2e-16 ***\nORIGIN_SZWDSZ02  0.9130427  0.0050360   181.304  < 2e-16 ***\nORIGIN_SZWDSZ03  1.6191782  0.0045298   357.452  < 2e-16 ***\nORIGIN_SZWDSZ04  1.2098683  0.0054321   222.726  < 2e-16 ***\nORIGIN_SZWDSZ05  0.4311467  0.0052797    81.661  < 2e-16 ***\nORIGIN_SZWDSZ06  0.8987620  0.0049874   180.206  < 2e-16 ***\nORIGIN_SZWDSZ07 -0.6467532  0.0084781   -76.286  < 2e-16 ***\nORIGIN_SZWDSZ08 -0.8783026  0.0082670  -106.243  < 2e-16 ***\nORIGIN_SZWDSZ09  1.3292210  0.0048729   272.781  < 2e-16 ***\nORIGIN_SZYSSZ01 -0.4795145  0.0058518   -81.944  < 2e-16 ***\nORIGIN_SZYSSZ02  0.9318048  0.0054446   171.142  < 2e-16 ***\nORIGIN_SZYSSZ03  2.0589587  0.0046764   440.284  < 2e-16 ***\nORIGIN_SZYSSZ04  0.8710201  0.0047295   184.169  < 2e-16 ***\nORIGIN_SZYSSZ05  0.1691225  0.0060394    28.003  < 2e-16 ***\nORIGIN_SZYSSZ06 -0.8103984  0.0109104   -74.278  < 2e-16 ***\nORIGIN_SZYSSZ07 -0.8959565  0.0119336   -75.079  < 2e-16 ***\nORIGIN_SZYSSZ08 -0.2772121  0.0063585   -43.597  < 2e-16 ***\nORIGIN_SZYSSZ09  1.2272070  0.0044981   272.829  < 2e-16 ***\nDESTIN_SZAMSZ02 -0.0528821  0.0042848   -12.342  < 2e-16 ***\nDESTIN_SZAMSZ03  0.0793639  0.0041920    18.932  < 2e-16 ***\nDESTIN_SZAMSZ04 -0.9288471  0.0061333  -151.443  < 2e-16 ***\nDESTIN_SZAMSZ05 -1.0807633  0.0062560  -172.756  < 2e-16 ***\nDESTIN_SZAMSZ06 -0.8871448  0.0060872  -145.739  < 2e-16 ***\nDESTIN_SZAMSZ07 -1.5838629  0.0096859  -163.522  < 2e-16 ***\nDESTIN_SZAMSZ08 -0.9751233  0.0068847  -141.636  < 2e-16 ***\nDESTIN_SZAMSZ09 -1.0374241  0.0061671  -168.218  < 2e-16 ***\nDESTIN_SZAMSZ10 -0.1232634  0.0044806   -27.511  < 2e-16 ***\nDESTIN_SZAMSZ11 -0.4809473  0.0088133   -54.571  < 2e-16 ***\nDESTIN_SZAMSZ12  0.2157037  0.0050664    42.575  < 2e-16 ***\nDESTIN_SZBDSZ01  0.3577958  0.0039604    90.342  < 2e-16 ***\nDESTIN_SZBDSZ02 -0.4365698  0.0051412   -84.916  < 2e-16 ***\nDESTIN_SZBDSZ03 -0.1562123  0.0044354   -35.219  < 2e-16 ***\nDESTIN_SZBDSZ04  0.6734444  0.0036242   185.820  < 2e-16 ***\nDESTIN_SZBDSZ05  0.3655436  0.0040519    90.215  < 2e-16 ***\nDESTIN_SZBDSZ06  0.0587526  0.0044385    13.237  < 2e-16 ***\nDESTIN_SZBDSZ07 -0.6642209  0.0095786   -69.344  < 2e-16 ***\nDESTIN_SZBDSZ08 -1.7194314  0.0106616  -161.273  < 2e-16 ***\nDESTIN_SZBKSZ01 -1.2823137  0.0067370  -190.340  < 2e-16 ***\nDESTIN_SZBKSZ02 -0.3849964  0.0055555   -69.300  < 2e-16 ***\nDESTIN_SZBKSZ03 -0.8637897  0.0059017  -146.364  < 2e-16 ***\nDESTIN_SZBKSZ04 -0.1290178  0.0051351   -25.125  < 2e-16 ***\nDESTIN_SZBKSZ05 -0.7364048  0.0059233  -124.324  < 2e-16 ***\nDESTIN_SZBKSZ06 -1.0010292  0.0063640  -157.296  < 2e-16 ***\nDESTIN_SZBKSZ07  0.0848101  0.0042992    19.727  < 2e-16 ***\nDESTIN_SZBKSZ08 -1.1122874  0.0070954  -156.762  < 2e-16 ***\nDESTIN_SZBKSZ09 -0.1758378  0.0051364   -34.233  < 2e-16 ***\nDESTIN_SZBLSZ01 -0.7663393  0.0072091  -106.301  < 2e-16 ***\nDESTIN_SZBLSZ02  0.4469128  0.0068127    65.600  < 2e-16 ***\nDESTIN_SZBLSZ03  1.6565076  0.0078654   210.608  < 2e-16 ***\nDESTIN_SZBLSZ04 -0.3227781  0.0137626   -23.453  < 2e-16 ***\nDESTIN_SZBMSZ01 -0.2083045  0.0048358   -43.075  < 2e-16 ***\nDESTIN_SZBMSZ02 -0.3277638  0.0049977   -65.583  < 2e-16 ***\nDESTIN_SZBMSZ03 -0.5138312  0.0058556   -87.750  < 2e-16 ***\nDESTIN_SZBMSZ04 -0.2211825  0.0051054   -43.323  < 2e-16 ***\nDESTIN_SZBMSZ05 -0.2102805  0.0067728   -31.048  < 2e-16 ***\nDESTIN_SZBMSZ06 -1.3825827  0.0124845  -110.744  < 2e-16 ***\nDESTIN_SZBMSZ07 -0.0117779  0.0046812    -2.516 0.011870 *  \nDESTIN_SZBMSZ08 -0.9057219  0.0063885  -141.775  < 2e-16 ***\nDESTIN_SZBMSZ09 -2.3169339  0.0144540  -160.298  < 2e-16 ***\nDESTIN_SZBMSZ10 -1.3978304  0.0090477  -154.495  < 2e-16 ***\nDESTIN_SZBMSZ11 -1.3943466  0.0080479  -173.257  < 2e-16 ***\nDESTIN_SZBMSZ12 -0.6892586  0.0081575   -84.494  < 2e-16 ***\nDESTIN_SZBMSZ13 -0.2681927  0.0053006   -50.596  < 2e-16 ***\nDESTIN_SZBMSZ14 -0.7612269  0.0080270   -94.834  < 2e-16 ***\nDESTIN_SZBMSZ15 -0.9340708  0.0071123  -131.332  < 2e-16 ***\nDESTIN_SZBMSZ16 -2.0598119  0.0108507  -189.831  < 2e-16 ***\nDESTIN_SZBMSZ17 -2.5091125  0.0165380  -151.718  < 2e-16 ***\nDESTIN_SZBPSZ01 -0.8827572  0.0058530  -150.820  < 2e-16 ***\nDESTIN_SZBPSZ02 -1.5411421  0.0087563  -176.003  < 2e-16 ***\nDESTIN_SZBPSZ03 -1.2565472  0.0081001  -155.128  < 2e-16 ***\nDESTIN_SZBPSZ04 -0.7843346  0.0060959  -128.666  < 2e-16 ***\nDESTIN_SZBPSZ05  0.1512915  0.0042553    35.554  < 2e-16 ***\nDESTIN_SZBPSZ06 -0.6789990  0.0079773   -85.117  < 2e-16 ***\nDESTIN_SZBPSZ07 -0.5056200  0.0081202   -62.267  < 2e-16 ***\nDESTIN_SZBSSZ01 -0.1274523  0.0046968   -27.136  < 2e-16 ***\nDESTIN_SZBSSZ02 -0.7523273  0.0051912  -144.925  < 2e-16 ***\nDESTIN_SZBSSZ03  0.2774715  0.0039129    70.911  < 2e-16 ***\nDESTIN_SZBTSZ01  0.1708490  0.0043480    39.294  < 2e-16 ***\nDESTIN_SZBTSZ02 -0.6785590  0.0067486  -100.548  < 2e-16 ***\nDESTIN_SZBTSZ03  0.0576814  0.0049854    11.570  < 2e-16 ***\nDESTIN_SZBTSZ04 -1.3219421  0.0107136  -123.389  < 2e-16 ***\nDESTIN_SZBTSZ05 -0.4174864  0.0069606   -59.978  < 2e-16 ***\nDESTIN_SZBTSZ06 -0.5272616  0.0061169   -86.197  < 2e-16 ***\nDESTIN_SZBTSZ07 -1.6006743  0.0099385  -161.057  < 2e-16 ***\nDESTIN_SZBTSZ08 -0.8053037  0.0089197   -90.284  < 2e-16 ***\nDESTIN_SZCCSZ01 -0.9246058  0.0081445  -113.525  < 2e-16 ***\nDESTIN_SZCHSZ01 -1.2777041  0.0096802  -131.992  < 2e-16 ***\nDESTIN_SZCHSZ02  0.0105074  0.0054352     1.933 0.053208 .  \nDESTIN_SZCHSZ03  1.1022701  0.0041409   266.190  < 2e-16 ***\nDESTIN_SZCKSZ01 -0.3607465  0.0051067   -70.641  < 2e-16 ***\nDESTIN_SZCKSZ02 -0.8461482  0.0055930  -151.287  < 2e-16 ***\nDESTIN_SZCKSZ03  0.2325574  0.0042928    54.174  < 2e-16 ***\nDESTIN_SZCKSZ04 -1.5022789  0.0065964  -227.743  < 2e-16 ***\nDESTIN_SZCKSZ05 -1.2606947  0.0077048  -163.624  < 2e-16 ***\nDESTIN_SZCKSZ06  0.0765191  0.0061808    12.380  < 2e-16 ***\nDESTIN_SZCLSZ01  0.1826532  0.0050012    36.522  < 2e-16 ***\nDESTIN_SZCLSZ02 -2.0861752  0.0134894  -154.653  < 2e-16 ***\nDESTIN_SZCLSZ03 -0.8932420  0.0079142  -112.866  < 2e-16 ***\nDESTIN_SZCLSZ04 -0.2655376  0.0047608   -55.776  < 2e-16 ***\nDESTIN_SZCLSZ05 -0.9950959  0.0085622  -116.220  < 2e-16 ***\nDESTIN_SZCLSZ06  0.0656155  0.0042205    15.547  < 2e-16 ***\nDESTIN_SZCLSZ07 -0.4907686  0.0054227   -90.503  < 2e-16 ***\nDESTIN_SZCLSZ08 -0.3865747  0.0061470   -62.889  < 2e-16 ***\nDESTIN_SZCLSZ09  0.4256956  0.0067051    63.488  < 2e-16 ***\nDESTIN_SZDTSZ02 -2.6464959  0.0348727   -75.890  < 2e-16 ***\nDESTIN_SZDTSZ03 -1.5139864  0.0144478  -104.790  < 2e-16 ***\nDESTIN_SZGLSZ01 -0.0119465  0.0052478    -2.276 0.022818 *  \nDESTIN_SZGLSZ02 -0.2846539  0.0047516   -59.907  < 2e-16 ***\nDESTIN_SZGLSZ03  0.3547159  0.0039490    89.823  < 2e-16 ***\nDESTIN_SZGLSZ04  0.2927196  0.0039458    74.185  < 2e-16 ***\nDESTIN_SZGLSZ05  0.1868090  0.0040031    46.666  < 2e-16 ***\nDESTIN_SZHGSZ01  0.1420578  0.0039890    35.612  < 2e-16 ***\nDESTIN_SZHGSZ02 -0.7244780  0.0052393  -138.277  < 2e-16 ***\nDESTIN_SZHGSZ03 -1.1926172  0.0062147  -191.903  < 2e-16 ***\nDESTIN_SZHGSZ04 -0.4396143  0.0044857   -98.003  < 2e-16 ***\nDESTIN_SZHGSZ05 -0.5698266  0.0046449  -122.677  < 2e-16 ***\nDESTIN_SZHGSZ06 -0.8269648  0.0054949  -150.495  < 2e-16 ***\nDESTIN_SZHGSZ07  0.0716018  0.0041608    17.209  < 2e-16 ***\nDESTIN_SZHGSZ08 -0.4296529  0.0050037   -85.868  < 2e-16 ***\nDESTIN_SZHGSZ09 -0.2075701  0.0052562   -39.490  < 2e-16 ***\nDESTIN_SZHGSZ10 -2.9167710  0.0262709  -111.027  < 2e-16 ***\nDESTIN_SZJESZ01 -0.2940281  0.0051512   -57.080  < 2e-16 ***\nDESTIN_SZJESZ02 -0.6771250  0.0053784  -125.897  < 2e-16 ***\nDESTIN_SZJESZ03 -0.7433609  0.0059024  -125.941  < 2e-16 ***\nDESTIN_SZJESZ05  0.1665584  0.0042970    38.762  < 2e-16 ***\nDESTIN_SZJESZ06 -1.2553540  0.0084363  -148.804  < 2e-16 ***\nDESTIN_SZJESZ07 -0.8432165  0.0080550  -104.683  < 2e-16 ***\nDESTIN_SZJESZ08 -0.4103337  0.0057196   -71.741  < 2e-16 ***\nDESTIN_SZJESZ09  0.6659263  0.0073935    90.069  < 2e-16 ***\nDESTIN_SZJESZ10  0.9913424  0.0070579   140.459  < 2e-16 ***\nDESTIN_SZJWSZ01 -0.9456240  0.0069942  -135.200  < 2e-16 ***\nDESTIN_SZJWSZ02 -0.7545179  0.0055146  -136.821  < 2e-16 ***\nDESTIN_SZJWSZ03  0.2290724  0.0043493    52.668  < 2e-16 ***\nDESTIN_SZJWSZ04  0.6807777  0.0041356   164.614  < 2e-16 ***\nDESTIN_SZJWSZ05 -0.4554805  0.0063159   -72.116  < 2e-16 ***\nDESTIN_SZJWSZ06 -0.2606152  0.0057697   -45.170  < 2e-16 ***\nDESTIN_SZJWSZ07 -1.9182195  0.0288449   -66.501  < 2e-16 ***\nDESTIN_SZJWSZ08 -0.6251637  0.0051508  -121.371  < 2e-16 ***\nDESTIN_SZJWSZ09  0.9092588  0.0037935   239.689  < 2e-16 ***\nDESTIN_SZKLSZ01 -0.5812998  0.0052729  -110.242  < 2e-16 ***\nDESTIN_SZKLSZ02 -0.7079661  0.0058176  -121.694  < 2e-16 ***\nDESTIN_SZKLSZ03 -1.2181962  0.0065996  -184.585  < 2e-16 ***\nDESTIN_SZKLSZ04 -1.6935244  0.0087873  -192.724  < 2e-16 ***\nDESTIN_SZKLSZ05 -0.6848266  0.0073653   -92.980  < 2e-16 ***\nDESTIN_SZKLSZ06 -2.2958926  0.0362606   -63.316  < 2e-16 ***\nDESTIN_SZKLSZ07 -0.9525903  0.0066790  -142.624  < 2e-16 ***\nDESTIN_SZKLSZ08 -0.4545161  0.0051747   -87.835  < 2e-16 ***\nDESTIN_SZKLSZ09 -2.2042604  0.0161728  -136.295  < 2e-16 ***\nDESTIN_SZLKSZ01 -1.9976089  0.0231807   -86.175  < 2e-16 ***\nDESTIN_SZMDSZ01 -1.7108459  0.0210309   -81.349  < 2e-16 ***\nDESTIN_SZMDSZ02 -1.3692320  0.0114225  -119.871  < 2e-16 ***\nDESTIN_SZMDSZ03 -2.7193376  0.0252710  -107.607  < 2e-16 ***\nDESTIN_SZMPSZ01 -0.8035620  0.0078591  -102.246  < 2e-16 ***\nDESTIN_SZMPSZ02 -0.7608823  0.0061403  -123.917  < 2e-16 ***\nDESTIN_SZMPSZ03 -0.0636068  0.0047809   -13.304  < 2e-16 ***\nDESTIN_SZMUSZ02 -1.9516133  0.0200165   -97.500  < 2e-16 ***\nDESTIN_SZNTSZ01 -3.3062955  0.0448055   -73.792  < 2e-16 ***\nDESTIN_SZNTSZ02 -1.6433056  0.0109346  -150.285  < 2e-16 ***\nDESTIN_SZNTSZ03 -1.1384753  0.0077421  -147.051  < 2e-16 ***\nDESTIN_SZNTSZ05 -2.0239135  0.0250238   -80.879  < 2e-16 ***\nDESTIN_SZNTSZ06 -3.3469527  0.0428996   -78.018  < 2e-16 ***\nDESTIN_SZNVSZ01 -0.3417972  0.0045513   -75.100  < 2e-16 ***\nDESTIN_SZNVSZ02 -0.4970905  0.0053959   -92.124  < 2e-16 ***\nDESTIN_SZNVSZ03 -0.4913022  0.0055171   -89.051  < 2e-16 ***\nDESTIN_SZNVSZ04 -1.9126556  0.0107757  -177.497  < 2e-16 ***\nDESTIN_SZNVSZ05 -1.5343622  0.0089693  -171.069  < 2e-16 ***\nDESTIN_SZPGSZ01 -1.7816379  0.0194565   -91.571  < 2e-16 ***\nDESTIN_SZPGSZ02 -0.9285806  0.0069031  -134.516  < 2e-16 ***\nDESTIN_SZPGSZ03  0.0867038  0.0042171    20.560  < 2e-16 ***\nDESTIN_SZPGSZ04 -0.3905945  0.0046891   -83.298  < 2e-16 ***\nDESTIN_SZPGSZ05 -0.9693952  0.0074671  -129.821  < 2e-16 ***\nDESTIN_SZPLSZ01 -0.6142679  0.0070882   -86.660  < 2e-16 ***\nDESTIN_SZPLSZ02 -1.7537338  0.0133117  -131.743  < 2e-16 ***\nDESTIN_SZPLSZ03 -0.1339343  0.0098718   -13.567  < 2e-16 ***\nDESTIN_SZPLSZ04 -0.1300144  0.0096427   -13.483  < 2e-16 ***\nDESTIN_SZPLSZ05 -0.8459266  0.0119080   -71.038  < 2e-16 ***\nDESTIN_SZPNSZ01 -0.2150030  0.0058003   -37.067  < 2e-16 ***\nDESTIN_SZPNSZ02  1.0184197  0.0077892   130.747  < 2e-16 ***\nDESTIN_SZPNSZ03  0.0165385  0.0081747     2.023 0.043060 *  \nDESTIN_SZPNSZ04  1.8301032  0.0088120   207.683  < 2e-16 ***\nDESTIN_SZPNSZ05  0.9672854  0.0131454    73.583  < 2e-16 ***\nDESTIN_SZPRSZ01 -1.4027802  0.0086947  -161.338  < 2e-16 ***\nDESTIN_SZPRSZ02 -0.4964525  0.0052437   -94.675  < 2e-16 ***\nDESTIN_SZPRSZ03  0.4225059  0.0040305   104.828  < 2e-16 ***\nDESTIN_SZPRSZ04 -0.4852985  0.0083552   -58.083  < 2e-16 ***\nDESTIN_SZPRSZ05 -0.3009483  0.0047546   -63.297  < 2e-16 ***\nDESTIN_SZPRSZ06  0.0042718  0.0054557     0.783 0.433631    \nDESTIN_SZPRSZ07 -1.1382651  0.0118867   -95.759  < 2e-16 ***\nDESTIN_SZPRSZ08 -0.8250111  0.0066786  -123.531  < 2e-16 ***\nDESTIN_SZQTSZ01 -1.2208796  0.0089253  -136.789  < 2e-16 ***\nDESTIN_SZQTSZ02 -1.2907100  0.0076825  -168.007  < 2e-16 ***\nDESTIN_SZQTSZ03 -0.7460808  0.0066541  -112.124  < 2e-16 ***\nDESTIN_SZQTSZ04 -0.6266190  0.0066841   -93.748  < 2e-16 ***\nDESTIN_SZQTSZ05 -0.6112222  0.0060485  -101.054  < 2e-16 ***\nDESTIN_SZQTSZ06 -0.9150752  0.0065120  -140.522  < 2e-16 ***\nDESTIN_SZQTSZ07 -1.4602389  0.0110006  -132.742  < 2e-16 ***\nDESTIN_SZQTSZ08  0.0025596  0.0050217     0.510 0.610261    \nDESTIN_SZQTSZ09 -0.5295772  0.0058924   -89.874  < 2e-16 ***\nDESTIN_SZQTSZ10 -0.3846301  0.0055907   -68.798  < 2e-16 ***\nDESTIN_SZQTSZ11  0.0254408  0.0055085     4.618 3.87e-06 ***\nDESTIN_SZQTSZ12 -0.3339155  0.0072806   -45.864  < 2e-16 ***\nDESTIN_SZQTSZ13 -0.0427531  0.0053733    -7.957 1.77e-15 ***\nDESTIN_SZQTSZ14 -0.2464326  0.0063884   -38.575  < 2e-16 ***\nDESTIN_SZQTSZ15 -0.1759645  0.0077595   -22.677  < 2e-16 ***\nDESTIN_SZRCSZ01 -0.4629071  0.0072523   -63.829  < 2e-16 ***\nDESTIN_SZRCSZ06 -2.0895157  0.0189109  -110.493  < 2e-16 ***\nDESTIN_SZRVSZ01 -1.7920888  0.0163501  -109.607  < 2e-16 ***\nDESTIN_SZRVSZ02 -3.1630811  0.0326322   -96.931  < 2e-16 ***\nDESTIN_SZRVSZ03 -2.0290505  0.0135758  -149.461  < 2e-16 ***\nDESTIN_SZRVSZ04 -1.5081652  0.0155642   -96.900  < 2e-16 ***\nDESTIN_SZRVSZ05 -2.3685160  0.0259385   -91.313  < 2e-16 ***\nDESTIN_SZSBSZ01 -0.5888699  0.0068663   -85.763  < 2e-16 ***\nDESTIN_SZSBSZ02 -1.0776774  0.0078313  -137.612  < 2e-16 ***\nDESTIN_SZSBSZ03  0.4713695  0.0045925   102.639  < 2e-16 ***\nDESTIN_SZSBSZ04  0.0524108  0.0057578     9.103  < 2e-16 ***\nDESTIN_SZSBSZ05 -0.9603240  0.0075285  -127.558  < 2e-16 ***\nDESTIN_SZSBSZ06 -1.8555956  0.0234217   -79.226  < 2e-16 ***\nDESTIN_SZSBSZ07 -1.8441975  0.0196079   -94.054  < 2e-16 ***\nDESTIN_SZSBSZ08  0.9229582  0.0055729   165.616  < 2e-16 ***\nDESTIN_SZSBSZ09  0.5177040  0.0051971    99.614  < 2e-16 ***\nDESTIN_SZSESZ02 -0.5752271  0.0048295  -119.106  < 2e-16 ***\nDESTIN_SZSESZ03  0.2539038  0.0038355    66.198  < 2e-16 ***\nDESTIN_SZSESZ04 -0.9015792  0.0056730  -158.925  < 2e-16 ***\nDESTIN_SZSESZ05 -0.4661640  0.0048593   -95.932  < 2e-16 ***\nDESTIN_SZSESZ06 -0.8428573  0.0059227  -142.310  < 2e-16 ***\nDESTIN_SZSESZ07 -3.2171210  0.0227093  -141.666  < 2e-16 ***\nDESTIN_SZSGSZ01 -0.2743200  0.0059602   -46.025  < 2e-16 ***\nDESTIN_SZSGSZ02 -0.2944017  0.0052527   -56.048  < 2e-16 ***\nDESTIN_SZSGSZ03 -0.4469952  0.0048197   -92.743  < 2e-16 ***\nDESTIN_SZSGSZ04 -0.2852039  0.0047978   -59.444  < 2e-16 ***\nDESTIN_SZSGSZ05 -2.0628346  0.0098257  -209.942  < 2e-16 ***\nDESTIN_SZSGSZ06  0.2519107  0.0038889    64.777  < 2e-16 ***\nDESTIN_SZSGSZ07 -0.5730279  0.0052196  -109.784  < 2e-16 ***\nDESTIN_SZSISZ01 -1.1013977  0.0259118   -42.506  < 2e-16 ***\nDESTIN_SZSKSZ01 -0.5357627  0.0071643   -74.782  < 2e-16 ***\nDESTIN_SZSKSZ02  0.3082925  0.0056874    54.206  < 2e-16 ***\nDESTIN_SZSKSZ03 -0.4548663  0.0062436   -72.853  < 2e-16 ***\nDESTIN_SZSKSZ04 -0.6592695  0.0148535   -44.385  < 2e-16 ***\nDESTIN_SZSKSZ05 -0.1435321  0.0122342   -11.732  < 2e-16 ***\nDESTIN_SZSLSZ01 -0.8841264  0.0084599  -104.508  < 2e-16 ***\nDESTIN_SZSLSZ04 -1.1777458  0.0071372  -165.014  < 2e-16 ***\nDESTIN_SZSRSZ01 -1.6424671  0.0128847  -127.475  < 2e-16 ***\nDESTIN_SZTMSZ01 -0.3256898  0.0058105   -56.052  < 2e-16 ***\nDESTIN_SZTMSZ02  1.1542864  0.0034729   332.374  < 2e-16 ***\nDESTIN_SZTMSZ03  0.4515253  0.0039272   114.973  < 2e-16 ***\nDESTIN_SZTMSZ04  0.8237768  0.0040089   205.488  < 2e-16 ***\nDESTIN_SZTMSZ05  0.3945339  0.0054359    72.580  < 2e-16 ***\nDESTIN_SZTNSZ01 -0.9491109  0.0067868  -139.847  < 2e-16 ***\nDESTIN_SZTNSZ02 -1.5904128  0.0097408  -163.273  < 2e-16 ***\nDESTIN_SZTNSZ03 -1.6443092  0.0116613  -141.006  < 2e-16 ***\nDESTIN_SZTNSZ04 -1.0649240  0.0069877  -152.399  < 2e-16 ***\nDESTIN_SZTPSZ01 -0.5177358  0.0056904   -90.985  < 2e-16 ***\nDESTIN_SZTPSZ02  0.2191562  0.0038300    57.221  < 2e-16 ***\nDESTIN_SZTPSZ03 -0.2491157  0.0056669   -43.960  < 2e-16 ***\nDESTIN_SZTPSZ04 -1.4990877  0.0072458  -206.892  < 2e-16 ***\nDESTIN_SZTPSZ05 -0.9530068  0.0058002  -164.306  < 2e-16 ***\nDESTIN_SZTPSZ06 -0.4887558  0.0074669   -65.456  < 2e-16 ***\nDESTIN_SZTPSZ07 -1.9724982  0.0118448  -166.529  < 2e-16 ***\nDESTIN_SZTPSZ08 -1.3431220  0.0086933  -154.501  < 2e-16 ***\nDESTIN_SZTPSZ09 -0.3490548  0.0061370   -56.877  < 2e-16 ***\nDESTIN_SZTPSZ10 -1.3208517  0.0085973  -153.636  < 2e-16 ***\nDESTIN_SZTPSZ11 -0.3873761  0.0052467   -73.832  < 2e-16 ***\nDESTIN_SZTPSZ12 -0.7056368  0.0062488  -112.923  < 2e-16 ***\nDESTIN_SZTSSZ01 -0.9638767  0.0219669   -43.879  < 2e-16 ***\nDESTIN_SZTSSZ02 -0.6901972  0.0118074   -58.455  < 2e-16 ***\nDESTIN_SZTSSZ03  0.4084395  0.0087714    46.565  < 2e-16 ***\nDESTIN_SZTSSZ04  0.1014502  0.0097771    10.376  < 2e-16 ***\nDESTIN_SZTSSZ05  1.6410733  0.0088309   185.834  < 2e-16 ***\nDESTIN_SZTSSZ06  0.8538192  0.0207512    41.146  < 2e-16 ***\nDESTIN_SZWDSZ01  0.8194046  0.0037338   219.454  < 2e-16 ***\nDESTIN_SZWDSZ02 -0.7887372  0.0058696  -134.376  < 2e-16 ***\nDESTIN_SZWDSZ03  0.5699823  0.0041938   135.911  < 2e-16 ***\nDESTIN_SZWDSZ04 -0.8453975  0.0065140  -129.781  < 2e-16 ***\nDESTIN_SZWDSZ05 -0.3539899  0.0057303   -61.775  < 2e-16 ***\nDESTIN_SZWDSZ06  0.1376776  0.0044027    31.271  < 2e-16 ***\nDESTIN_SZWDSZ07 -0.2219013  0.0066416   -33.411  < 2e-16 ***\nDESTIN_SZWDSZ08 -0.0268026  0.0065105    -4.117 3.84e-05 ***\nDESTIN_SZWDSZ09 -0.2102375  0.0050646   -41.511  < 2e-16 ***\nDESTIN_SZYSSZ01  0.7462605  0.0041004   181.996  < 2e-16 ***\nDESTIN_SZYSSZ02 -0.3039302  0.0053484   -56.826  < 2e-16 ***\nDESTIN_SZYSSZ03 -1.1164663  0.0057256  -194.995  < 2e-16 ***\nDESTIN_SZYSSZ04 -0.3783796  0.0051512   -73.454  < 2e-16 ***\nDESTIN_SZYSSZ05 -1.7934064  0.0102089  -175.671  < 2e-16 ***\nDESTIN_SZYSSZ06 -1.8508129  0.0099619  -185.789  < 2e-16 ***\nDESTIN_SZYSSZ07 -0.9261476  0.0118216   -78.343  < 2e-16 ***\nDESTIN_SZYSSZ08  0.4416628  0.0041290   106.967  < 2e-16 ***\nDESTIN_SZYSSZ09  0.0248623  0.0041426     6.002 1.95e-09 ***\nlog(dist)       -0.6747463  0.0001358 -4970.372  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 59965744  on 14439  degrees of freedom\nResidual deviance: 20664335  on 13901  degrees of freedom\nAIC: 20755335\n\nNumber of Fisher Scoring iterations: 7\n```\n:::\n:::\n\n\nWe can examine how the constraints hold for destinations this time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCalcRSquared(dbcSIM$data$TRIPS, dbcSIM$fitted.values)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5831464\n```\n:::\n:::\n\n\nNotice that there is a relatively greater improvement in the R\\^2 value.\n\n## **6.9 Model comparison**\n\nAnother useful model performance measure for continuous dependent variable is [Root Mean Squared Error](https://towardsdatascience.com/what-does-rmse-really-mean-806b65f2e48e). In this sub-section, you will learn how to use [`compare_performance()`](https://easystats.github.io/performance/reference/compare_performance.html) of [**performance**](https://easystats.github.io/performance/) package\n\nFirst of all, let us create a list called *model_list* by using the code chun below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_list <- list(unconstrained=uncSIM,\n                   originConstrained=orcSIM,\n                   destinationConstrained=decSIM,\n                   doublyConstrained=dbcSIM)\n```\n:::\n\n\nNext, we will compute the RMSE of all the models in *model_list* file by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Comparison of Model Performance Indices\n\nName                   | Model |     RMSE\n-----------------------------------------\nunconstrained          |   glm | 4316.028\noriginConstrained      |   glm | 3679.154\ndestinationConstrained |   glm | 3393.268\ndoublyConstrained      |   glm | 3230.276\n```\n:::\n:::\n\n\nThe print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.\n\n## **6.10 Visualising fitted values**\n\nIn this section, you will learn how to visualise the observed values and the fitted values.\n\nFirstly we will extract the fitted values from each model by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- as.data.frame(uncSIM$fitted.values) %>%\n  round(digits = 0)\n```\n:::\n\n\nNext, we will join the values to *SIM_data* data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(uncTRIPS = \"uncSIM$fitted.values\")\n```\n:::\n\n\nRepeat the same step by for Origin Constrained SIM (i.e. orcSIM)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- as.data.frame(orcSIM$fitted.values) %>%\n  round(digits = 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(orcTRIPS = \"orcSIM$fitted.values\")\n```\n:::\n\n\nRepeat the same step by for Destination Constrained SIM (i.e. decSIM)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- as.data.frame(decSIM$fitted.values) %>%\n  round(digits = 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(decTRIPS = \"decSIM$fitted.values\")\n```\n:::\n\n\nRepeat the same step by for Doubly Constrained SIM (i.e. dbcSIM)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- as.data.frame(dbcSIM$fitted.values) %>%\n  round(digits = 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nSIM_data <- SIM_data %>%\n  cbind(df) %>%\n  rename(dbcTRIPS = \"dbcSIM$fitted.values\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunc_p <- ggplot(data = SIM_data,\n                aes(x = uncTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\norc_p <- ggplot(data = SIM_data,\n                aes(x = orcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndec_p <- ggplot(data = SIM_data,\n                aes(x = decTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndbc_p <- ggplot(data = SIM_data,\n                aes(x = dbcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n:::\n\n\nNow, we will put all the graphs into a single visual for better comparison by using the code chunk below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggarrange(unc_p, orc_p, dec_p, dbc_p,\n          ncol = 2,\n          nrow = 2)\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex11_files/figure-html/unnamed-chunk-68-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex11_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}